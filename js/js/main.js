/*
 Platform.js <https://mths.be/platform>
 Copyright 2014-2018 Benjamin Tan <https://bnjmnt4n.now.sh/>
 Copyright 2011-2013 John-David Dalton
 Available under MIT license <https://mths.be/mit>
*/
var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.arrayIteratorImpl=function(a){var d=0;return function(){return d<a.length?{done:!1,value:a[d++]}:{done:!0}}};$jscomp.arrayIterator=function(a){return{next:$jscomp.arrayIteratorImpl(a)}};$jscomp.makeIterator=function(a){var d="undefined"!=typeof Symbol&&Symbol.iterator&&a[Symbol.iterator];if(d)return d.call(a);if("number"==typeof a.length)return $jscomp.arrayIterator(a);throw Error(String(a)+" is not an iterable or ArrayLike");};
$jscomp.arrayFromIterator=function(a){for(var d,c=[];!(d=a.next()).done;)c.push(d.value);return c};$jscomp.arrayFromIterable=function(a){return a instanceof Array?a:$jscomp.arrayFromIterator($jscomp.makeIterator(a))};"undefined"==typeof _pio&&(_pio={});
(function(){_pio.channel=function(){};_pio.channel.prototype.call=function(a,d,c,f,g){var b="undefined"!=typeof PLAYERIO_API_HOST?PLAYERIO_API_HOST:(PlayerIO.useSecureApiRequests?"https":"http")+"://api.playerio.com/json/",e=new XMLHttpRequest;"withCredentials"in e?e.open("post",b,!0):"undefined"!=typeof XDomainRequest?(e=new XDomainRequest,e.open("post",b)):e=new _pio.flashWebRequest("post",b);var h=Error();null!=e?(e.send("["+a+"|"+(this.token||"")+"]"+JSON.stringify(d)),e.onload=function(){var k=
null;try{var l=e.response||e.responseText;if("["==l[0]){var m=l.indexOf("]");this.token=l.substring(1,m);l=l.substring(m+1)}k=JSON.parse(l)}catch(n){_pio.handleError(h,f,PlayerIOErrorCode.GeneralError,"Error decoding response from webservice: "+n);return}if("undefined"==typeof k.errorcode&&"undefined"==typeof k.message){l=k;if(g)try{l=g(k)}catch(n){_pio.handleError(h,f,n.code,n.message)}c&&c(l)}else _pio.handleError(h,f,k.errorcode,k.message)},e.onerror=function(k){_pio.handleError(h,f,PlayerIOErrorCode.GeneralError,
"Error talking to webservice: "+JSON.stringify(k))}):_pio.handleError(h,f,PlayerIOErrorCode.GeneralError,"Need to implement flash calling")};_pio.runCallback=function(a,d,c){try{a&&a(d)}catch(f){a="Unhandled error in callback: "+f.message,a=a+"\nStack:\n"+(f.stack||f.stacktrace||f.StackTrace),c&&(a=a+"\nCallsite stack:\n"+(c.stack||c.stacktrace||c.StackTrace)),console.log(a)}};_pio.handleError=function(a,d,c,f){c=_pio.error(c,f);a&&(a.stack&&(c.stack=a.stack),a.stacktrace&&(c.stacktrace=a.stacktrace),
a.StackTrace&&(c.StackTrace=a.StackTrace));d?_pio.runCallback(d,c,a):"undefined"!=typeof console?console.log("No error callback specified for: "+c.code+": "+c.message+"\n"+(c.stack||c.stacktrace||c.StackTrace)):alert("No error callback specified for: "+c.code+": "+c.message+"\n"+(c.stack||c.stacktrace||c.StackTrace))};_pio.error=function(a,d){1==arguments.length&&(d=a,a=PlayerIOErrorCode.GeneralError);"number"==typeof a&&(a=PlayerIOErrorCode.codes[a]);if("string"!=typeof a)throw console.log(a,d,Error().stack),
"Code must be a string!";var c=Error();return new PlayerIOError(a,d,c.stack||c.stacktrace||c.StackTrace)};_pio.debugLog=function(a){"undefined"!=typeof console&&console.log(a)};_pio.convertToKVArray=function(a){var d=[];if(a)for(var c in a)d.push({key:""+c,value:""+a[c]});return d};_pio.convertFromKVArray=function(a){var d={};if(a&&a.length)for(var c in a)d[a[c].key]=a[c].value;return d};_pio.convertToSegmentArray=function(a){var d=[];if(a)for(var c in a)d.push(c+":"+a[c]);return d}})();
PlayerIO={useSecureApiRequests:!1,authenticate:function(a,d,c,f,g,b){if("auto"==c.publishingnetworklogin)"undefined"==typeof window.PublishingNetwork?b(new PlayerIOError(PlayerIOErrorCode.GeneralError,"Could not find the PublishingNetwork object on the current page. Did you include the PublishingNetwork.js script?")):PublishingNetwork.dialog("login",{gameId:a,connectionId:d,__use_usertoken__:!0},function(h){h.error?b(new PlayerIOError(PlayerIOErrorCode.GeneralError,h.error)):"undefined"==typeof h.userToken?
b(new PlayerIOError(PlayerIOErrorCode.GeneralError,"Missing userToken value in result, but no error message given.")):PlayerIO.authenticate(a,d,{userToken:h.userToken},f,g,b)});else{var e=new _pio.channel;e.authenticate(a,d,_pio.convertToKVArray(c),_pio.convertToSegmentArray(f),"javascript",_pio.convertToKVArray({}),null,g,b,function(h){e.token=h.token;return new _pio.client(e,a,h.gamefsredirectmap,h.userid)})}},quickConnect:null,gameFS:function(a){return new _pio.gameFS(a)}};var JSON;
JSON||(JSON={});
(function(){function a(l){return 10>l?"0"+l:l}function d(l){g.lastIndex=0;return g.test(l)?'"'+l.replace(g,function(m){var n=h[m];return"string"===typeof n?n:"\\u"+("0000"+m.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+l+'"'}function c(l,m){var n,p=b,q=m[l];q&&"object"===typeof q&&"function"===typeof q.toJSON&&(q=q.toJSON(l));"function"===typeof k&&(q=k.call(m,l,q));switch(typeof q){case "string":return d(q);case "number":return isFinite(q)?String(q):"null";case "boolean":case "null":return String(q);case "object":if(!q)return"null";
b+=e;var r=[];if("[object Array]"===Object.prototype.toString.apply(q)){var u=q.length;for(n=0;n<u;n+=1)r[n]=c(n,q)||"null";var x=0===r.length?"[]":b?"[\n"+b+r.join(",\n"+b)+"\n"+p+"]":"["+r.join(",")+"]";b=p;return x}if(k&&"object"===typeof k)for(u=k.length,n=0;n<u;n+=1){if("string"===typeof k[n]){var w=k[n];(x=c(w,q))&&r.push(d(w)+(b?": ":":")+x)}}else for(w in q)Object.prototype.hasOwnProperty.call(q,w)&&(x=c(w,q))&&r.push(d(w)+(b?": ":":")+x);x=0===r.length?"{}":b?"{\n"+b+r.join(",\n"+b)+"\n"+
p+"}":"{"+r.join(",")+"}";b=p;return x}}"function"!==typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(l){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+a(this.getUTCMonth()+1)+"-"+a(this.getUTCDate())+"T"+a(this.getUTCHours())+":"+a(this.getUTCMinutes())+":"+a(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(l){return this.valueOf()});var f=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,
g=/[\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,b,e,h={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},k;"function"!==typeof JSON.stringify&&(JSON.stringify=function(l,m,n){var p;e=b="";if("number"===typeof n)for(p=0;p<n;p+=1)e+=" ";else"string"===typeof n&&(e=n);if((k=m)&&"function"!==typeof m&&("object"!==typeof m||"number"!==typeof m.length))throw Error("JSON.stringify");return c("",{"":l})});
"function"!==typeof JSON.parse&&(JSON.parse=function(l,m){function n(q,r){var u,x=q[r];if(x&&"object"===typeof x)for(u in x)if(Object.prototype.hasOwnProperty.call(x,u)){var w=n(x,u);void 0!==w?x[u]=w:delete x[u]}return m.call(q,r,x)}l=String(l);f.lastIndex=0;f.test(l)&&(l=l.replace(f,function(q){return"\\u"+("0000"+q.charCodeAt(0).toString(16)).slice(-4)}));if(/^[\],:{}\s]*$/.test(l.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,
"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){var p=eval("("+l+")");return"function"===typeof m?n({"":p},""):p}throw new SyntaxError("JSON.parse");})})();
(function(){function a(h){if(null!=g)h(g);else if(b)h(null);else if(null==e){e=[h];var k=setInterval(function(){var m=d();null!=m&&l(m)},50);setTimeout(function(){null==g&&l(null)},3E4);var l=function(m){g=m;b=null==m;clearInterval(k);for(var n=0;n!=e.length;n++)e[n](m)}}else e.push(h)}function d(){var h='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" width="10" height="10" style="$style$" id="$id$">\t<param name="movie" value="$src$" />\t<param name="allowNetworking" value="all" />\t<param name="allowScriptAccess" value="always" />\t\x3c!--[if !IE]>--\x3e\t<object type="application/x-shockwave-flash" data="$src$" width="10" height="10" style="$style$">\t\t<param name="allowNetworking" value="all" />\t\t<param name="allowScriptAccess" value="always" />\t</object>\t\x3c!--<![endif]--\x3e</object>'.replace(/\$id\$/gi,"__pio_flashfallback__");
h=h.replace(/\$src\$/gi,"http://192.168.30.154/html5client/FlashFallback/bin-debug/FlashFallback.swf");h=h.replace(/\$style\$/gi,"width:10px;height:10px");var k=document.getElementById("containerId");if(!k){var l=document.createElement("div");l.setAttribute("id",k);l.setAttribute("style","position:absolute;top:-20px;left:-20px");l.innerHTML=h;try{document.body.appendChild(l)}catch(m){}}h=function(m){m=document.getElementsByTagName(m);for(var n=0;n!=m.length;n++)if(m[n].ping&&"pong"==m[n].ping())return m[n]};
return h("embed")||h("object")}var c={},f=0;__pio_flashfallback_callback__=function(){var h=c[arguments[0]];if(h){for(var k=[],l=1;l!=arguments.length;l++)k[l-1]=arguments[l];h.apply(null,k)}};_pio.flashWebRequest=function(h,k){var l=this;this.response=null;this.onload=function(){};this.onerror=function(){};this.send=function(m){a(function(n){if(null==n)l.onerror("Browser does not support Cross-Origin (CORS) webrequest or Flash as a fallback method");else{var p="cb"+f++;c[p]=function(q,r){delete c[p];
if(q)l.response=r,l.onload();else l.onerror(r)};n.webrequest(p,h,k,m)}})}};_pio.flashSocketConnection=function(h,k,l,m,n){var p="cb"+f++,q=this,r=new _pio.messageSerializer,u=!1,x=!1,w=setTimeout(function(){u||(u=!0,l(!1,"Connect attempt timed out"))},k);this.disconnect=function(){console.log("... this shouldn't happen")};this.sendMessage=function(v){console.log("... send msg. this shouldn't happen")};a(function(v){null==v?(u=!0,l(!1,"Browser does not support WebSocket connections and the Flash fallback failed.")):
(c[p]=function(F,y){switch(F){case "onopen":u||(clearTimeout(w),x=u=!0,v.socketSend(p,[0]),l(x));break;case "onclose":q.disconnect();break;case "onerror":q.disconnect();break;case "onmessage":n(r.deserializeMessage(y,0,y.length))}},q.disconnect=function(){if(x){x=!1;m();try{v.socketClose(p)}catch(F){_pio.debugLog(F)}}},q.sendMessage=function(F){F=r.serializeMessage(F);v.socketSend(p,F)},v.socketConnection(p,h))})};_pio.isFlashFallbackEnabled=function(h){a(function(k){h(null!=k)})};var g=null,b=!1,
e=null})();
(function(){var a=_pio.channel.prototype;a.connect=function(d,c,f,g,b,e,h,k,l,m,n){this.call(10,{gameid:d,connectionid:c,userid:f,auth:g,partnerid:b,playerinsightsegments:e,clientapi:h,clientinfo:k},l,m,n)};_pio.ApiSecurityRule={RespectClientSetting:0,UseHttp:1,UseHttps:2};a.authenticate=function(d,c,f,g,b,e,h,k,l,m){this.call(13,{gameid:d,connectionid:c,authenticationarguments:f,playerinsightsegments:g,clientapi:b,clientinfo:e,playcodes:h},k,l,m)};a.createRoom=function(d,c,f,g,b,e,h,k){this.call(21,{roomid:d,
roomtype:c,visible:f,roomdata:g,isdevroom:b},e,h,k)};a.joinRoom=function(d,c,f,g,b,e){this.call(24,{roomid:d,joindata:c,isdevroom:f},g,b,e)};a.createJoinRoom=function(d,c,f,g,b,e,h,k,l){this.call(27,{roomid:d,roomtype:c,visible:f,roomdata:g,joindata:b,isdevroom:e},h,k,l)};a.listRooms=function(d,c,f,g,b,e,h,k){this.call(30,{roomtype:d,searchcriteria:c,resultlimit:f,resultoffset:g,onlydevrooms:b},e,h,k)};a.userLeftRoom=function(d,c,f,g,b,e){this.call(40,{extendedroomid:d,newplayercount:c,closed:f},
g,b,e)};a.writeError=function(d,c,f,g,b,e,h,k){this.call(50,{source:d,error:c,details:f,stacktrace:g,extradata:b},e,h,k)};a.updateRoom=function(d,c,f,g,b,e){this.call(53,{extendedroomid:d,visible:c,roomdata:f},g,b,e)};_pio.ValueType={String:0,Int:1,UInt:2,Long:3,Bool:4,Float:5,Double:6,ByteArray:7,DateTime:8,Array:9,Obj:10};a.createObjects=function(d,c,f,g,b){this.call(82,{objects:d,loadexisting:c},f,g,b)};a.loadObjects=function(d,c,f,g){this.call(85,{objectids:d},c,f,g)};_pio.LockType={NoLocks:0,
LockIndividual:1,LockAll:2};a.saveObjectChanges=function(d,c,f,g,b,e){this.call(88,{locktype:d,changesets:c,createifmissing:f},g,b,e)};a.deleteObjects=function(d,c,f,g){this.call(91,{objectids:d},c,f,g)};a.loadMatchingObjects=function(d,c,f,g,b,e,h){this.call(94,{table:d,index:c,indexvalue:f,limit:g},b,e,h)};a.loadIndexRange=function(d,c,f,g,b,e,h,k){this.call(97,{table:d,index:c,startindexvalue:f,stopindexvalue:g,limit:b},e,h,k)};a.deleteIndexRange=function(d,c,f,g,b,e,h){this.call(100,{table:d,
index:c,startindexvalue:f,stopindexvalue:g},b,e,h)};a.loadMyPlayerObject=function(d,c,f){this.call(103,{},d,c,f)};a.payVaultReadHistory=function(d,c,f,g,b,e){this.call(160,{page:d,pagesize:c,targetuserid:f},g,b,e)};a.payVaultRefresh=function(d,c,f,g,b){this.call(163,{lastversion:d,targetuserid:c},f,g,b)};a.payVaultConsume=function(d,c,f,g,b){this.call(166,{ids:d,targetuserid:c},f,g,b)};a.payVaultCredit=function(d,c,f,g,b,e){this.call(169,{amount:d,reason:c,targetuserid:f},g,b,e)};a.payVaultDebit=
function(d,c,f,g,b,e){this.call(172,{amount:d,reason:c,targetuserid:f},g,b,e)};a.payVaultBuy=function(d,c,f,g,b,e){this.call(175,{items:d,storeitems:c,targetuserid:f},g,b,e)};a.payVaultGive=function(d,c,f,g,b){this.call(178,{items:d,targetuserid:c},f,g,b)};a.payVaultPaymentInfo=function(d,c,f,g,b,e){this.call(181,{provider:d,purchasearguments:c,items:f},g,b,e)};a.payVaultUsePaymentInfo=function(d,c,f,g,b){this.call(184,{provider:d,providerarguments:c},f,g,b)};a.partnerPayTrigger=function(d,c,f,g,
b){this.call(200,{key:d,count:c},f,g,b)};a.partnerPaySetTag=function(d,c,f,g){this.call(203,{partnerid:d},c,f,g)};a.notificationsRefresh=function(d,c,f,g){this.call(213,{lastversion:d},c,f,g)};a.notificationsRegisterEndpoints=function(d,c,f,g,b){this.call(216,{lastversion:d,endpoints:c},f,g,b)};a.notificationsSend=function(d,c,f,g){this.call(219,{notifications:d},c,f,g)};a.notificationsToggleEndpoints=function(d,c,f,g,b,e){this.call(222,{lastversion:d,endpoints:c,enabled:f},g,b,e)};a.notificationsDeleteEndpoints=
function(d,c,f,g,b){this.call(225,{lastversion:d,endpoints:c},f,g,b)};a.gameRequestsSend=function(d,c,f,g,b,e){this.call(241,{requesttype:d,requestdata:c,requestrecipients:f},g,b,e)};a.gameRequestsRefresh=function(d,c,f,g){this.call(244,{playcodes:d},c,f,g)};a.gameRequestsDelete=function(d,c,f,g){this.call(247,{requestids:d},c,f,g)};a.achievementsRefresh=function(d,c,f,g){this.call(271,{lastversion:d},c,f,g)};a.achievementsLoad=function(d,c,f,g){this.call(274,{userids:d},c,f,g)};a.achievementsProgressSet=
function(d,c,f,g,b){this.call(277,{achievementid:d,progress:c},f,g,b)};a.achievementsProgressAdd=function(d,c,f,g,b){this.call(280,{achievementid:d,progressdelta:c},f,g,b)};a.achievementsProgressMax=function(d,c,f,g,b){this.call(283,{achievementid:d,progress:c},f,g,b)};a.achievementsProgressComplete=function(d,c,f,g){this.call(286,{achievementid:d},c,f,g)};a.playerInsightRefresh=function(d,c,f){this.call(301,{},d,c,f)};a.playerInsightSetSegments=function(d,c,f,g){this.call(304,{segments:d},c,f,g)};
a.playerInsightTrackInvitedBy=function(d,c,f,g,b){this.call(307,{invitinguserid:d,invitationchannel:c},f,g,b)};a.playerInsightTrackEvents=function(d,c,f,g){this.call(311,{events:d},c,f,g)};a.playerInsightTrackExternalPayment=function(d,c,f,g,b){this.call(314,{currency:d,amount:c},f,g,b)};a.playerInsightSessionKeepAlive=function(d,c,f){this.call(317,{},d,c,f)};a.playerInsightSessionStop=function(d,c,f){this.call(320,{},d,c,f)};a.oneScoreLoad=function(d,c,f,g){this.call(351,{userids:d},c,f,g)};a.oneScoreSet=
function(d,c,f,g){this.call(354,{score:d},c,f,g)};a.oneScoreAdd=function(d,c,f,g){this.call(357,{score:d},c,f,g)};a.oneScoreRefresh=function(d,c,f){this.call(360,{},d,c,f)};a.simpleConnect=function(d,c,f,g,b,e,h,k,l){this.call(400,{gameid:d,usernameoremail:c,password:f,playerinsightsegments:g,clientapi:b,clientinfo:e},h,k,l)};a.simpleRegister=function(d,c,f,g,b,e,h,k,l,m,n,p,q,r){this.call(403,{gameid:d,username:c,password:f,email:g,captchakey:b,captchavalue:e,extradata:h,partnerid:k,playerinsightsegments:l,
clientapi:m,clientinfo:n},p,q,r)};a.simpleRecoverPassword=function(d,c,f,g,b){this.call(406,{gameid:d,usernameoremail:c},f,g,b)};a.kongregateConnect=function(d,c,f,g,b,e,h,k,l){this.call(412,{gameid:d,userid:c,gameauthtoken:f,playerinsightsegments:g,clientapi:b,clientinfo:e},h,k,l)};a.simpleGetCaptcha=function(d,c,f,g,b,e){this.call(415,{gameid:d,width:c,height:f},g,b,e)};a.facebookOAuthConnect=function(d,c,f,g,b,e,h,k,l){this.call(418,{gameid:d,accesstoken:c,partnerid:f,playerinsightsegments:g,clientapi:b,
clientinfo:e},h,k,l)};a.steamConnect=function(d,c,f,g,b,e,h,k,l){this.call(421,{gameid:d,steamappid:c,steamsessionticket:f,playerinsightsegments:g,clientapi:b,clientinfo:e},h,k,l)};a.simpleUserGetSecureLoginInfo=function(d,c,f){this.call(424,{},d,c,f)};a.joinCluster=function(d,c,f,g,b,e,h,k,l,m,n,p,q,r,u,x,w){this.call(504,{clusteraccesskey:d,isdevelopmentserver:c,ports:f,machinename:g,version:b,machineid:e,os:h,cpu:k,cpucores:l,cpulogicalcores:m,cpuaddresswidth:n,cpumaxclockspeed:p,rammegabytes:q,
ramspeed:r},u,x,w)};a.serverHeartbeat=function(d,c,f,g,b,e,h,k,l,m,n,p,q,r,u,x,w,v,F,y){this.call(510,{serverid:d,appdomains:c,servertypes:f,machinecpu:g,processcpu:b,memoryusage:e,avaliablememory:h,freememory:k,runningrooms:l,usedresources:m,apirequests:n,apirequestserror:p,apirequestsfailed:q,apirequestsexecuting:r,apirequestsqueued:u,apirequeststime:x,serverunixtimeutc:w},v,F,y)};a.getGameAssemblyUrl=function(d,c,f,g,b,e){this.call(513,{clusteraccesskey:d,gamecodeid:c,machineid:f},g,b,e)};a.devServerLogin=
function(d,c,f,g,b){this.call(524,{username:d,password:c},f,g,b)};a.webserviceOnlineTest=function(d,c,f){this.call(533,{},d,c,f)};a.getServerInfo=function(d,c,f,g){this.call(540,{machineid:d},c,f,g)};a.socialRefresh=function(d,c,f){this.call(601,{},d,c,f)};a.socialLoadProfiles=function(d,c,f,g){this.call(604,{userids:d},c,f,g)}})();
PlayerIOError=function(a,d,c){this.code=a;this.message=d;this.stack=c;this.stack||(c=Error(),this.stack=c.stack||c.stacktrace||c.StackTrace);this.toString=function(){return"PlayerIOError["+a+"]: "+d}};PlayerIOError.prototype=Error();
PlayerIOErrorCode={UnsupportedMethod:"UnsupportedMethod",GeneralError:"GeneralError",InternalError:"InternalError",AccessDenied:"AccessDenied",InvalidMessageFormat:"InvalidMessageFormat",MissingValue:"MissingValue",GameRequired:"GameRequired",ExternalError:"ExternalError",ArgumentOutOfRange:"ArgumentOutOfRange",GameDisabled:"GameDisabled",UnknownGame:"UnknownGame",UnknownConnection:"UnknownConnection",InvalidAuth:"InvalidAuth",NoServersAvailable:"NoServersAvailable",RoomDataTooLarge:"RoomDataTooLarge",
RoomAlreadyExists:"RoomAlreadyExists",UnknownRoomType:"UnknownRoomType",UnknownRoom:"UnknownRoom",MissingRoomId:"MissingRoomId",RoomIsFull:"RoomIsFull",NotASearchColumn:"NotASearchColumn",QuickConnectMethodNotEnabled:"QuickConnectMethodNotEnabled",UnknownUser:"UnknownUser",InvalidPassword:"InvalidPassword",InvalidRegistrationData:"InvalidRegistrationData",InvalidBigDBKey:"InvalidBigDBKey",BigDBObjectTooLarge:"BigDBObjectTooLarge",BigDBObjectDoesNotExist:"BigDBObjectDoesNotExist",UnknownTable:"UnknownTable",
UnknownIndex:"UnknownIndex",InvalidIndexValue:"InvalidIndexValue",NotObjectCreator:"NotObjectCreator",KeyAlreadyUsed:"KeyAlreadyUsed",StaleVersion:"StaleVersion",CircularReference:"CircularReference",HeartbeatFailed:"HeartbeatFailed",InvalidGameCode:"InvalidGameCode",VaultNotLoaded:"VaultNotLoaded",UnknownPayVaultProvider:"UnknownPayVaultProvider",DirectPurchaseNotSupportedByProvider:"DirectPurchaseNotSupportedByProvider",BuyingCoinsNotSupportedByProvider:"BuyingCoinsNotSupportedByProvider",NotEnoughCoins:"NotEnoughCoins",
ItemNotInVault:"ItemNotInVault",InvalidPurchaseArguments:"InvalidPurchaseArguments",InvalidPayVaultProviderSetup:"InvalidPayVaultProviderSetup",UnknownPartnerPayAction:"UnknownPartnerPayAction",InvalidType:"InvalidType",IndexOutOfBounds:"IndexOutOfBounds",InvalidIdentifier:"InvalidIdentifier",InvalidArgument:"InvalidArgument",LoggedOut:"LoggedOut",InvalidSegment:"InvalidSegment",GameRequestsNotLoaded:"GameRequestsNotLoaded",AchievementsNotLoaded:"AchievementsNotLoaded",UnknownAchievement:"UnknownAchievement",
NotificationsNotLoaded:"NotificationsNotLoaded",InvalidNotificationsEndpoint:"InvalidNotificationsEndpoint",NetworkIssue:"NetworkIssue",OneScoreNotLoaded:"OneScoreNotLoaded",PublishingNetworkNotAvailable:"PublishingNetworkNotAvailable",PublishingNetworkNotLoaded:"PublishingNetworkNotLoaded",DialogClosed:"DialogClosed",AdTrackCheckCookie:"AdTrackCheckCookie",codes:{0:"UnsupportedMethod",1:"GeneralError",2:"InternalError",3:"AccessDenied",4:"InvalidMessageFormat",5:"MissingValue",6:"GameRequired",7:"ExternalError",
8:"ArgumentOutOfRange",9:"GameDisabled",10:"UnknownGame",11:"UnknownConnection",12:"InvalidAuth",13:"NoServersAvailable",14:"RoomDataTooLarge",15:"RoomAlreadyExists",16:"UnknownRoomType",17:"UnknownRoom",18:"MissingRoomId",19:"RoomIsFull",20:"NotASearchColumn",21:"QuickConnectMethodNotEnabled",22:"UnknownUser",23:"InvalidPassword",24:"InvalidRegistrationData",25:"InvalidBigDBKey",26:"BigDBObjectTooLarge",27:"BigDBObjectDoesNotExist",28:"UnknownTable",29:"UnknownIndex",30:"InvalidIndexValue",31:"NotObjectCreator",
32:"KeyAlreadyUsed",33:"StaleVersion",34:"CircularReference",40:"HeartbeatFailed",41:"InvalidGameCode",50:"VaultNotLoaded",51:"UnknownPayVaultProvider",52:"DirectPurchaseNotSupportedByProvider",54:"BuyingCoinsNotSupportedByProvider",55:"NotEnoughCoins",56:"ItemNotInVault",57:"InvalidPurchaseArguments",58:"InvalidPayVaultProviderSetup",70:"UnknownPartnerPayAction",80:"InvalidType",81:"IndexOutOfBounds",82:"InvalidIdentifier",83:"InvalidArgument",84:"LoggedOut",90:"InvalidSegment",100:"GameRequestsNotLoaded",
110:"AchievementsNotLoaded",111:"UnknownAchievement",120:"NotificationsNotLoaded",121:"InvalidNotificationsEndpoint",130:"NetworkIssue",131:"OneScoreNotLoaded",200:"PublishingNetworkNotAvailable",201:"PublishingNetworkNotLoaded",301:"DialogClosed",302:"AdTrackCheckCookie"}};
(function(){_pio.client=function(a,d,c,f){this.connectUserId=f;this.gameId=d;this.gameFS=new _pio.gameFS(d,c);this.errorLog=new _pio.errorLog(a);this.payVault=new _pio.payVault(a);this.bigDB=new _pio.bigDB(a);this.multiplayer=new _pio.multiplayer(a);this.gameRequests=new _pio.gameRequests(a);this.achievements=new _pio.achievements(a);this.playerInsight=new _pio.playerInsight(a);this.oneScore=new _pio.oneScore(a);this.notifications=new _pio.notifications(a);this.publishingNetwork=new _pio.publishingNetwork(a,
this.connectUserId)}})();
(function(){var a={};_pio.gameFS=function(d,c){if("string"==typeof c&&0<c.length){var f=(c||"").split("|");if(1<=f.length)for(var g=a[d.toLowerCase()]={},b=0;b!=f.length;b++){var e=f[b];"alltoredirect"==e||"cdnmap"==e?g.baseUrl=f[b+1]:"alltoredirectsecure"==e||"cdnmapsecure"==e?g.secureBaseUrl=f[b+1]:g["."+e]=f[b+1]}}this.getUrl=function(h,k){if("/"==!h[0])throw _pio.error("The path given to getUrl must start with a slash, like: '/myfile.swf' or '/folder/file.jpg'");var l=a[d];return l?(k?l.secureBaseUrl:
l.baseUrl)+(l["."+h]||h):(k?"https":"http")+"://r.playerio.com/r/"+d+h}}})();
(function(){_pio.gameRequests=function(a){function d(g){if(null==g||0==g.length)return[];for(var b=[],e=0;e!=g.length;e++){var h=g[e];b.push(new _pio.gameRequest(h.id,h.type,h.senderuserid,h.created,h.data))}return b}var c=[];this.waitingRequests="[ERROR: You tried to access gameRequests.waitingRequests before loading waiting requests. You have to call the refresh method first.]";var f=this;this.send=function(g,b,e,h,k){a.gameRequestsSend(g,_pio.convertToKVArray(b),e,h,k,function(l){})};this.refresh=
function(g,b){a.gameRequestsRefresh(c,g,b,function(e){f._playCodes=e.newplaycodes;f.waitingRequests=d(e.requests)})};this["delete"]=function(g,b,e){if("object"==typeof g||g.length){for(var h=[],k=0;k!=g.length;k++){var l=g[k].id;if(l)h.push(l);else{g=_pio.error("No GameRequest id found on item#"+k+". You have to use requests from the gameRequests.waitingRequests array. For instance: client.gameRequests.delete(client.gameRequests.waitingRequests, ...)");_pio.handleError(g,e,g.code,g.message);return}}a.gameRequestsDelete(h,
b,e,function(m){f.waitingRequests=d(m.requests)})}else g=_pio.error("The first argument to delete should be an array: client.gameRequests.delete([requests], ...)"),_pio.handleError(g,e,g.code,g.message)}};_pio.gameRequest=function(a,d,c,f,g){this.id=a;this.type=d;this.senderUserId=c;this.created=new Date(f);this.data=_pio.convertFromKVArray(g)}})();(function(){_pio.errorLog=function(a){this.writeError=function(d,c,f,g){a.writeError("Javascript",d,c,f,_pio.convertToKVArray(g))}}})();
(function(){_pio.quickConnect=function(){this.simpleGetCaptcha=function(a,d,c,f,g){(new _pio.channel).simpleGetCaptcha(a,d,c,f,g,function(b){return new _pio.simpleGetCaptchaOutput(b.captchakey,b.captchaimageurl)})};this.simpleRecoverPassword=function(a,d,c,f){(new _pio.channel).simpleRecoverPassword(a,d,c,f,function(g){})}};_pio.simpleGetCaptchaOutput=function(a,d){this.captchaKey=a;this.captchaImageUrl=d};PlayerIO.quickConnect=new _pio.quickConnect})();
(function(){_pio.payVault=function(a){function d(g){if(null!=g&&(c=g.version,f.coins=g.coins||0,f.items=[],g.items&&g.items.length))for(var b=0;b!=g.items.length;b++){var e=g.items[b],h=f.items[b]=new _pio.vaultItem(e.id,e.itemkey,(new Date).setTime(e.purchasedate));_pio.bigDBDeserialize(e.properties,h,!0)}}var c=null;this.coins="[ERROR: you tried to access payVault.coins before the vault was loaded. You have to refresh the vault before the .coins property is set to the right value]";this.items="[ERROR: you tried to access payVault.items before the vault was loaded. You have to refresh the vault before the .items property is set to the right value]";
this.has=function(g){if(null==c)throw new PlayerIOError(PlayerIOErrorCode.VaultNotLoaded,"Cannot access items before vault has been loaded. Please refresh the vault first");for(var b=0;b!=this.items.length;b++)if(this.items[b].itemKey==g)return!0;return!1};this.first=function(g){if(null==c)throw new PlayerIOError(PlayerIOErrorCode.VaultNotLoaded,"Cannot access items before vault has been loaded. Please refresh the vault first");for(var b=0;b!=this.items.length;b++)if(this.items[b].itemKey==g)return this.items[b];
return null};this.count=function(g){if(null==c)throw new PlayerIOError(PlayerIOErrorCode.VaultNotLoaded,"Cannot access items before vault has been loaded. Please refresh the vault first");for(var b=0,e=0;e!=this.items.length;e++)this.items[e].itemKey==g&&b++;return b};this.refresh=function(g,b){a.payVaultRefresh(c,null,g,b,function(e){d(e.vaultcontents)})};this.readHistory=function(g,b,e,h){a.payVaultReadHistory(g,b,null,e,h,function(k){for(var l=[],m=0;m!=k.entries.length;m++){var n=k.entries[m];
l.push(new _pio.payVaultHistoryEntry(n.type,n.amount,n.timestamp,n.itemkeys||[],n.reason,n.providertransactionid,n.providerprice))}return l})};this.credit=function(g,b,e,h){a.payVaultCredit(g,b,null,e,h,function(k){d(k.vaultcontents)})};this.debit=function(g,b,e,h){a.payVaultDebit(g,b,null,e,h,function(k){d(k.vaultcontents)})};this.consume=function(g,b,e){if("object"==typeof g||g.length){for(var h=[],k=0;k!=g.length;k++){var l=g[k].id;if(l)h.push(l);else{g=_pio.error("No PayVault item id found on item#"+
k+". You have to use items from the payVault.items array. For instance: client.payVault.consume([client.payVault.first('sportscar')], ...)");_pio.handleError(g,e,g.code,g.message);return}}a.payVaultConsume(h,null,b,e,function(m){d(m.vaultcontents)})}else g=_pio.error("The first argument to consume should be an array: client.payVault.consume([item], ...)"),_pio.handleError(g,e,g.code,g.message)};this.buy=function(g,b,e,h){a.payVaultBuy(_pio.convertBuyItems(g),b,null,e,h,function(k){d(k.vaultcontents)})};
this.give=function(g,b,e){a.payVaultGive(_pio.convertBuyItems(g),null,b,e,function(h){d(h.vaultcontents)})};this.getBuyCoinsInfo=function(g,b,e,h){a.payVaultPaymentInfo(g,_pio.convertToKVArray(b),null,e,h,function(k){return _pio.convertFromKVArray(k.providerarguments)})};this.getBuyDirectInfo=function(g,b,e,h,k){a.payVaultPaymentInfo(g,_pio.convertToKVArray(b),_pio.convertBuyItems(e),h,k,function(l){return _pio.convertFromKVArray(l.providerarguments)})};var f=this};_pio.convertBuyItems=function(a){if(null==
a)return[];for(var d=[],c=0;c!=a.length;c++){var f=a[c].itemkey;if(!f)throw _pio.error("You have to specify an itemkey for the payvault item. Example:  {itemkey:'car'}");d.push({itemkey:f,payload:_pio.compareForChanges({itemkey:f},a[c],!0,!0)})}return d};_pio.vaultItem=function(a,d,c){this.id=a;this.itemKey=d;this.purchaseDate=c};_pio.payVaultHistoryEntry=function(a,d,c,f,g,b,e){this.type=a;this.amount=d;this.timestamp=(new Date).setTime(c);this.itemKeys=f;this.reason=g;this.providerTransactionId=
b;this.providerPrice=e}})();
(function(){_pio.bigDB=function(a){function d(){for(var b=0;b<g.length;b++){var e=g[b],h=!0,k;for(k in e.objects)if(e.objects[k]._internal_("get-is-saving")){h=!1;break}if(h){for(k in e.objects)for(h=b+1;h<g.length;h++){futureSave=g[h];for(var l=0;l<futureSave.objects.length;l++)futureSave.objects[l]==e.objects[k]&&futureSave.fullOverwrite==e.fullOverwrite&&futureSave.useOptimisticLock==e.useOptimisticLock&&(e.changesets[k]=futureSave.changesets[l],e.futureSaves.push(futureSave))}g.splice(b,1);b--;
e.execute()}}}function c(b,e){null==b?b=[]:b instanceof Array||(b=[b]);null!=e&&(b=b.concat([e]));for(var h=[],k=0;k!=b.length;k++){var l=b[k];switch(typeof l){case "boolean":h.push({valuetype:_pio.ValueType.Bool,bool:l});break;case "string":h.push({valuetype:_pio.ValueType.String,string:l});break;case "number":0!=l%1?h.push({valuetype:_pio.ValueType.Double,"double":l}):-2147483648<l&&2147483647>l?h.push({valuetype:_pio.ValueType.Int,"int":l}):0<l&&4294967295>l?h.push({valuetype:_pio.ValueType.UInt,
uint:l}):h.push({valuetype:_pio.ValueType.Long,"long":l});break;case "object":if(l.getTime&&l.getMilliseconds)h.push({valuetype:_pio.ValueType.DateTime,datetime:l.getTime()});else throw Error("Don't know how to serialize type '"+typeof l+"' for BigDB");break;default:throw Error("Don't know how to serialize type '"+typeof l+"' for BigDB");}}return h}var f=this,g=[];this.createObject=function(b,e,h,k,l){var m=_pio.compareForChanges({},h||{},!0,!0);a.createObjects([{key:e,table:b,properties:m}],!1,k,
l,function(n){if(1==n.objects.length)return new _pio.databaseobject(f,b,n.objects[0].key,n.objects[0].version,!1,m);throw new PlayerIOError(PlayerIOErrorCode.GeneralError,"Error creating object");})};this.loadMyPlayerObject=function(b,e){a.loadMyPlayerObject(b,e,function(h){return new _pio.databaseobject(f,"PlayerObjects",h.playerobject.key,h.playerobject.version,!0,h.playerobject.properties)})};this.load=function(b,e,h,k){a.loadObjects([{table:b,keys:[e]}],h,k,function(l){if(1==l.objects.length)return null==
l.objects[0]?null:new _pio.databaseobject(f,b,l.objects[0].key,l.objects[0].version,!1,l.objects[0].properties);throw new PlayerIOError(PlayerIOErrorCode.GeneralError,"Error loading object");})};this.loadKeys=function(b,e,h,k){a.loadObjects([{table:b,keys:e}],h,k,function(l){for(var m=[],n=0;n!=l.objects.length;n++){var p=l.objects[n];m[n]=null==p?null:new _pio.databaseobject(f,b,p.key,p.version,!1,p.properties)}return m})};this.loadOrCreate=function(b,e,h,k){a.createObjects([{key:e,table:b,properties:[]}],
!0,h,k,function(l){if(1==l.objects.length)return new _pio.databaseobject(f,b,l.objects[0].key,l.objects[0].version,!1,l.objects[0].properties);throw new PlayerIOError(PlayerIOErrorCode.GeneralError,"Error creating object");})};this.deleteKeys=function(b,e,h,k){a.deleteObjects([{table:b,keys:e}],h,k,function(l){return null})};this.loadKeysOrCreate=function(b,e,h,k){for(var l=[],m=0;m!=e.length;m++)l.push({key:e[m],table:b,properties:[]});a.createObjects(l,!0,h,k,function(n){for(var p=[],q=0;q!=n.objects.length;q++){var r=
n.objects[q];p[q]=new _pio.databaseobject(f,b,r.key,r.version,!1,r.properties)}return p})};this.loadSingle=function(b,e,h,k,l){a.loadMatchingObjects(b,e,c(h),1,k,l,function(m){return 0==m.objects.length?null:new _pio.databaseobject(f,b,m.objects[0].key,m.objects[0].version,!1,m.objects[0].properties)})};this.loadRange=function(b,e,h,k,l,m,n,p){a.loadIndexRange(b,e,c(h,k),c(h,l),m,n,p,function(q){for(var r=[],u=0;u!=q.objects.length;u++){var x=q.objects[u];r[u]=null==x?null:new _pio.databaseobject(f,
b,x.key,x.version,!1,x.properties)}return r})};this.deleteRange=function(b,e,h,k,l,m,n){a.deleteIndexRange(b,e,c(h,k),c(h,l),m,n,function(){})};this.saveChanges=function(b,e,h,k,l,m){var n=1==m;m=[];for(var p in h){var q=h[p];if(!(q.existsInDatabase&&q.key&&q.table&&q._internal_&&q.save)){b=_pio.error("You can only save database objects that exist in the database");_pio.handleError(b,l,b.code,b.message);return}var r=_pio.compareForChanges(e?{}:q._internal_("get-dbCurrent"),q,!0,!0);(e||0<r.length)&&
m.push({key:q._internal_("get-key"),table:q._internal_("get-table"),fulloverwrite:e,onlyifversion:b?q._internal_("get-version"):null,changes:r})}g.push({objects:h,changesets:m,fullOverwrite:e,useOptimisticLock:b,futureSaves:[],setIsSavingOnAll:function(u){for(var x=0;x!=this.objects.length;x++)this.objects[x]._internal_("set-is-saving",u)},done:function(){this.setIsSavingOnAll(!1);d()},execute:function(){var u=this;u.setIsSavingOnAll(!0);0<u.changesets.length?a.saveObjectChanges(_pio.LockType.LockAll,
u.changesets,n,k,function(x){u.done();_pio.handleError(x,l,x.code,x.message)},function(x){for(var w=0;w!=u.objects.length;w++){var v=u.objects[w];v._internal_("set-version",x.versions[w]);v._internal_("change-dbCurrent",u.changesets[w].changes);for(var F=0;F!=u.futureSaves.length;F++)for(var y=u.futureSaves[F],t=0;t<y.objects.length;t++)y.objects[t]==v&&(y.changesets.splice(t,1),y.objects.splice(t,1),t--)}u.done()}):(u.done(),setTimeout(k,1))}});d()}};_pio.databaseobject=function(a,d,c,f,g,b){var e=
{},h=!1;_pio.bigDBDeserialize(b,e,!0);this.table=d;this.key=c;this.existsInDatabase=!0;this.save=function(k,l,m,n){a.saveChanges(k,l,[this],m,n,g)};this._internal_=function(k,l){switch(k){case "get-table":return d;case "get-key":return c;case "set-is-saving":h=l;case "get-is-saving":return h;case "get-version":return f;case "set-version":f=l;case "get-dbCurrent":return e;case "change-dbCurrent":_pio.bigDBDeserialize(l,e,!0)}};_pio.bigDBDeserialize(b,this,!0)};_pio.compareForChanges=function(a,d,c,
f){var g=[],b;for(b in d){var e=d[b],h=a?a[b]:null;switch(b){case "table":if(f)continue;case "key":if(f)continue;case "save":if(f)continue;case "existsInDatabase":if(f)continue;case "_internal_":if(f)continue;case "_circular_reference_finder_":continue}if(null!=e){var k=c?{name:b}:{index:parseInt(b)};switch(typeof e){case "boolean":e!=h&&(k.value={valuetype:_pio.ValueType.Bool,bool:e},g.push(k));break;case "number":e!=h&&(isFinite(e)&&Math.floor(e)===e?k.value=-2147483648<=e&&2147483647>=e?{valuetype:_pio.ValueType.Int,
"int":e}:0<e&&4294967295>=e?{valuetype:_pio.ValueType.UInt,uint:e}:-0x7ffffffffffffc00<=e&&0x7ffffffffffffc00>=e?{valuetype:_pio.ValueType.Long,"long":e}:0<e&&1.844674407370955E19>=e?{valuetype:_pio.ValueType.ULong,ulong:e}:{valuetype:_pio.ValueType.Double,"double":e}:k.value={valuetype:_pio.ValueType.Double,"double":e},g.push(k));break;case "string":e!=h&&(k.value={valuetype:_pio.ValueType.String,string:e},g.push(k));break;case "object":if(e.getTime&&e.getMilliseconds)e+""!=h+""&&(k.value={valuetype:_pio.ValueType.DateTime,
datetime:e.getTime()},g.push(k));else{if(e._circular_reference_finder_)throw new PlayerIOError(PlayerIOErrorCode.CircularReference,"The object you're trying to save contains a circular reference for "+(c?"a property named":"the array entry")+"): "+b);e._circular_reference_finder_=!0;var l=e instanceof Array;if(l&&e.bytearray){l=Array(e.length);for(h=0;h!=l.length;h++){var m=e[h];if(0<=m&&255>=m)l[h]=m;else throw new PlayerIOError(PlayerIOErrorCode.GeneralError,"The bytearray property '"+b+"' was supposed to only contain byte (0-255) values, but contained the value: "+
m);}k.value={valuetype:_pio.ValueType.ByteArray,bytearray:l}}else h=_pio.compareForChanges(h,e,!l,!1),k.value=l?{valuetype:_pio.ValueType.Array,arrayproperties:h}:{valuetype:_pio.ValueType.Obj,objectproperties:h};g.push(k);delete e._circular_reference_finder_}break;case "undefined":break;case "function":break;default:throw Error("Don't know how to serialize type '"+typeof e+"' for BigDB");}}}for(b in a)null!=d[b]&&"undefined"!=typeof d[b]||g.push(c?{name:b}:{index:parseInt(b)});return g};_pio.bigDBDeserialize=
function(a,d,c){for(var f in a){var g=a[f],b=c?g.name:g.index||0;if(g=g.value)switch(g.valuetype||0){case _pio.ValueType.String:d[b]=g.string||"";break;case _pio.ValueType.Int:d[b]=g["int"]||0;break;case _pio.ValueType.UInt:d[b]=g.uint||0;break;case _pio.ValueType.Long:d[b]=g["long"]||0;break;case _pio.ValueType.Bool:d[b]=g.bool||0;break;case _pio.ValueType.Float:d[b]=g["float"]||0;break;case _pio.ValueType.Double:d[b]=g["double"]||0;break;case _pio.ValueType.ByteArray:d[b]=g.bytearray;d[b].bytearray=
!0;break;case _pio.ValueType.DateTime:d[b]=new Date(g.datetime||0);break;case _pio.ValueType.Array:var e=d[b]instanceof Array?d[b]:[];_pio.bigDBDeserialize(g.arrayproperties,e,!1);d[b]=e;break;case _pio.ValueType.Obj:e="object"==typeof d[b]?d[b]:{},_pio.bigDBDeserialize(g.objectproperties,e,!0),d[b]=e}else delete d[b]}}})();
(function(){_pio.multiplayer=function(c){var f=this;this.developmentServer=null;this.useSecureConnections=!1;this.createRoom=function(g,b,e,h,k,l){c.createRoom(g,b,e,_pio.convertToKVArray(h),null!=f.developmentServer,k,l,function(m){return m.roomid})};this.joinRoom=function(g,b,e,h){clearTimeout(setTimeout(function(){e(new _pio.connection)},1E4));var k=Error();c.joinRoom(g,_pio.convertToKVArray(b),null!=f.developmentServer,function(){},h,function(l){return new _pio.connection(k,f.developmentServer,
f.useSecureConnections,l.endpoints,l.joinkey,b||{},e,h)})};this.createJoinRoom=function(g,b,e,h,k,l,m){clearTimeout(setTimeout(function(){l(new _pio.connection)},1E4));var n=Error();c.createJoinRoom(g,b,e,_pio.convertToKVArray(h),_pio.convertToKVArray(k),null!=f.developmentServer,function(){},m,function(p){return new _pio.connection(n,f.developmentServer,f.useSecureConnections,p.endpoints,p.joinkey,k||{},l,m)})};this.listRooms=function(g,b,e,h,k,l){c.listRooms(g,_pio.convertToKVArray(b),e,h,null!=
f.developmentServer,k,l,function(m){var n=[];if(m.rooms&&0<m.rooms.length)for(var p=0;p!=m.rooms.length;p++){var q=m.rooms[p];n.push(new _pio.roomInfo(q.id,q.roomtype,q.onlineusers,_pio.convertFromKVArray(q.roomdata)))}return n})}};_pio.websocketConnection=function(c,f,g,b,e,h,k){var l=this,m=!1,n=new _pio.messageSerializer,p=!1,q=null;f=(f?"wss://":"ws://")+g+"/";try{q="undefined"!=typeof MozWebSocket?new MozWebSocket(f):new WebSocket(f)}catch(u){e(!1,""+u);return}var r=setTimeout(function(){m||
(m=!0,e(!1,"Connect attempt timed out"))},b);q.onopen=function(){m||(clearTimeout(r),p=m=!0,e(p))};q.onclose=function(u){l.disconnect()};q.onerror=function(u){l.disconnect()};q.onmessage=function(u){if(p)if(c){var x=new FileReader;x.onloadend=function(){for(var w=new Uint8Array(x.result),v=Array(w.length),F=0;F!=w.length;F++)v[F]=w[F];k(n.deserializeMessage(v,0,v.length))};x.readAsArrayBuffer(u.data)}else u=_pio.base64decode(u.data),k(n.deserializeMessage(u,0,u.length))};this.disconnect=function(){if(p){p=
!1;h();try{q.close()}catch(u){_pio.debugLog(u)}}};this.sendMessage=function(u){u=n.serializeMessage(u);if(c){for(var x=new Uint8Array(u.length),w=0;w<u.length;w++)x[w]=u[w];q.send(x.buffer)}else u=_pio.base64encode(u),q.send(u)}};_pio.connection=function(c,f,g,b,e,h,k,l){function m(F){function y(){if(0<B.length){var C=B[0];B.splice(0,1);var V=F(g,C,4E3,function(ba,ia){if(ba){x=V;n.connected=!0;var qa=n.createMessage("join");qa.addString(e);if(null!=h)for(var wa in h)qa.addString(wa),qa.addString(""+
h[wa]);n.sendMessage(qa)}else _pio.debugLog("Unable to connect to endpoint: "+C+'. reason: "'+ia+(0<B.length?'". Trying next endpoint.':'". No more endpoints to try.')),y()},function(ba){n.connected&&(n.connected=!1,setTimeout(function(){for(var ia=0;ia!=q.length;ia++)_pio.runCallback(q[ia].callback,n,q[ia].stackSource)},100))},function(ba){p?"playerio.joinresult"==ba.type?(p=!1,ba.getBoolean(0)?_pio.runCallback(k,n,null):_pio.handleError(c,l,ba.getInt(1),ba.getString(2))):_pio.handleError(c,l,PlayerIOErrorCode.GeneralError,
"The expected inital messagetype is: playerio.joinresult, received: "+joinResult.getType()):(t(ba.type,ba),t("*",ba))})}else _pio.handleError(c,l,PlayerIOErrorCode.GeneralError,"Could not establish a socket connection to any of the given endpoints for the room")}function t(C,V){var ba=r[C];if(ba)for(var ia=0;ia<ba.length;ia++)_pio.runCallback(ba[ia].callback,V,ba[ia].stackSource)}var B=[];if(f)B.push(f);else for(var L=0;L!=b.length;L++)B.push(b[L].address+":"+b[L].port);y()}var n=this,p=!0,q=[],r=
{},u=[],x=null,w=/(WebKit|Firefox|Trident)\/([0-9]+)/gi.exec(navigator.userAgent),v=w&&3<=w.length?w[1]:null;w=w&&3<=w.length?parseInt(w[2]):null;window.FileReader&&"WebKit"==v&&535<=w||"Firefox"==v&&11<=w||"Trident"==v&&6<=w?m(function(F,y,t,B,L,C){return new _pio.websocketConnection(!0,F,y,t,B,L,C)}):_pio.isFlashFallbackEnabled(function(F){F?m(function(y,t,B,L,C,V){return new _pio.flashSocketConnection(t,B,L,C,V)}):m(function(y,t,B,L,C,V){return new _pio.websocketConnection(!1,y,t,B,L,C,V)})});
this.connected=!1;this.addDisconnectCallback=function(F){q.push({callback:F,stackSourc:Error()})};this.addMessageCallback=function(F,y){null==F&&(F="*");var t=r[F];t||(r[F]=t=[]);t.push({callback:y,stackSource:Error()})};this.removeDisconnectCallback=function(F){for(var y=0;y<q.length;y++)q[y].callback==F&&(q.splice(y,1),y--)};this.removeMessageCallback=function(F){for(var y in r)for(var t=r[y],B=0;B<t.length;B++)t[B].callback==F&&(t.splice(B,1),B--)};this.createMessage=function(F){for(var y=new _pio.message(F),
t=1;t<arguments.length;t++)y.add(arguments[t]);return y};this.send=function(F){var y=this.createMessage.apply(this,arguments);this.sendMessage(y)};this.sendMessage=function(F){n.connected?x.sendMessage(F):u.push(F)};this.disconnect=function(){n.connected&&x.disconnect()}};_pio.message=function(c){function f(m,n,p,q){if(m)l.push(n),k.push(p),h.length=l.length;else throw _pio.error("The given value ("+n+") is not "+q);}function g(m,n){if(m>l.length)throw _pio.error("this message ("+h.type+") only has "+
l.length+" entries");if(k[m]==n)return l[m];throw _pio.error("Value at index:"+m+" is a "+b(k[m])+" and not a "+b(n)+" as requested. The value is: "+l[m]);}function b(m){return{0:"Integer",1:"Unsigned Integer",2:"Long",3:"Unsigned Long",4:"Double",5:"Float",6:"String",7:"ByteArray",8:"Boolean"}[m]}function e(m){var n="object"==typeof m&&"undefined"!=typeof m.length;if(n)for(var p=0;p!=m.length;p++)if(255<m[p]||0>m[p]){n=!1;break}return n}var h=this,k=[],l=[];this.type=c;this.length=0;this.add=function(){for(var m=
0;m<arguments.length;m++){var n=arguments[m];switch(typeof n){case "string":h.addString(n);break;case "boolean":h.addBoolean(n);break;case "number":if(isFinite(n)&&Math.floor(n)===n)if(-2147483648<=n&&2147483647>=n){h.addInt(n);break}else if(0<n&&4294967295>=n){h.addUInt(n);break}else if(-0x7ffffffffffffc00<=n&&0x7ffffffffffffc00>=n){h.addLong(n);break}else if(0<n&&1.844674407370955E19>=n){h.addULong(n);break}h.addDouble(n);break;case "object":if(e(n)){this.addByteArray(n);break}default:throw _pio.error("The type of the value ("+
n+") cannot be inferred");}}};this.addInt=function(m){f(-2147483648<=m&&2147483647>=m,Math.trunc(m),0,"an integer (32bit)")};this.addUInt=function(m){f(0<=m&&4294967295>=m,Math.trunc(m),1,"an unsigned integer (32bit)")};this.addLong=function(m){f(-0x7ffffffffffffc00<=m&&0x7ffffffffffffc00>=m,Math.trunc(m),2,"a long (64bit)")};this.addULong=function(m){f(0<=m&&1.844674407370955E19>=m,m,3,"an unsigned long (64bit)")};this.addBoolean=function(m){f(!0,m?!0:!1,8,"a boolean value")};this.addFloat=function(m){f(!0,
Number(m),5,"a floating point value (32bit)")};this.addDouble=function(m){f(!0,Number(m),4,"a double floating point value (64bit)")};this.addByteArray=function(m){f(e(m),m,7,"a bytearray")};this.addString=function(m){f(!0,m+"",6,"a string")};this.getInt=function(m){return g(m,0)};this.getUInt=function(m){return g(m,1)};this.getLong=function(m){return g(m,2)};this.getULong=function(m){return g(m,3)};this.getBoolean=function(m){return g(m,8)};this.getDouble=function(m){return g(m,4)};this.getFloat=
function(m){return g(m,5)};this.getByteArray=function(m){return g(m,7)};this.getString=function(m){return g(m,6)};this.toString=function(){for(var m="msg.Type = "+this.type,n=0;n!=this.length;n++)m+=", msg["+n+"] = "+l[n]+" ("+b(k[n])+")";return m};this._internal_=function(m,n){switch(m){case "get-objects":return l;case "get-types":return k}}};_pio.roomInfo=function(c,f,g,b){this.id=c;this.roomType=f;this.onlineUsers=g;this.roomData=b};_pio.byteWriter=function(){this.bytes=[];this.writeByte=function(c){if(0<=
c&&255>=c)this.bytes.push(c);else throw Error("This is not a byte value: "+c);};this.writeBytes=function(c){for(var f=0;f!=c.length;f++)this.writeByte(c[f])};this.writeTagWithLength=function(c,f,g){63<c||0>c?this.writeBottomPatternAndBytes(g,_pio.binaryserializer.bytesFromInt(c)):this.writeByte(f|c)};this.writeBottomPatternAndBytes=function(c,f){var g=0;0!=f[0]?g=3:0!=f[1]?g=2:0!=f[2]&&(g=1);this.writeByte(c|g);for(g=f.length-g-1;g!=f.length;g++)this.writeByte(f[g])};this.writeLongPattern=function(c,
f,g){for(var b=0,e=0;7!=e;e++)if(0!=g[e]){b=7-e;break}3<b?this.writeByte(f|b-4):this.writeByte(c|b);for(e=g.length-b-1;e!=g.length;e++)this.writeByte(g[e])}};_pio.messageSerializer=function(){this.serializeMessage=function(c){var f=new _pio.byteWriter;f.writeTagWithLength(c.length,128,4);var g=_pio.binaryserializer.bytesFromString(c.type);f.writeTagWithLength(g.length,192,12);f.writeBytes(g);for(var b=0;b!=c.length;b++)switch(g=c._internal_("get-objects")[b],c._internal_("get-types")[b]){case 6:g=
_pio.binaryserializer.bytesFromString(g);f.writeTagWithLength(g.length,192,12);f.writeBytes(g);break;case 0:f.writeTagWithLength(g,128,4);break;case 1:f.writeBottomPatternAndBytes(8,_pio.binaryserializer.bytesFromUInt(g));break;case 2:f.writeLongPattern(48,52,_pio.binaryserializer.bytesFromLong(g));break;case 3:f.writeLongPattern(56,60,_pio.binaryserializer.bytesFromULong(g));break;case 7:f.writeTagWithLength(g.length,64,16);f.writeBytes(g);break;case 4:f.writeByte(3);f.writeBytes(_pio.binaryserializer.bytesFromDouble(g));
break;case 5:f.writeByte(2);g=_pio.binaryserializer.bytesFromFloat(g);f.writeBytes(g);break;case 8:f.writeByte(g?1:0)}return f.bytes};this.deserializeMessage=function(c,f,g){var b=f;f+=g;g=null;for(var e=0;b<f;){var h=0,k=0,l=c[b];b++;var m=l&192;0==m&&(m=l&60,0==m&&(m=l));switch(m){case 12:case 16:h=(l&3)+1;if(b+h>f)throw Error("Unexpected: Unfinished message");l=h;h=_pio.binaryserializer.intFromBytes(c,b,h);b+=l;break;case 192:h=l&63;break;case 128:k=l&63;break;case 64:h=l&63;break;case 4:case 8:case 48:case 56:h=
(l&3)+1;break;case 52:case 60:h=(l&3)+5;break;case 3:h=8;break;case 2:h=4}if(b+h>f)throw Error("Unexpected: Unfinished message");switch(m){case 12:case 192:null==g?(g=new _pio.message(_pio.binaryserializer.stringFromBytes(c,b,h)),e++):g.addString(_pio.binaryserializer.stringFromBytes(c,b,h));break;case 4:k=_pio.binaryserializer.intFromBytes(c,b,h);case 128:0==e?e=k:g.addInt(k);break;case 16:case 64:g.addByteArray(c.slice(b,b+h));break;case 8:g.addUInt(_pio.binaryserializer.uintFromBytes(c,b,h));break;
case 48:case 52:g.addLong(_pio.binaryserializer.longFromBytes(c,b,h));break;case 56:case 60:g.addULong(_pio.binaryserializer.ulongFromBytes(c,b,h));break;case 3:g.addDouble(_pio.binaryserializer.doubleFromBytes(c,b,h));break;case 2:g.addFloat(_pio.binaryserializer.floatFromBytes(c,b,h));break;case 1:g.addBoolean(!0);break;case 0:g.addBoolean(!1)}b+=h;if(null!=g&&0==--e)return g}throw Error("Unexpected: Misaligned message");}};_pio.binaryserializer={pow2:function(c){return 0<=c&&31>c?1<<c:this.pow2[c]||
(this.pow2[c]=Math.pow(2,c))},_intEncode:function(c,f){if(4==f)var g=[c>>>24&255,c>>>16&255,c>>>8&255,c&255];else{if(0<=c){g=Math.floor(c/this.pow2(32));var b=c-g*this.pow2(32)}else g=Math.floor(c/this.pow2(32)),b=c-g*this.pow2(32),g+=this.pow2(32);g=[g>>>24&255,g>>>16&255,g>>>8&255,g&255,b>>>24&255,b>>>16&255,b>>>8&255,b&255]}return g},_floatEncode:function(c,f,g){var b=0>c?1:0,e,h=~(-1<<g-1),k=1-h;0>c&&(c=-c);0===c?c=e=0:isNaN(c)?(e=2*h+1,c=1):Infinity===c?(e=2*h+1,c=0):(e=Math.floor(Math.log(c)/
Math.LN2),e>=k&&e<=h?(c=Math.floor((c*this.pow2(-e)-1)*this.pow2(f)),e+=h):(c=Math.floor(c/this.pow2(k-f)),e=0));for(h=[];8<=f;)h.push(c%256),c=Math.floor(c/256),f-=8;e=e<<f|c;for(g+=f;8<=g;)h.push(e&255),e>>>=8,g-=8;h.push(b<<g|e);h.reverse();return h},bytesFromString:function(c){for(var f=[],g=0;g<c.length;g++)if(127>=c.charCodeAt(g))f.push(c.charCodeAt(g));else for(var b=encodeURIComponent(c.charAt(g)).substr(1).split("%"),e=0;e<b.length;e++)f.push(parseInt(b[e],16));return f},bytesFromInt:function(c){return this._intEncode(c,
4)},bytesFromUInt:function(c){return this._intEncode(c,4)},bytesFromLong:function(c){return this._intEncode(c,8)},bytesFromULong:function(c){return this._intEncode(c,8)},bytesFromFloat:function(c){return this._floatEncode(c,23,8)},bytesFromDouble:function(c){return this._floatEncode(c,52,11)},_intDecode:function(c,f,g,b,e){var h=f+g-1;f=e&&g==b&&c[f]&128;b=0;e=1;for(var k=0;k<g;k++){var l=c[h-k];f&&(l=(l^255)+e,e=l>>8,l&=255);b+=l*this.pow2(8*k)}return f?-b:b},_float32Decode:function(c,f){var g=c.slice(f,
f+4).reverse(),b=1-2*(g[3]>>7),e=(g[3]<<1&255|g[2]>>7)-127;g=(g[2]&127)<<16|g[1]<<8|g[0];return 128===e?0!==g?NaN:Infinity*b:-127===e?b*g*this.pow2(-149):b*(1+g*this.pow2(-23))*this.pow2(e)},_float64Decode:function(c,f){var g=c.slice(f,f+8).reverse(),b=1-2*(g[7]>>7),e=((g[7]<<1&255)<<3|g[6]>>4)-1023;g=(g[6]&15)*this.pow2(48)+g[5]*this.pow2(40)+g[4]*this.pow2(32)+g[3]*this.pow2(24)+g[2]*this.pow2(16)+g[1]*this.pow2(8)+g[0];return 1024===e?0!==g?NaN:Infinity*b:-1023===e?b*g*this.pow2(-1074):b*(1+g*
this.pow2(-52))*this.pow2(e)},stringFromBytes:function(c,f,g){for(var b="",e=f;e<f+g;e++)b+=127>=c[e]?37===c[e]?"%25":String.fromCharCode(c[e]):"%"+c[e].toString(16).toUpperCase();return decodeURIComponent(b)},intFromBytes:function(c,f,g){return this._intDecode(c,f,g,4,!0)},uintFromBytes:function(c,f,g){return this._intDecode(c,f,g,4,!1)},longFromBytes:function(c,f,g){return this._intDecode(c,f,g,8,!0)},ulongFromBytes:function(c,f,g){return this._intDecode(c,f,g,8,!1)},floatFromBytes:function(c,f,
g){return 4==g?this._float32Decode(c,f):NaN},doubleFromBytes:function(c,f,g){return 8==g?this._float64Decode(c,f):NaN}};for(var a=[],d=0;65!=d;d++)a["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charCodeAt(d)]=d;_pio.base64encode=function(c){for(var f=[],g=0;g<c.length;g++){var b=c[g],e=++g<=c.length?c[g]:NaN,h=++g<=c.length?c[g]:NaN,k=b>>2;b=(b&3)<<4|e>>4;var l=(e&15)<<2|h>>6,m=h&63;isNaN(e)?l=m=64:isNaN(h)&&(m=64);f.push("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(k));
f.push("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(b));f.push("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(l));f.push("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(m))}return f.join("")};_pio.base64decode=function(c){for(var f=[],g=0;g<c.length;g++){var b=a[c.charCodeAt(g)],e=++g<c.length?a[c.charCodeAt(g)]:64,h=++g<c.length?a[c.charCodeAt(g)]:64,k=++g<c.length?a[c.charCodeAt(g)]:64,l=(e&15)<<4|h>>2,m=(h&3)<<
6|k;f.push(b<<2|e>>4);64!=h&&(f.push(l),64!=k&&f.push(m))}return f}})();
(function(){_pio.achievements=function(a){function d(g,b){var e=new _pio.achievement(g.identifier,g.title,g.description,g.imageurl,g.progress,g.progressgoal,g.lastupdated);if("string"!==typeof f.myAchievements)for(var h=0;h<f.myAchievements.length;h++)f.myAchievements[h].id==e.id&&(f.myAchievements[h]=e,f.currentVersion=null);if(b)for(h=0;h<f.onCompleteHandlers.length;h++)(0,f.onCompleteHandlers[h])(e);return e}var c=null;this.myAchievements="[ERROR: You tried to access achievements.myAchievements before loading them. You have to call the refresh method first.]";
this.onCompleteHandlers=[];var f=this;this.addOnComplete=function(g){if("function"===typeof g&&1==g.length)f.onCompleteHandlers.push(g);else throw new PlayerIOError(PlayerIOErrorCode.InvalidArgument,"Expects argument to be a function that takes an achievement as an argument.");};this.get=function(g){if("string"===typeof f.myAchievements)return null;for(var b=0;b<f.myAchievements.length;b++)if(f.myAchievements[b].id==g)return f.myAchievements[b];return null};this.refresh=function(g,b){a.achievementsRefresh(c,
g,b,function(e){if(c!=e.version)if(c=e.version,null==e.achievements||0==e.achievements.length)f.myAchievements=[];else{for(var h=[],k=0;k<e.achievements.length;k++){var l=e.achievements[k];h.push(new _pio.achievement(l.identifier,l.title,l.description,l.imageurl,l.progress,l.progressgoal,l.lastupdated))}f.myAchievements=h}})};this.load=function(g,b,e){"object"==typeof g||requests.length?a.achievementsLoad(g,b,e,function(h){if(null==h||0==h.length)return{};for(var k={},l=0;l<h.userachievements.length;l++){for(var m=
h.userachievements[l],n=[],p=0;p<m.achievements.length;p++){var q=m.achievements[p];n.push(new _pio.achievement(q.identifier,q.title,q.description,q.imageurl,q.progress,q.progressgoal,q.lastupdated))}k[m.userid]=n}return k}):(g=_pio.error("The first argument to load should be an array: client.achievements.load(['user1', 'user2', ...], ...)"),_pio.handleError(g,e,g.code,g.message))};this.progressSet=function(g,b,e,h){a.achievementsProgressSet(g,b,e,h,function(k){return d(k.achievement,k.completednow)})};
this.progressAdd=function(g,b,e,h){a.achievementsProgressAdd(g,b,e,h,function(k){return d(k.achievement,k.completednow)})};this.progressMax=function(g,b,e,h){a.achievementsProgressMax(g,b,e,h,function(k){return d(k.achievement,k.completednow)})};this.progressComplete=function(g,b,e){a.achievementsProgressComplete(g,b,e,function(h){return d(h.achievement,h.completednow)})}};_pio.achievement=function(a,d,c,f,g,b,e){this.id=a;this.title=d;this.description=c;this.imageUrl=f;this.progress="undefined"===
typeof g?0:g;this.progressGoal=b;this.lastUpdated=new Date(1E3*e);this.progressRatio=this.progress/this.progressGoal;this.completed=this.progress==this.progressGoal}})();
(function(){_pio.playerInsight=function(a){function d(f){c.playersOnline=-1==f.playersonline?"[ERROR: The current connection does not have the rights required to read the playersonline variable.]":f.playersonline;c.segments=_pio.convertFromKVArray(f.segments)}this.playersOnline="[ERROR: You tried to access playerInsight.playersOnline before loading it. You have to call the refresh method first.]";this.segments={};var c=this;this.refresh=function(f,g){a.playerInsightRefresh(f,g,function(b){d(b.state)})};
this.setSegments=function(f,g,b){a.playerInsightSetSegments(_pio.convertToSegmentArray(f),g,b,function(e){d(e.state)})};this.trackInvitedBy=function(f,g,b,e){a.playerInsightTrackInvitedBy(f,g,b,e,function(h){})};this.trackEvent=function(f,g,b,e){a.playerInsightTrackEvents([{eventtype:f,value:g}],b,e,function(h){})};this.trackExternalPayment=function(f,g,b,e){a.playerInsightTrackExternalPayment(f,g,b,e,function(h){})};this.sessionKeepAlive=function(f,g){a.playerInsightSessionKeepAlive(f,g,function(b){})}}})();
(function(){_pio.oneScore=function(a){this.percentile="[ERROR: You tried to access oneScore.percentile before loading the OneScore. You have to call the refresh method first.]";this.score="[ERROR: You tried to access oneScore.score before loading the OneScore. You have to call the refresh method first.]";this.topRank="[ERROR: You tried to access oneScore.topRank before loading the OneScore. You have to call the refresh method first.]";var d=this;this.refresh=function(c,f){a.oneScoreRefresh(c,f,function(g){g=
new _pio.oneScoreValue(g.onescore.percentile,g.onescore.score,g.onescore.toprank);d.percentile=g.percentile;d.score=g.score;d.topRank=g.toprank})};this.set=function(c,f,g){a.oneScoreSet(c,f,g,function(b){b=new _pio.oneScoreValue(b.onescore.percentile,b.onescore.score,b.onescore.toprank);d.percentile=b.percentile;d.score=b.score;d.topRank=b.toprank;return b})};this.add=function(c,f,g){a.oneScoreAdd(c,f,g,function(b){b=new _pio.oneScoreValue(b.onescore.percentile,b.onescore.score,b.onescore.toprank);
d.percentile=b.percentile;d.score=b.score;d.topRank=b.toprank;return b})};this.load=function(c,f,g){if("object"==typeof c||requests.length)a.oneScoreLoad(c,f,g,function(b){if(null==b||null==b.onescores||0==b.onescores.length)return[];for(var e=[],h=0,k=0;k<c.length;k++){var l=b.onescores[h];l&&c[k]==l.userid?(e.push(new _pio.oneScoreValue(l.percentile,l.score,l.toprank)),h++):e.push(null)}return e});else f=_pio.error("The first argument to load should be an array: client.oneScore.load(['user1', 'user2', ...], ...)"),
_pio.handleError(f,g,f.code,f.message)}};_pio.oneScoreValue=function(a,d,c){this.percentile="undefined"===typeof a?0:a;this.score="undefined"===typeof d?0:d;this.topRank="undefined"===typeof c?0:c}})();
(function(){_pio.notifications=function(a){function d(b){if(b.version!=g){var e=[];if(b.endpoints)for(var h=0;h!=b.endpoints.length;h++){var k=b.endpoints[h];e[h]=new _pio.notificationEndpoint(k.type,k.identifier,_pio.convertFromKVArray(k.configuration),k.enabled?!0:!1)}g=b.version;f.myEndpoints=e}}function c(b){var e=[];if(b&&0<b.length)for(var h=0;h!=b.length;h++){var k=b[h];k.type&&k.identifier&&e.push({type:k.type,identifier:k.identifier})}return e}this.myEndpoints="[ERROR: You tried to access notifications.myEndpoints before calling refresh.]";
var f=this,g="";this.refresh=function(b,e){a.notificationsRefresh(g,b,e,d)};this.registerEndpoint=function(b,e,h,k,l,m){var n;a:{if(""!=g)for(n=0;n!=f.myEndpoints.length;n++){var p=f.myEndpoints[n];if(p.type==b&&p.identifier==e){n=p;break a}}n=null}(p=null==n||n.enabled!=k)||(p=JSON.stringify(n.configuration)!=JSON.stringify(h));p?a.notificationsRegisterEndpoints(g,[{type:b,identifier:e,configuration:_pio.convertToKVArray(h),enabled:k}],l,m,d):l&&l()};this.toggleEndpoints=function(b,e,h,k){b=c(b);
0<b.length?a.notificationsToggleEndpoints(g,b,e?!0:!1,h,k,d):h&&h()};this.deleteEndpoints=function(b,e,h){b=c(b);0<b.length?a.notificationsDeleteEndpoints(g,b,e,h,d):e&&e()};this.send=function(b,e,h){for(var k=[],l=0;l!=b.length;l++){var m=b[l],n={recipient:m.recipientUserId,endpointtype:m.endpointType,data:{}};0!=(n.recipient+"").length&&0!=(n.endpointtype+"").length||console.log("error");for(var p in m)"recipientUserId"!=p&&"endpointType"!=p&&(n.data[p]=m[p]);k[l]=n}0<k.length?a.notificationsSend(k,
e,h,null):e&&e()}};_pio.notificationEndpoint=function(a,d,c,f){this.type=a;this.identifier=d;this.configuration=c;this.enabled=f}})();
(function(){_pio.publishingNetwork=function(a,d){var c=this;this.profiles=new _pio.publishingNetworkProfiles(a);this.payments=new _pio.publishingNetworkPayments(a);this.relations=new _pio.publishingNetworkRelations(a,d,this);this.userToken="[ERROR: you tried to access publishingNetwork.userToken before calling publishingNetwork.refresh(callback)]";this.refresh=function(f,g){a.socialRefresh(f,g,function(b){c.userToken=b.myprofile.usertoken;c.profiles.myProfile=new _pio.publishingNetworkProfile(b.myprofile);
"undefined"==typeof _pio.friendLookup&&(_pio.friendLookup={},_pio.blockedLookup={});var e=_pio.friendLookup[c.profiles.myProfile.userId],h=_pio.blockedLookup[c.profiles.myProfile.userId];e||h||(e=_pio.friendLookup[c.profiles.myProfile.userId]={},h=_pio.blockedLookup[c.profiles.myProfile.userId]={});c.relations.friends=[];for(var k=0;k!=b.friends.length;k++){var l=new _pio.publishingNetworkProfile(b.friends[k]);c.relations.friends.push(l);e[l.userId]=!0}for(k=0;k!=b.blocked.length;k++)h[b.blocked[k]]=
!0})}};_pio.showDialog=function(a,d,c,f){if("undefined"==typeof window.PublishingNetwork)throw new PlayerIOError(PlayerIOErrorCode.PublishingNetworkNotAvailable,"PublishingNetwork.js was not found on the current page. You have to include the 'piocdn.com/publishingnetwork.js' on the containing page to show dialogs. See http://playerio.com/documentation/ for more information.");c.__apitoken__=d.token;window.PublishingNetwork.dialog(a,c,f)}})();
(function(){_pio.publishingNetworkPayments=function(a){this.showBuyCoinsDialog=function(d,c,f,g){c||(c={});c.coinamount=d;a.payVaultPaymentInfo("publishingnetwork",_pio.convertToKVArray(c),null,function(b){_pio.showDialog("buy",a,b,function(e){e.error?g(new PlayerIOError(PlayerIOErrorCode.GeneralError,e.error)):f(e)})},g,function(b){return _pio.convertFromKVArray(b.providerarguments)})};this.showBuyItemsDialog=function(d,c,f,g){a.payVaultPaymentInfo("publishingnetwork",_pio.convertToKVArray(c||{}),
_pio.convertBuyItems(d),function(b){_pio.showDialog("buy",a,b,function(e){e.error?g(new PlayerIOError(PlayerIOErrorCode.GeneralError,e.error)):f(e)})},g,function(b){return _pio.convertFromKVArray(b.providerarguments)})}}})();
(function(){_pio.publishingNetworkProfiles=function(a){this.myProfile="[ERROR: you tried to access publishingNetworkProfiles.myProfile before calling publishingNetwork.refresh(callback)]";this.showProfile=function(d,c){_pio.showDialog("profile",a,{userId:d},c)};this.loadProfiles=function(d,c,f){a.socialLoadProfiles(d,c,f,function(g){for(var b=[],e=0;e!=d.length;e++){var h=d[e];b[e]=null;for(var k=0;k!=g.profiles.length;k++){var l=g.profiles[k];if(l&&l.userid==h){b[e]=new _pio.publishingNetworkProfile(g.profiles[k]);
break}}}return b})}};_pio.publishingNetworkProfile=function(a){this.userId=a.userid;this.displayName=a.displayname;this.avatarUrl=a.avatarurl;this.lastOnline=new Date(a.lastonline);this.countryCode=a.countrycode}})();
(function(){_pio.publishingNetworkRelations=function(a,d,c){this.friends="[ERROR: you tried to access publishingNetworkRelations.friends before calling publishingNetwork.refresh(callback)]";this.isFriend=function(f){if("undefined"!=typeof _pio.friendLookup&&"undefined"!=typeof _pio.friendLookup[d])return _pio.friendLookup[d][f]||!1;throw new PlayerIOError(PlayerIOErrorCode.PublishingNetworkNotLoaded,"Cannot access profile, friends, ignored before Publishing Network has been loaded. Please refresh Publishing Network first");
};this.isBlocked=function(f){if("undefined"!=typeof _pio.blockedLookup&&"undefined"!=typeof _pio.blockedLookup[d])return _pio.blockedLookup[d][f]||!1;throw new PlayerIOError(PlayerIOErrorCode.PublishingNetworkNotLoaded,"Cannot access profile, friends, ignored before Publishing Network has been loaded. Please refresh Publishing Network first");};this.showRequestFriendshipDialog=function(f,g){_pio.showDialog("requestfriendship",a,{userId:f},g)};this.showRequestBlockUserDialog=function(f,g){_pio.showDialog("requestblockuser",
a,{userId:f},function(){c.refresh(function(){g&&g()},function(){g&&g()})})};this.showFriendsManager=function(f){_pio.showDialog("friendsmanager",a,{},function(g){g.updated?c.refresh(function(){f&&f()},function(){f&&f()}):f&&f()})};this.showBlockedUsersManager=function(f){_pio.showDialog("blockedusersmanager",a,{},function(g){g.updated?c.refresh(function(){f&&f()},function(){f&&f()}):f&&f()})}}})();
(function(a,d){"object"===typeof exports&&"undefined"!==typeof module?module.exports=d(require("@popperjs/core")):"function"===typeof define&&define.amd?define(["@popperjs/core"],d):(a=a||self,a.tippy=d(a.Popper))})(this,function(a){function d(z){var E=document.createElement("style");E.textContent=z;E.setAttribute("data-tippy-stylesheet","");z=document.head;var G=document.querySelector("head>style,head>link");G?z.insertBefore(E,G):z.appendChild(E)}function c(z,E,G){return Array.isArray(z)?(z=z[E],
null==z?Array.isArray(G)?G[E]:G:z):z}function f(z,E){var G={}.toString.call(z);return 0===G.indexOf("[object")&&-1<G.indexOf(E+"]")}function g(z,E){return"function"===typeof z?z.apply(void 0,E):z}function b(z,E){if(0===E)return z;var G;return function(N){clearTimeout(G);G=setTimeout(function(){z(N)},E)}}function e(z,E){var G=Object.assign({},z);E.forEach(function(N){delete G[N]});return G}function h(z,E){-1===z.indexOf(E)&&z.push(E)}function k(z){return z.filter(function(E,G){return z.indexOf(E)===
G})}function l(z){return Object.keys(z).reduce(function(E,G){void 0!==z[G]&&(E[G]=z[G]);return E},{})}function m(){return document.createElement("div")}function n(z){return["Element","Fragment"].some(function(E){return f(z,E)})}function p(z){return n(z)?[z]:f(z,"NodeList")?[].slice.call(z):Array.isArray(z)?z:[].slice.call(document.querySelectorAll(z))}function q(z,E){z.forEach(function(G){G&&(G.style.transitionDuration=E+"ms")})}function r(z,E){z.forEach(function(G){G&&G.setAttribute("data-state",
E)})}function u(z){var E;z=[].concat(z)[0];return(null==z?0:null==(E=z.ownerDocument)?0:E.body)?z.ownerDocument:document}function x(z,E){var G=E.clientX,N=E.clientY;return z.every(function(O){var Y=O.popperRect,R=O.popperState;O=O.props.interactiveBorder;var S=R.placement.split("-")[0];R=R.modifiersData.offset;if(!R)return!0;var T=N-Y.bottom-("top"===S?R.bottom.y:0)>O,ca=Y.left-G+("right"===S?R.left.x:0)>O,sa=G-Y.right-("left"===S?R.right.x:0)>O;return Y.top-N+("bottom"===S?R.top.y:0)>O||T||ca||sa})}
function w(z,E,G){var N=E+"EventListener";["transitionend","webkitTransitionEnd"].forEach(function(O){z[N](O,G)})}function v(){ma.isTouch||(ma.isTouch=!0,window.performance&&document.addEventListener("mousemove",F))}function F(){var z=performance.now();20>z-ja&&(ma.isTouch=!1,document.removeEventListener("mousemove",F));ja=z}function y(){var z=document.activeElement;if(z&&z._tippy&&z._tippy.reference===z){var E=z._tippy;z.blur&&!E.state.isVisible&&z.blur()}}function t(z){return[z+"() was called on a"+
("destroy"===z?"n already-":" ")+"destroyed instance. This is a no-op but","indicates a potential memory leak."].join(" ")}function B(z){return z.replace(/[ \t]{2,}/g," ").replace(/^[ \t]*/gm,"").trim()}function L(z){return[B("\n  %ctippy.js\n\n  %c"+B(z)+"\n\n  %c\ud83d\udc77\u200d This is a development-only message. It will be removed in production.\n  "),"color: #00C584; font-size: 1.3em; font-weight: bold;","line-height: 1.5","color: #a6a095;"]}function C(z,E){if(z&&!da.has(E)){var G;da.add(E);
(G=console).warn.apply(G,L(E))}}function V(z,E){if(z&&!da.has(E)){var G;da.add(E);(G=console).error.apply(G,L(E))}}function ba(z){var E=!z,G="[object Object]"===Object.prototype.toString.call(z)&&!z.addEventListener;V(E,["tippy() was passed","`"+String(z)+"`","as its targets (first) argument. Valid types are: String, Element, Element[], or NodeList."].join(" "));V(G,"tippy() was passed a plain object which is not supported as an argument for virtual positioning. Use props.getReferenceClientRect instead.")}
function ia(z){var E=(z.plugins||[]).reduce(function(G,N){var O=N.name,Y=N.defaultValue;O&&(G[O]=void 0!==z[O]?z[O]:Y);return G},{});return Object.assign({},z,{},E)}function qa(z,E){return(E?Object.keys(ia(Object.assign({},na,{plugins:E}))):La).reduce(function(G,N){var O=(z.getAttribute("data-tippy-"+N)||"").trim();if(!O)return G;if("content"===N)G[N]=O;else try{G[N]=JSON.parse(O)}catch(Y){G[N]=O}return G},{})}function wa(z,E){var G=Object.assign({},E,{content:g(E.content,[z])},E.ignoreAttributes?
{}:qa(z,E.plugins));G.aria=Object.assign({},na.aria,{},G.aria);G.aria={expanded:"auto"===G.aria.expanded?E.interactive:G.aria.expanded,content:"auto"===G.aria.content?E.interactive?null:"describedby":G.aria.content};return G}function Ca(z,E){void 0===z&&(z={});void 0===E&&(E=[]);Object.keys(z).forEach(function(G){var N=e(na,Object.keys(za));(N=!{}.hasOwnProperty.call(N,G))&&(N=0===E.filter(function(O){return O.name===G}).length);C(N,["`"+G+"`","is not a valid prop. You may have spelled it incorrectly, or if it's a plugin, forgot to pass it in an array as props.plugins. \n\n All props: https://atomiks.github.io/tippyjs/v6/all-props/\n Plugins: https://atomiks.github.io/tippyjs/v6/plugins/"].join(" "))})}
function Da(z){var E=m();!0===z?E.className="tippy-arrow":(E.className="tippy-svg-arrow",n(z)?E.appendChild(z):E.innerHTML=z);return E}function Aa(z,E){n(E.content)?(z.innerHTML="",z.appendChild(E.content)):"function"!==typeof E.content&&(E.allowHTML?z.innerHTML=E.content:z.textContent=E.content)}function ka(z){z=z.firstElementChild;var E=[].slice.call(z.children);return{box:z,content:E.find(function(G){return G.classList.contains("tippy-content")}),arrow:E.find(function(G){return G.classList.contains("tippy-arrow")||
G.classList.contains("tippy-svg-arrow")}),backdrop:E.find(function(G){return G.classList.contains("tippy-backdrop")})}}function J(z){function E(Y,R){var S=ka(G),T=S.box,ca=S.content;S=S.arrow;R.theme?T.setAttribute("data-theme",R.theme):T.removeAttribute("data-theme");"string"===typeof R.animation?T.setAttribute("data-animation",R.animation):T.removeAttribute("data-animation");R.inertia?T.setAttribute("data-inertia",""):T.removeAttribute("data-inertia");T.style.maxWidth="number"===typeof R.maxWidth?
R.maxWidth+"px":R.maxWidth;R.role?T.setAttribute("role",R.role):T.removeAttribute("role");Y.content===R.content&&Y.allowHTML===R.allowHTML||Aa(ca,z.props);R.arrow?S?Y.arrow!==R.arrow&&(T.removeChild(S),T.appendChild(Da(R.arrow))):T.appendChild(Da(R.arrow)):S&&T.removeChild(S)}var G=m(),N=m();N.className="tippy-box";N.setAttribute("data-state","hidden");N.setAttribute("tabindex","-1");var O=m();O.className="tippy-content";O.setAttribute("data-state","hidden");Aa(O,z.props);G.appendChild(N);N.appendChild(O);
E(z.props,z.props);return{popper:G,onUpdate:E}}function A(z,E){function G(){var H=I.props.touch;return Array.isArray(H)?H:[H,0]}function N(){var H;return!(null==(H=I.props.render)||!H.$$tippy)}function O(){var H=(Fa||z).parentNode;return H?u(H):document}function Y(H){return I.state.isMounted&&!I.state.isVisible||ma.isTouch||Pa&&"focus"===Pa.type?0:c(I.props.delay,H?0:1,na.delay)}function R(){fa.style.pointerEvents=I.props.interactive&&I.state.isVisible?"":"none";fa.style.zIndex=""+I.props.zIndex}
function S(H,U,aa){void 0===aa&&(aa=!0);rb.forEach(function(oa){oa[H]&&oa[H].apply(void 0,U)});if(aa){var ea;(ea=I.props)[H].apply(ea,U)}}function T(){var H=I.props.aria;if(H.content){var U="aria-"+H.content,aa=fa.id;[].concat(I.props.triggerTarget||z).forEach(function(ea){var oa=ea.getAttribute(U);I.state.isVisible?ea.setAttribute(U,oa?oa+" "+aa:aa):(oa=oa&&oa.replace(aa,"").trim())?ea.setAttribute(U,oa):ea.removeAttribute(U)})}}function ca(){!sb&&I.props.aria.expanded&&[].concat(I.props.triggerTarget||
z).forEach(function(H){I.props.interactive?H.setAttribute("aria-expanded",I.state.isVisible&&H===(Fa||z)?"true":"false"):H.removeAttribute("aria-expanded")})}function sa(){O().removeEventListener("mousemove",Ga);Qa=Qa.filter(function(H){return H!==Ga})}function la(H){if(!ma.isTouch||!Xa&&"mousedown"!==H.type)if(!I.props.interactive||!fa.contains(H.target)){if((Fa||z).contains(H.target)){if(ma.isTouch||I.state.isVisible&&0<=I.props.trigger.indexOf("click"))return}else S("onClickOutside",[I,H]);!0===
I.props.hideOnClick&&(I.clearDelayTimeouts(),I.hide(),Ya=!0,setTimeout(function(){Ya=!1}),I.state.isMounted||Ba())}}function ua(){Xa=!0}function P(){Xa=!1}function xa(){var H=O();H.addEventListener("mousedown",la,!0);H.addEventListener("touchend",la,pa);H.addEventListener("touchstart",P,pa);H.addEventListener("touchmove",ua,pa)}function Ba(){var H=O();H.removeEventListener("mousedown",la,!0);H.removeEventListener("touchend",la,pa);H.removeEventListener("touchstart",P,pa);H.removeEventListener("touchmove",
ua,pa)}function X(H,U){va(H,function(){!I.state.isVisible&&fa.parentNode&&fa.parentNode.contains(fa)&&U()})}function ha(H,U){va(H,U)}function va(H,U){function aa(oa){oa.target===ea&&(w(ea,"remove",aa),U())}var ea=ka(fa).box;if(0===H)return U();w(ea,"remove",db);w(ea,"add",aa);db=aa}function ya(H,U,aa){void 0===aa&&(aa=!1);[].concat(I.props.triggerTarget||z).forEach(function(ea){ea.addEventListener(H,U,aa);Za.push({node:ea,eventType:H,handler:U,options:aa})})}function Ea(){"hold"===G()[0]&&(ya("touchstart",
Ma,{passive:!0}),ya("touchend",eb,{passive:!0}));I.props.trigger.split(/\s+/).filter(Boolean).forEach(function(H){if("manual"!==H)switch(ya(H,Ma),H){case "mouseenter":ya("mouseleave",eb);break;case "focus":ya(K?"focusout":"blur",fb);break;case "focusin":ya("focusout",fb)}})}function Ha(){Za.forEach(function(H){H.node.removeEventListener(H.eventType,H.handler,H.options)});Za=[]}function Ma(H){var U,aa=!1;if(I.state.isEnabled&&!gb(H)&&!Ya){var ea="focus"===(null==(U=Pa)?void 0:U.type);Pa=H;Fa=H.currentTarget;
ca();!I.state.isVisible&&f(H,"MouseEvent")&&Qa.forEach(function(oa){return oa(H)});"click"===H.type&&(0>I.props.trigger.indexOf("mouseenter")||Na)&&!1!==I.props.hideOnClick&&I.state.isVisible?aa=!0:hb(H);"click"===H.type&&(Na=!aa);aa&&!ea&&Ra(H)}}function ib(H){var U=H.target;U=(Fa||z).contains(U)||fa.contains(U);"mousemove"===H.type&&U||(U=$a().concat(fa).map(function(aa){var ea,oa=null==(ea=aa._tippy.popperInstance)?void 0:ea.state;return oa?{popperRect:aa.getBoundingClientRect(),popperState:oa,
props:Ia}:null}).filter(Boolean),x(U,H)&&(sa(),Ra(H)))}function eb(H){gb(H)||0<=I.props.trigger.indexOf("click")&&Na||(I.props.interactive?I.hideWithInteractivity(H):Ra(H))}function fb(H){0>I.props.trigger.indexOf("focusin")&&H.target!==(Fa||z)||I.props.interactive&&H.relatedTarget&&fa.contains(H.relatedTarget)||Ra(H)}function gb(H){return ma.isTouch?"hold"===G()[0]!==0<=H.type.indexOf("touch"):!1}function jb(){kb();var H=I.props,U=H.popperOptions,aa=H.placement,ea=H.offset,oa=H.getReferenceClientRect,
Sa=H.moveTransition;H=N()?ka(fa).arrow:null;oa=oa?{getBoundingClientRect:oa,contextElement:oa.contextElement||Fa||z}:z;ea=[{name:"offset",options:{offset:ea}},{name:"preventOverflow",options:{padding:{top:2,bottom:2,left:5,right:5}}},{name:"flip",options:{padding:5}},{name:"computeStyles",options:{adaptive:!Sa}},{name:"$$tippy",enabled:!0,phase:"beforeWrite",requires:["computeStyles"],fn:function(Ja){var Ka=Ja.state;if(N()){var ab=ka(fa).box;["placement","reference-hidden","escaped"].forEach(function(Ta){"placement"===
Ta?ab.setAttribute("data-placement",Ka.placement):Ka.attributes.popper["data-popper-"+Ta]?ab.setAttribute("data-"+Ta,""):ab.removeAttribute("data-"+Ta)});Ka.attributes.popper={}}}}];N()&&H&&ea.push({name:"arrow",options:{element:H,padding:3}});ea.push.apply(ea,(null==U?void 0:U.modifiers)||[]);I.popperInstance=a.createPopper(oa,fa,Object.assign({},U,{placement:aa,onFirstUpdate:lb,modifiers:ea}))}function kb(){I.popperInstance&&(I.popperInstance.destroy(),I.popperInstance=null)}function tb(){var H=
I.props.appendTo,U=Fa||z;var aa=I.props.interactive&&H===na.appendTo||"parent"===H?U.parentNode:g(H,[U]);aa.contains(fa)||aa.appendChild(fa);jb();C(I.props.interactive&&H===na.appendTo&&U.nextElementSibling!==fa,"Interactive tippy element may not be accessible via keyboard navigation because it is not directly after the reference element in the DOM source order. \n\n Using a wrapper <div> or <span> tag around the reference element solves this by creating a new parentNode context. \n\n Specifying `appendTo: document.body` silences this warning, but it assumes you are using a focus management solution to handle keyboard navigation. \n\n See: https://atomiks.github.io/tippyjs/v6/accessibility/#interactivity")}
function $a(){return[].slice.call(fa.querySelectorAll("[data-tippy-root]"))}function hb(H){I.clearDelayTimeouts();H&&S("onTrigger",[I,H]);xa();H=Y(!0);var U=G(),aa=U[0];U=U[1];ma.isTouch&&"hold"===aa&&U&&(H=U);H?mb=setTimeout(function(){I.show()},H):I.show()}function Ra(H){I.clearDelayTimeouts();S("onUntrigger",[I,H]);I.state.isVisible?0<=I.props.trigger.indexOf("mouseenter")&&0<=I.props.trigger.indexOf("click")&&0<=["mouseleave","mousemove"].indexOf(H.type)&&Na||((H=Y(!1))?nb=setTimeout(function(){I.state.isVisible&&
I.hide()},H):ob=requestAnimationFrame(function(){I.hide()})):Ba()}var Ia=wa(z,Object.assign({},na,{},ia(l(E)))),mb,nb,ob,Na=!1,Ya=!1,Xa=!1,bb=!1,Pa,db,lb,Za=[],Ga=b(ib,Ia.interactiveDebounce),Fa,Ua=Oa++,pb=k(Ia.plugins),I={id:Ua,reference:z,popper:m(),popperInstance:null,props:Ia,state:{isEnabled:!0,isVisible:!1,isDestroyed:!1,isMounted:!1,isShown:!1},plugins:pb,clearDelayTimeouts:function(){clearTimeout(mb);clearTimeout(nb);cancelAnimationFrame(ob)},setProps:function(H){C(I.state.isDestroyed,t("setProps"));
if(!I.state.isDestroyed){S("onBeforeUpdate",[I,H]);Ha();var U=I.props,aa=wa(z,Object.assign({},I.props,{},H,{ignoreAttributes:!0}));I.props=aa;Ea();U.interactiveDebounce!==aa.interactiveDebounce&&(sa(),Ga=b(ib,aa.interactiveDebounce));U.triggerTarget&&!aa.triggerTarget?[].concat(U.triggerTarget).forEach(function(ea){ea.removeAttribute("aria-expanded")}):aa.triggerTarget&&z.removeAttribute("aria-expanded");ca();R();qb&&qb(U,aa);I.popperInstance&&(jb(),$a().forEach(function(ea){requestAnimationFrame(ea._tippy.popperInstance.forceUpdate)}));
S("onAfterUpdate",[I,H])}},setContent:function(H){I.setProps({content:H})},show:function(){C(I.state.isDestroyed,t("show"));var H=I.state.isVisible,U=I.state.isDestroyed,aa=!I.state.isEnabled,ea=ma.isTouch&&!I.props.touch,oa=c(I.props.duration,0,na.duration);H||U||aa||ea||(Fa||z).hasAttribute("disabled")||(S("onShow",[I],!1),!1!==I.props.onShow(I)&&(I.state.isVisible=!0,N()&&(fa.style.visibility="visible"),R(),xa(),I.state.isMounted||(fa.style.transition="none"),N()&&(H=ka(fa),q([H.box,H.content],
0)),lb=function(){var Sa;if(I.state.isVisible&&!bb){bb=!0;void 0;fa.style.transition=I.props.moveTransition;if(N()&&I.props.animation){var Ja=ka(fa),Ka=Ja.box;Ja=Ja.content;q([Ka,Ja],oa);r([Ka,Ja],"visible")}T();ca();h(Va,I);null==(Sa=I.popperInstance)?void 0:Sa.forceUpdate();I.state.isMounted=!0;S("onMount",[I]);I.props.animation&&N()&&ha(oa,function(){I.state.isShown=!0;S("onShown",[I])})}},tb()))},hide:function(){C(I.state.isDestroyed,t("hide"));var H=!I.state.isVisible,U=I.state.isDestroyed,aa=
!I.state.isEnabled,ea=c(I.props.duration,1,na.duration);H||U||aa||(S("onHide",[I],!1),!1!==I.props.onHide(I)&&(I.state.isVisible=!1,Na=bb=I.state.isShown=!1,N()&&(fa.style.visibility="hidden"),sa(),Ba(),R(),N()&&(U=ka(fa),H=U.box,U=U.content,I.props.animation&&(q([H,U],ea),r([H,U],"hidden"))),T(),ca(),I.props.animation?N()&&X(ea,I.unmount):I.unmount()))},hideWithInteractivity:function(H){C(I.state.isDestroyed,t("hideWithInteractivity"));O().addEventListener("mousemove",Ga);h(Qa,Ga);Ga(H)},enable:function(){I.state.isEnabled=
!0},disable:function(){I.hide();I.state.isEnabled=!1},unmount:function(){C(I.state.isDestroyed,t("unmount"));I.state.isVisible&&I.hide();I.state.isMounted&&(kb(),$a().forEach(function(H){H._tippy.unmount()}),fa.parentNode&&fa.parentNode.removeChild(fa),Va=Va.filter(function(H){return H!==I}),I.state.isMounted=!1,S("onHidden",[I]))},destroy:function(){C(I.state.isDestroyed,t("destroy"));I.state.isDestroyed||(I.clearDelayTimeouts(),I.unmount(),Ha(),delete z._tippy,I.state.isDestroyed=!0,S("onDestroy",
[I]))}};if(!Ia.render)return V(!0,"render() function has not been supplied."),I;Ua=Ia.render(I);var fa=Ua.popper,qb=Ua.onUpdate;fa.setAttribute("data-tippy-root","");fa.id="tippy-"+I.id;I.popper=fa;z._tippy=I;fa._tippy=I;var rb=pb.map(function(H){return H.fn(I)}),sb=z.hasAttribute("aria-expanded");Ea();ca();R();S("onCreate",[I]);Ia.showOnCreate&&hb();fa.addEventListener("mouseenter",function(){I.props.interactive&&I.state.isVisible&&I.clearDelayTimeouts()});fa.addEventListener("mouseleave",function(H){I.props.interactive&&
0<=I.props.trigger.indexOf("mouseenter")&&(O().addEventListener("mousemove",Ga),Ga(H))});return I}function Z(z,E){void 0===E&&(E={});var G=na.plugins.concat(E.plugins||[]);ba(z);Ca(E,G);document.addEventListener("touchstart",v,pa);window.addEventListener("blur",y);var N=Object.assign({},E,{plugins:G});G=p(z);var O=n(N.content),Y=1<G.length;C(O&&Y,"tippy() was passed an Element as the `content` prop, but more than one tippy instance was created by this invocation. This means the content element will only be appended to the last tippy instance. \n\n Instead, pass the .innerHTML of the element, or use a function that returns a cloned version of the element instead. \n\n 1) content: element.innerHTML\n 2) content: () => element.cloneNode(true)");
G=G.reduce(function(R,S){var T=S&&A(S,N);T&&R.push(T);return R},[]);return n(z)?G[0]:G}function ta(){var z=m();z.className="tippy-backdrop";r([z],"hidden");return z}function ra(z){cb={clientX:z.clientX,clientY:z.clientY}}function W(z,E){var G;return{popperOptions:Object.assign({},z.popperOptions,{modifiers:[].concat(((null==(G=z.popperOptions)?void 0:G.modifiers)||[]).filter(function(N){return N.name!==E.name}),[E])})}}function D(z,E,G,N){if(2>G.length||null===z)return E;if(2===G.length&&0<=N&&G[0].left>
G[1].right)return G[N]||E;switch(z){case "top":case "bottom":E=G[0];var O=G[G.length-1],Y="top"===z;G=E.top;N=O.bottom;var R=Y?E.left:O.left;E=Y?E.right:O.right;return{top:G,bottom:N,left:R,right:E,width:E-R,height:N-G};case "left":case "right":var S=Math.min.apply(Math,G.map(function(ca){return ca.left})),T=Math.max.apply(Math,G.map(function(ca){return ca.right}));G=G.filter(function(ca){return"left"===z?ca.left===S:ca.right===T});E=G[0].top;G=G[G.length-1].bottom;return{top:E,bottom:G,left:S,right:T,
width:T-S,height:G-E};default:return E}}function M(z,E){return z&&E?z.top!==E.top||z.right!==E.right||z.bottom!==E.bottom||z.left!==E.left:!0}var Q="undefined"!==typeof window&&"undefined"!==typeof document,K=/MSIE |Trident\//.test(Q?navigator.userAgent:""),pa={passive:!0,capture:!0},ma={isTouch:!1},ja=0;var da=new Set;var za={animateFill:!1,followCursor:!1,inlinePositioning:!1,sticky:!1},na=Object.assign({appendTo:function(){return document.body},aria:{content:"auto",expanded:"auto"},delay:0,duration:[300,
250],getReferenceClientRect:null,hideOnClick:!0,ignoreAttributes:!1,interactive:!1,interactiveBorder:2,interactiveDebounce:0,moveTransition:"",offset:[0,10],onAfterUpdate:function(){},onBeforeUpdate:function(){},onCreate:function(){},onDestroy:function(){},onHidden:function(){},onHide:function(){},onMount:function(){},onShow:function(){},onShown:function(){},onTrigger:function(){},onUntrigger:function(){},onClickOutside:function(){},placement:"top",plugins:[],popperOptions:{},render:null,showOnCreate:!1,
touch:!0,trigger:"mouseenter focus",triggerTarget:null},za,{},{allowHTML:!1,animation:"fade",arrow:!0,content:"",inertia:!1,maxWidth:350,role:"tooltip",theme:"",zIndex:9999}),La=Object.keys(na);J.$$tippy=!0;var Oa=1,Qa=[],Va=[];Z.defaultProps=na;Z.setDefaultProps=function(z){Ca(z,[]);Object.keys(z).forEach(function(E){na[E]=z[E]})};Z.currentInput=ma;var ub=Object.assign({},a.applyStyles,{effect:function(z){z=z.state;var E={popper:{position:z.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},
reference:{}};Object.assign(z.elements.popper.style,E.popper);z.styles=E;z.elements.arrow&&Object.assign(z.elements.arrow.style,E.arrow)}}),vb={mouseover:"mouseenter",focusin:"focus",click:"click"},cb={clientX:0,clientY:0},Wa=[];Q&&d('.tippy-box[data-animation=fade][data-state=hidden]{opacity:0}[data-tippy-root]{max-width:calc(100vw - 10px)}.tippy-box{position:relative;background-color:#333;color:#fff;border-radius:4px;font-size:14px;line-height:1.4;outline:0;transition-property:transform,visibility,opacity}.tippy-box[data-placement^=top]>.tippy-arrow{bottom:0}.tippy-box[data-placement^=top]>.tippy-arrow:before{bottom:-7px;left:0;border-width:8px 8px 0;border-top-color:initial;transform-origin:center top}.tippy-box[data-placement^=bottom]>.tippy-arrow{top:0}.tippy-box[data-placement^=bottom]>.tippy-arrow:before{top:-7px;left:0;border-width:0 8px 8px;border-bottom-color:initial;transform-origin:center bottom}.tippy-box[data-placement^=left]>.tippy-arrow{right:0}.tippy-box[data-placement^=left]>.tippy-arrow:before{border-width:8px 0 8px 8px;border-left-color:initial;right:-7px;transform-origin:center left}.tippy-box[data-placement^=right]>.tippy-arrow{left:0}.tippy-box[data-placement^=right]>.tippy-arrow:before{left:-7px;border-width:8px 8px 8px 0;border-right-color:initial;transform-origin:center right}.tippy-box[data-inertia][data-state=visible]{transition-timing-function:cubic-bezier(.54,1.5,.38,1.11)}.tippy-arrow{width:16px;height:16px;color:#333}.tippy-arrow:before{content:"";position:absolute;border-color:transparent;border-style:solid}.tippy-content{position:relative;padding:5px 9px;z-index:1}');
Z.setDefaultProps({plugins:[{name:"animateFill",defaultValue:!1,fn:function(z){var E;if(null==(E=z.props.render)||!E.$$tippy)return V(z.props.animateFill,"The `animateFill` plugin requires the default render function."),{};E=ka(z.popper);var G=E.box,N=E.content,O=z.props.animateFill?ta():null;return{onCreate:function(){O&&(G.insertBefore(O,G.firstElementChild),G.setAttribute("data-animatefill",""),G.style.overflow="hidden",z.setProps({arrow:!1,animation:"shift-away"}))},onMount:function(){if(O){var Y=
G.style.transitionDuration,R=Number(Y.replace("ms",""));N.style.transitionDelay=Math.round(R/10)+"ms";O.style.transitionDuration=Y;r([O],"visible")}},onShow:function(){O&&(O.style.transitionDuration="0ms")},onHide:function(){O&&r([O],"hidden")}}}},{name:"followCursor",defaultValue:!1,fn:function(z){function E(){S=!0;z.setProps({getReferenceClientRect:null});S=!1}function G(la){var ua=la.target?Y.contains(la.target):!0,P=z.props.followCursor,xa=la.clientX,Ba=la.clientY;la=Y.getBoundingClientRect();
var X=xa-la.left,ha=Ba-la.top;!ua&&z.props.interactive||z.setProps({getReferenceClientRect:function(){var va=Y.getBoundingClientRect(),ya=xa,Ea=Ba;"initial"===P&&(ya=va.left+X,Ea=va.top+ha);var Ha="horizontal"===P?va.top:Ea,Ma="vertical"===P?va.right:ya;Ea="horizontal"===P?va.bottom:Ea;va="vertical"===P?va.left:ya;return{width:Ma-va,height:Ea-Ha,top:Ha,right:Ma,bottom:Ea,left:va}}})}function N(){z.props.followCursor&&(Wa.push({instance:z,doc:R}),R.addEventListener("mousemove",ra))}function O(){Wa=
Wa.filter(function(la){return la.instance!==z});0===Wa.filter(function(la){return la.doc===R}).length&&R.removeEventListener("mousemove",ra)}var Y=z.reference,R=u(z.props.triggerTarget||Y),S=!1,T=!1,ca=!0,sa=z.props;return{onCreate:N,onDestroy:O,onBeforeUpdate:function(){sa=z.props},onAfterUpdate:function(la,ua){var P=ua.followCursor;S||void 0===P||sa.followCursor===P||(O(),P?(N(),!z.state.isMounted||T||"initial"===z.props.followCursor&&z.state.isVisible||R.addEventListener("mousemove",G)):(R.removeEventListener("mousemove",
G),E()))},onMount:function(){z.props.followCursor&&!T&&(ca&&(G(cb),ca=!1),"initial"===z.props.followCursor&&z.state.isVisible||R.addEventListener("mousemove",G))},onTrigger:function(la,ua){f(ua,"MouseEvent")&&(cb={clientX:ua.clientX,clientY:ua.clientY});T="focus"===ua.type},onHidden:function(){z.props.followCursor&&(E(),R.removeEventListener("mousemove",G),ca=!0)}}}},{name:"inlinePositioning",defaultValue:!1,fn:function(z){function E(){if(!Y){var S=W(z.props,R);Y=!0;z.setProps(S);Y=!1}}var G=z.reference,
N,O=-1,Y=!1,R={name:"tippyInlinePositioning",enabled:!0,phase:"afterWrite",fn:function(S){var T=S.state;z.props.inlinePositioning&&(N!==T.placement&&z.setProps({getReferenceClientRect:function(){return D(T.placement.split("-")[0],G.getBoundingClientRect(),[].slice.call(G.getClientRects()),O)}}),N=T.placement)}};return{onCreate:E,onAfterUpdate:E,onTrigger:function(S,T){if(f(T,"MouseEvent")){var ca=[].slice.call(z.reference.getClientRects()),sa=ca.find(function(la){return la.left-2<=T.clientX&&la.right+
2>=T.clientX&&la.top-2<=T.clientY&&la.bottom+2>=T.clientY});O=ca.indexOf(sa)}},onUntrigger:function(){O=-1}}}},{name:"sticky",defaultValue:!1,fn:function(z){function E(){var R=!0===z.props.sticky||"reference"===z.props.sticky?(z.popperInstance?z.popperInstance.state.elements.reference:G).getBoundingClientRect():null,S=!0===z.props.sticky||"popper"===z.props.sticky?N.getBoundingClientRect():null;(R&&M(O,R)||S&&M(Y,S))&&z.popperInstance&&z.popperInstance.update();O=R;Y=S;z.state.isMounted&&requestAnimationFrame(E)}
var G=z.reference,N=z.popper,O=null,Y=null;return{onMount:function(){z.props.sticky&&E()}}}}],render:J});Z.createSingleton=function(z,E){function G(){T=S.map(function(X){return X.reference})}function N(X){S.forEach(function(ha){X?ha.enable():ha.disable()})}function O(X){return S.map(function(ha){var va=ha.setProps;ha.setProps=function(ya){va(ya);ha.reference===ca&&X.setProps(ya)};return function(){ha.setProps=va}})}function Y(X,ha){var va=T.indexOf(ha);if(ha!==ca){ca=ha;var ya=(sa||[]).concat("content").reduce(function(Ea,
Ha){Ea[Ha]=S[va].props[Ha];return Ea},{});X.setProps(Object.assign({},ya,{getReferenceClientRect:"function"===typeof ya.getReferenceClientRect?ya.getReferenceClientRect:function(){return ha.getBoundingClientRect()}}))}}var R;void 0===E&&(E={});V(!Array.isArray(z),["The first argument passed to createSingleton() must be an array of tippy instances. The passed value was",String(z)].join(" "));var S=z,T=[],ca,sa=E.overrides,la=[],ua=!1;N(!1);G();var P=Z(m(),Object.assign({},e(E,["overrides"]),{plugins:[{fn:function(){return{onDestroy:function(){N(!0)},
onHidden:function(){ca=null},onClickOutside:function(X){X.props.showOnCreate&&!ua&&(ua=!0,ca=null)},onShow:function(X){X.props.showOnCreate&&!ua&&(ua=!0,Y(X,T[0]))},onTrigger:function(X,ha){Y(X,ha.currentTarget)}}}}].concat(E.plugins||[]),triggerTarget:T,popperOptions:Object.assign({},E.popperOptions,{modifiers:[].concat((null==(R=E.popperOptions)?void 0:R.modifiers)||[],[ub])})})),xa=P.show;P.show=function(X){xa();if(!ca&&null==X)return Y(P,T[0]);if(!ca||null!=X){if("number"===typeof X)return T[X]&&
Y(P,T[X]);if(S.includes(X))return Y(P,X.reference);if(T.includes(X))return Y(P,X)}};P.showNext=function(){var X=T[0];if(!ca)return P.show(0);var ha=T.indexOf(ca);P.show(T[ha+1]||X)};P.showPrevious=function(){var X=T[T.length-1];if(!ca)return P.show(X);var ha=T.indexOf(ca);P.show(T[ha-1]||X)};var Ba=P.setProps;P.setProps=function(X){sa=X.overrides||sa;Ba(X)};P.setInstances=function(X){N(!0);la.forEach(function(ha){return ha()});S=X;N(!1);G();O(P);P.setProps({triggerTarget:T})};la=O(P);return P};Z.delegate=
function(z,E){function G(P){if(P.target&&!T){var xa=P.target.closest(ca);if(xa){var Ba=xa.getAttribute("data-tippy-trigger")||E.trigger||na.trigger;xa._tippy||"touchstart"===P.type&&"boolean"===typeof ua.touch||"touchstart"!==P.type&&0>Ba.indexOf(vb[P.type])||(P=Z(xa,ua))&&(S=S.concat(P))}}}function N(P,xa,Ba,X){void 0===X&&(X=!1);P.addEventListener(xa,Ba,X);R.push({node:P,eventType:xa,handler:Ba,options:X})}function O(P){P=P.reference;N(P,"touchstart",G,pa);N(P,"mouseover",G);N(P,"focusin",G);N(P,
"click",G)}function Y(){R.forEach(function(P){P.node.removeEventListener(P.eventType,P.handler,P.options)});R=[]}V(!(E&&E.target),"You must specity a `target` prop indicating a CSS selector string matching the target elements that should receive a tippy.");var R=[],S=[],T=!1,ca=E.target,sa=e(E,["target"]),la=Object.assign({},sa,{trigger:"manual",touch:!1}),ua=Object.assign({},sa,{showOnCreate:!0});sa=Z(z,la);[].concat(sa).forEach(function(P){var xa=P.destroy,Ba=P.enable,X=P.disable;P.destroy=function(ha){void 0===
ha&&(ha=!0);ha&&S.forEach(function(va){va.destroy()});S=[];Y();xa()};P.enable=function(){Ba();S.forEach(function(ha){return ha.enable()});T=!1};P.disable=function(){X();S.forEach(function(ha){return ha.disable()});T=!0};O(P)});return sa};Z.hideAll=function(z){z=void 0===z?{}:z;var E=z.exclude,G=z.duration;Va.forEach(function(N){var O=!1;E&&(O=E&&E._tippy&&E._tippy.reference===E?N.reference===E:N.popper===E.popper);O||(O=N.props.duration,N.setProps({duration:G}),N.hide(),N.state.isDestroyed||N.setProps({duration:O}))})};
Z.roundArrow='<svg width="16" height="6" xmlns="http://www.w3.org/2000/svg"><path d="M0 6s1.796-.013 4.67-3.615C5.851.9 6.93.006 8 0c1.07-.006 2.148.887 3.343 2.385C14.233 6.005 16 6 16 6H0z"></svg>';return Z});
(function(a,d){"object"===typeof exports&&"undefined"!==typeof module?module.exports=d():"function"===typeof define&&define.amd?define(d):function(){var c=a.Base64,f=d();f.noConflict=function(){a.Base64=c;return f};a.Meteor&&(Base64=f);a.Base64=f}()})("undefined"!==typeof self?self:"undefined"!==typeof window?window:"undefined"!==typeof global?global:this,function(){var a="function"===typeof atob,d="function"===typeof btoa,c="function"===typeof Buffer,f="function"===typeof TextDecoder?new TextDecoder:
void 0,g="function"===typeof TextEncoder?new TextEncoder:void 0,b=Array.prototype.slice.call("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="),e=function(J){var A={};J.forEach(function(Z,ta){return A[Z]=ta});return A}(b),h=/^(?:[A-Za-z\d+\/]{4})*?(?:[A-Za-z\d+\/]{2}(?:==)?|[A-Za-z\d+\/]{3}=?)?$/,k=String.fromCharCode.bind(String),l="function"===typeof Uint8Array.from?Uint8Array.from.bind(Uint8Array):function(J,A){void 0===A&&(A=function(Z){return Z});return new Uint8Array(Array.prototype.slice.call(J,
0).map(A))},m=function(J){return J.replace(/=/g,"").replace(/[+\/]/g,function(A){return"+"==A?"-":"_"})},n=function(J){for(var A,Z,ta,ra="",W=J.length%3,D=0;D<J.length;){if(255<(A=J.charCodeAt(D++))||255<(Z=J.charCodeAt(D++))||255<(ta=J.charCodeAt(D++)))throw new TypeError("invalid character found");A=A<<16|Z<<8|ta;ra+=b[A>>18&63]+b[A>>12&63]+b[A>>6&63]+b[A&63]}return W?ra.slice(0,W-3)+"===".substring(W):ra},p=d?function(J){return btoa(J)}:c?function(J){return Buffer.from(J,"binary").toString("base64")}:
n,q=c?function(J){return Buffer.from(J).toString("base64")}:function(J){for(var A=[],Z=0,ta=J.length;Z<ta;Z+=4096)A.push(k.apply(null,J.subarray(Z,Z+4096)));return p(A.join(""))},r=function(J,A){void 0===A&&(A=!1);return A?m(q(J)):q(J)},u=function(J){if(2>J.length){var A=J.charCodeAt(0);return 128>A?J:2048>A?k(192|A>>>6)+k(128|A&63):k(224|A>>>12&15)+k(128|A>>>6&63)+k(128|A&63)}A=65536+1024*(J.charCodeAt(0)-55296)+(J.charCodeAt(1)-56320);return k(240|A>>>18&7)+k(128|A>>>12&63)+k(128|A>>>6&63)+k(128|
A&63)},x=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,w=function(J){return J.replace(x,u)},v=c?function(J){return Buffer.from(J,"utf8").toString("base64")}:g?function(J){return q(g.encode(J))}:function(J){return p(w(J))},F=function(J,A){void 0===A&&(A=!1);return A?m(v(J)):v(J)};d=function(J){return F(J,!0)};var y=/[\xC0-\xDF][\x80-\xBF]|[\xE0-\xEF][\x80-\xBF]{2}|[\xF0-\xF7][\x80-\xBF]{3}/g,t=function(J){switch(J.length){case 4:return J=((7&J.charCodeAt(0))<<18|(63&J.charCodeAt(1))<<12|(63&J.charCodeAt(2))<<
6|63&J.charCodeAt(3))-65536,k((J>>>10)+55296)+k((J&1023)+56320);case 3:return k((15&J.charCodeAt(0))<<12|(63&J.charCodeAt(1))<<6|63&J.charCodeAt(2));default:return k((31&J.charCodeAt(0))<<6|63&J.charCodeAt(1))}},B=function(J){return J.replace(y,t)},L=function(J){J=J.replace(/\s+/g,"");if(!h.test(J))throw new TypeError("malformed base64.");J+="==".slice(2-(J.length&3));for(var A,Z="",ta,ra,W=0;W<J.length;)A=e[J.charAt(W++)]<<18|e[J.charAt(W++)]<<12|(ta=e[J.charAt(W++)])<<6|(ra=e[J.charAt(W++)]),Z+=
64===ta?k(A>>16&255):64===ra?k(A>>16&255,A>>8&255):k(A>>16&255,A>>8&255,A&255);return Z},C=a?function(J){return atob(J.replace(/[^A-Za-z0-9\+\/]/g,""))}:c?function(J){return Buffer.from(J,"base64").toString("binary")}:L,V=c?function(J){return l(Buffer.from(J,"base64"))}:function(J){return l(C(J),function(A){return A.charCodeAt(0)})},ba=function(J){return V(qa(J))},ia=c?function(J){return Buffer.from(J,"base64").toString("utf8")}:f?function(J){return f.decode(V(J))}:function(J){return B(C(J))},qa=
function(J){return J.replace(/[-_]/g,function(A){return"-"==A?"+":"/"}).replace(/[^A-Za-z0-9\+\/]/g,"")},wa=function(J){return ia(qa(J))},Ca=function(J){return{value:J,enumerable:!1,writable:!0,configurable:!0}},Da=function(){var J=function(A,Z){return Object.defineProperty(String.prototype,A,Ca(Z))};J("fromBase64",function(){return wa(this)});J("toBase64",function(A){return F(this,A)});J("toBase64URI",function(){return F(this,!0)});J("toBase64URL",function(){return F(this,!0)});J("toUint8Array",
function(){return ba(this)})},Aa=function(){var J=function(A,Z){return Object.defineProperty(Uint8Array.prototype,A,Ca(Z))};J("toBase64",function(A){return r(this,A)});J("toBase64URI",function(){return r(this,!0)});J("toBase64URL",function(){return r(this,!0)})},ka={version:"3.7.2",VERSION:"3.7.2",atob:C,atobPolyfill:L,btoa:p,btoaPolyfill:n,fromBase64:wa,toBase64:F,encode:F,encodeURI:d,encodeURL:d,utob:w,btou:B,decode:wa,isValid:function(J){if("string"!==typeof J)return!1;J=J.replace(/\s+/g,"").replace(/={0,2}$/,
"");return!/[^\s0-9a-zA-Z\+/]/.test(J)||!/[^\s0-9a-zA-Z\-_]/.test(J)},fromUint8Array:r,toUint8Array:ba,extendString:Da,extendUint8Array:Aa,extendBuiltins:function(){Da();Aa()},Base64:{}};Object.keys(ka).forEach(function(J){return ka.Base64[J]=ka[J]});return ka});
(function(){var a="undefined"!==typeof window&&"undefined"!==typeof window.document?window.document:{},d="undefined"!==typeof module&&module.exports,c=function(){for(var b,e=["requestFullscreen exitFullscreen fullscreenElement fullscreenEnabled fullscreenchange fullscreenerror".split(" "),"webkitRequestFullscreen webkitExitFullscreen webkitFullscreenElement webkitFullscreenEnabled webkitfullscreenchange webkitfullscreenerror".split(" "),"webkitRequestFullScreen webkitCancelFullScreen webkitCurrentFullScreenElement webkitCancelFullScreen webkitfullscreenchange webkitfullscreenerror".split(" "),
"mozRequestFullScreen mozCancelFullScreen mozFullScreenElement mozFullScreenEnabled mozfullscreenchange mozfullscreenerror".split(" "),"msRequestFullscreen msExitFullscreen msFullscreenElement msFullscreenEnabled MSFullscreenChange MSFullscreenError".split(" ")],h=0,k=e.length,l={};h<k;h++)if((b=e[h])&&b[1]in a){for(h=0;h<b.length;h++)l[e[0][h]]=b[h];return l}return!1}(),f={change:c.fullscreenchange,error:c.fullscreenerror},g={request:function(b){return new Promise(function(e,h){var k=function(){this.off("change",
k);e()}.bind(this);this.on("change",k);b=b||a.documentElement;Promise.resolve(b[c.requestFullscreen]())["catch"](h)}.bind(this))},exit:function(){return new Promise(function(b,e){if(this.isFullscreen){var h=function(){this.off("change",h);b()}.bind(this);this.on("change",h);Promise.resolve(a[c.exitFullscreen]())["catch"](e)}else b()}.bind(this))},toggle:function(b){return this.isFullscreen?this.exit():this.request(b)},onchange:function(b){this.on("change",b)},onerror:function(b){this.on("error",b)},
on:function(b,e){var h=f[b];h&&a.addEventListener(h,e,!1)},off:function(b,e){var h=f[b];h&&a.removeEventListener(h,e,!1)},raw:c};c?(Object.defineProperties(g,{isFullscreen:{get:function(){return!!a[c.fullscreenElement]}},element:{enumerable:!0,get:function(){return a[c.fullscreenElement]}},isEnabled:{enumerable:!0,get:function(){return!!a[c.fullscreenEnabled]}}}),d?module.exports=g:window.screenfull=g):d?module.exports={isEnabled:!1}:window.screenfull={isEnabled:!1}})();
(function(){function a(v){v=String(v);return v.charAt(0).toUpperCase()+v.slice(1)}function d(v,F){var y=-1,t=v?v.length:0;if("number"==typeof t&&-1<t&&t<=q)for(;++y<t;)F(v[y],y,v);else f(v,F)}function c(v){v=String(v).replace(/^ +| +$/g,"");return/^(?:webOS|i(?:OS|P))/.test(v)?v:a(v)}function f(v,F){for(var y in v)u.call(v,y)&&F(v[y],y,v)}function g(v){return null==v?a(v):x.call(v).slice(8,-1)}function b(v,F){var y=null!=v?typeof v[F]:"number";return!/^(?:boolean|number|string|undefined)$/.test(y)&&
("object"==y?!!v[F]:!0)}function e(v){return String(v).replace(/([ -])(?!$)/g,"$1?")}function h(v,F){var y=null;d(v,function(t,B){y=F(y,t,B,v)});return y}function k(v){function F(ma){return h(ma,function(ja,da){var za=da.pattern||e(da);!ja&&(ja=RegExp("\\b"+za+" *\\d+[.\\w_]*","i").exec(v)||RegExp("\\b"+za+" *\\w+-[\\w]*","i").exec(v)||RegExp("\\b"+za+"(?:; *(?:[a-z]+[_-])?[a-z]+\\d+|[^ ();-]*)","i").exec(v))&&((ja=String(da.label&&!RegExp(za,"i").test(da.label)?da.label:ja).split("/"))[1]&&!/[\d.]+/.test(ja[0])&&
(ja[0]+=" "+ja[1]),da=da.label||da,ja=c(ja[0].replace(RegExp(za,"i"),da).replace(RegExp("; *(?:"+da+"[_-])?","i")," ").replace(RegExp("("+da+")[-_.]?(\\w)","i"),"$1 $2")));return ja})}function y(ma){return h(ma,function(ja,da){return ja||(RegExp(da+"(?:-[\\d.]+/|(?: for [\\w-]+)?[ /-])([\\d.]+[^ ();/_-]*)","i").exec(v)||0)[1]||null})}var t=m,B=v&&"object"==typeof v&&"String"!=g(v);B&&(t=v,v=null);var L=t.navigator||{},C=L.userAgent||"";v||(v=C);var V=B?!!L.likeChrome:/\bChrome\b/.test(v)&&!/internal|\n/i.test(x.toString()),
ba=B?"Object":"ScriptBridgingProxyObject",ia=B?"Object":"Environment",qa=B&&t.java?"JavaPackage":g(t.java),wa=B?"Object":"RuntimeObject";ia=(qa=/\bJava/.test(qa)&&t.java)&&g(t.environment)==ia;var Ca=qa?"a":"\u03b1",Da=qa?"b":"\u03b2",Aa=t.document||{},ka=t.operamini||t.opera,J=r.test(J=B&&ka?ka["[[Class]]"]:g(ka))?J:ka=null,A,Z=v;B=[];var ta=null,ra=v==C;C=ra&&ka&&"function"==typeof ka.version&&ka.version();var W=function(ma){return h(ma,function(ja,da){return ja||RegExp("\\b"+(da.pattern||e(da))+
"\\b","i").exec(v)&&(da.label||da)})}([{label:"EdgeHTML",pattern:"Edge"},"Trident",{label:"WebKit",pattern:"AppleWebKit"},"iCab","Presto","NetFront","Tasman","KHTML","Gecko"]),D=function(ma){return h(ma,function(ja,da){return ja||RegExp("\\b"+(da.pattern||e(da))+"\\b","i").exec(v)&&(da.label||da)})}(["Adobe AIR","Arora","Avant Browser","Breach","Camino","Electron","Epiphany","Fennec","Flock","Galeon","GreenBrowser","iCab","Iceweasel","K-Meleon","Konqueror","Lunascape","Maxthon",{label:"Microsoft Edge",
pattern:"Edge"},"Midori","Nook Browser","PaleMoon","PhantomJS","Raven","Rekonq","RockMelt",{label:"Samsung Internet",pattern:"SamsungBrowser"},"SeaMonkey",{label:"Silk",pattern:"(?:Cloud9|Silk-Accelerated)"},"Sleipnir","SlimBrowser",{label:"SRWare Iron",pattern:"Iron"},"Sunrise","Swiftfox","Waterfox","WebPositive","Opera Mini",{label:"Opera Mini",pattern:"OPiOS"},"Opera",{label:"Opera",pattern:"OPR"},"Chrome",{label:"Chrome Mobile",pattern:"(?:CriOS|CrMo)"},{label:"Firefox",pattern:"(?:Firefox|Minefield)"},
{label:"Firefox for iOS",pattern:"FxiOS"},{label:"IE",pattern:"IEMobile"},{label:"IE",pattern:"MSIE"},"Safari"]),M=F([{label:"BlackBerry",pattern:"BB10"},"BlackBerry",{label:"Galaxy S",pattern:"GT-I9000"},{label:"Galaxy S2",pattern:"GT-I9100"},{label:"Galaxy S3",pattern:"GT-I9300"},{label:"Galaxy S4",pattern:"GT-I9500"},{label:"Galaxy S5",pattern:"SM-G900"},{label:"Galaxy S6",pattern:"SM-G920"},{label:"Galaxy S6 Edge",pattern:"SM-G925"},{label:"Galaxy S7",pattern:"SM-G930"},{label:"Galaxy S7 Edge",
pattern:"SM-G935"},"Google TV","Lumia","iPad","iPod","iPhone","Kindle",{label:"Kindle Fire",pattern:"(?:Cloud9|Silk-Accelerated)"},"Nexus","Nook","PlayBook","PlayStation Vita","PlayStation","TouchPad","Transformer",{label:"Wii U",pattern:"WiiU"},"Wii","Xbox One",{label:"Xbox 360",pattern:"Xbox"},"Xoom"]),Q=function(ma){return h(ma,function(ja,da,za){return ja||(da[M]||da[/^[a-z]+(?: +[a-z]+\b)*/i.exec(M)]||RegExp("\\b"+e(za)+"(?:\\b|\\w*\\d)","i").exec(v))&&za})}({Apple:{iPad:1,iPhone:1,iPod:1},Archos:{},
Amazon:{Kindle:1,"Kindle Fire":1},Asus:{Transformer:1},"Barnes & Noble":{Nook:1},BlackBerry:{PlayBook:1},Google:{"Google TV":1,Nexus:1},HP:{TouchPad:1},HTC:{},LG:{},Microsoft:{Xbox:1,"Xbox One":1},Motorola:{Xoom:1},Nintendo:{"Wii U":1,Wii:1},Nokia:{Lumia:1},Samsung:{"Galaxy S":1,"Galaxy S2":1,"Galaxy S3":1,"Galaxy S4":1},Sony:{PlayStation:1,"PlayStation Vita":1}}),K=function(ma){return h(ma,function(ja,da){var za=da.pattern||e(da);if(!ja&&(ja=RegExp("\\b"+za+"(?:/[\\d.]+|[ \\w.]*)","i").exec(v))){var na=
ja,La=da.label||da,Oa={"10.0":"10","6.4":"10 Technical Preview","6.3":"8.1","6.2":"8","6.1":"Server 2008 R2 / 7","6.0":"Server 2008 / Vista","5.2":"Server 2003 / XP 64-bit","5.1":"XP","5.01":"2000 SP1","5.0":"2000","4.0":"NT","4.90":"ME"};za&&La&&/^Win/i.test(na)&&!/^Windows Phone /i.test(na)&&(Oa=Oa[/[\d.]+$/.exec(na)])&&(na="Windows "+Oa);na=String(na);za&&La&&(na=na.replace(RegExp(za,"i"),La));ja=na=c(na.replace(/ ce$/i," CE").replace(/\bhpw/i,"web").replace(/\bMacintosh\b/,"Mac OS").replace(/_PowerPC\b/i,
" OS").replace(/\b(OS X) [^ \d]+/i,"$1").replace(/\bMac (OS X)\b/,"$1").replace(/\/(\d)/," $1").replace(/_/g,".").replace(/(?: BePC|[ .]*fc[ \d.]+)$/i,"").replace(/\bx86\.64\b/gi,"x86_64").replace(/\b(Windows Phone) OS\b/,"$1").replace(/\b(Chrome OS \w+) [\d.]+\b/,"$1").split(" on ")[0])}return ja})}(["Windows Phone","Android","CentOS",{label:"Chrome OS",pattern:"CrOS"},"Debian","Fedora","FreeBSD","Gentoo","Haiku","Kubuntu","Linux Mint","OpenBSD","Red Hat","SuSE","Ubuntu","Xubuntu","Cygwin","Symbian OS",
"hpwOS","webOS ","webOS","Tablet OS","Tizen","Linux","Mac OS X","Macintosh","Mac","Windows 98;","Windows "]);W&&(W=[W]);Q&&!M&&(M=F([Q]));if(A=/\bGoogle TV\b/.exec(M))M=A[0];/\bSimulator\b/i.test(v)&&(M=(M?M+" ":"")+"Simulator");"Opera Mini"==D&&/\bOPiOS\b/.test(v)&&B.push("running in Turbo/Uncompressed mode");"IE"==D&&/\blike iPhone OS\b/.test(v)?(A=k(v.replace(/like iPhone OS/,"")),Q=A.manufacturer,M=A.product):/^iP/.test(M)?(D||(D="Safari"),K="iOS"+((A=/ OS ([\d_]+)/i.exec(v))?" "+A[1].replace(/_/g,
"."):"")):"Konqueror"!=D||/buntu/i.test(K)?Q&&"Google"!=Q&&(/Chrome/.test(D)&&!/\bMobile Safari\b/i.test(v)||/\bVita\b/.test(M))||/\bAndroid\b/.test(K)&&/^Chrome/.test(D)&&/\bVersion\//i.test(v)?(D="Android Browser",K=/\bAndroid\b/.test(K)?K:"Android"):"Silk"==D?(/\bMobi/i.test(v)||(K="Android",B.unshift("desktop mode")),/Accelerated *= *true/i.test(v)&&B.unshift("accelerated")):"PaleMoon"==D&&(A=/\bFirefox\/([\d.]+)\b/.exec(v))?B.push("identifying as Firefox "+A[1]):"Firefox"==D&&(A=/\b(Mobile|Tablet|TV)\b/i.exec(v))?
(K||(K="Firefox OS"),M||(M=A[1])):!D||(A=!/\bMinefield\b/i.test(v)&&/\b(?:Firefox|Safari)\b/.exec(D))?(D&&!M&&/[\/,]|^[^(]+?\)/.test(v.slice(v.indexOf(A+"/")+8))&&(D=null),(A=M||Q||K)&&(M||Q||/\b(?:Android|Symbian OS|Tablet OS|webOS)\b/.test(K))&&(D=/[a-z]+(?: Hat)?/i.exec(/\bAndroid\b/.test(K)?K:A)+" Browser")):"Electron"==D&&(A=(/\bChrome\/([\d.]+)\b/.exec(v)||0)[1])&&B.push("Chromium "+A):K="Kubuntu";C||(C=y(["(?:Cloud9|CriOS|CrMo|Edge|FxiOS|IEMobile|Iron|Opera ?Mini|OPiOS|OPR|Raven|SamsungBrowser|Silk(?!/[\\d.]+$))",
"Version",e(D),"(?:Firefox|Minefield|NetFront)"]));if(A="iCab"==W&&3<parseFloat(C)&&"WebKit"||/\bOpera\b/.test(D)&&(/\bOPR\b/.test(v)?"Blink":"Presto")||/\b(?:Midori|Nook|Safari)\b/i.test(v)&&!/^(?:Trident|EdgeHTML)$/.test(W)&&"WebKit"||!W&&/\bMSIE\b/i.test(v)&&("Mac OS"==K?"Tasman":"Trident")||"WebKit"==W&&/\bPlayStation\b(?! Vita\b)/i.test(D)&&"NetFront")W=[A];"IE"==D&&(A=(/; *(?:XBLWP|ZuneWP)(\d+)/i.exec(v)||0)[1])?(D+=" Mobile",K="Windows Phone "+(/\+$/.test(A)?A:A+".x"),B.unshift("desktop mode")):
/\bWPDesktop\b/i.test(v)?(D="IE Mobile",K="Windows Phone 8.x",B.unshift("desktop mode"),C||(C=(/\brv:([\d.]+)/.exec(v)||0)[1])):"IE"!=D&&"Trident"==W&&(A=/\brv:([\d.]+)/.exec(v))&&(D&&B.push("identifying as "+D+(C?" "+C:"")),D="IE",C=A[1]);if(ra){if(b(t,"global"))if(qa&&(A=qa.lang.System,Z=A.getProperty("os.arch"),K=K||A.getProperty("os.name")+" "+A.getProperty("os.version")),ia){try{C=t.require("ringo/engine").version.join("."),D="RingoJS"}catch(ma){(A=t.system)&&A.global.system==t.system&&(D="Narwhal",
K||(K=A[0].os||null))}D||(D="Rhino")}else"object"==typeof t.process&&!t.process.browser&&(A=t.process)&&("object"==typeof A.versions&&("string"==typeof A.versions.electron?(B.push("Node "+A.versions.node),D="Electron",C=A.versions.electron):"string"==typeof A.versions.nw&&(B.push("Chromium "+C,"Node "+A.versions.node),D="NW.js",C=A.versions.nw)),D||(D="Node.js",Z=A.arch,K=A.platform,C=(C=/[\d.]+/.exec(A.version))?C[0]:null));else g(A=t.runtime)==ba?(D="Adobe AIR",K=A.flash.system.Capabilities.os):
g(A=t.phantom)==wa?(D="PhantomJS",C=(A=A.version||null)&&A.major+"."+A.minor+"."+A.patch):"number"==typeof Aa.documentMode&&(A=/\bTrident\/(\d+)/i.exec(v))?(C=[C,Aa.documentMode],(A=+A[1]+4)!=C[1]&&(B.push("IE "+C[1]+" mode"),W&&(W[1]=""),C[1]=A),C="IE"==D?String(C[1].toFixed(1)):C[0]):"number"==typeof Aa.documentMode&&/^(?:Chrome|Firefox)\b/.test(D)&&(B.push("masking as "+D+" "+C),D="IE",C="11.0",W=["Trident"],K="Windows");K=K&&c(K)}C&&(A=/(?:[ab]|dp|pre|[ab]\d+pre)(?:\d+\+?)?$/i.exec(C)||/(?:alpha|beta)(?: ?\d)?/i.exec(v+
";"+(ra&&L.appMinorVersion))||/\bMinefield\b/i.test(v)&&"a")&&(ta=/b/i.test(A)?"beta":"alpha",C=C.replace(RegExp(A+"\\+?$"),"")+("beta"==ta?Da:Ca)+(/\d+\+?/.exec(A)||""));if("Fennec"==D||"Firefox"==D&&/\b(?:Android|Firefox OS)\b/.test(K))D="Firefox Mobile";else if("Maxthon"==D&&C)C=C.replace(/\.[\d.]+/,".x");else if(/\bXbox\b/i.test(M))"Xbox 360"==M&&(K=null),"Xbox 360"==M&&/\bIEMobile\b/.test(v)&&B.unshift("mobile mode");else if(!/^(?:Chrome|IE|Opera)$/.test(D)&&(!D||M||/Browser|Mobi/.test(D))||
"Windows CE"!=K&&!/Mobi/i.test(v))if("IE"==D&&ra)try{null===t.external&&B.unshift("platform preview")}catch(ma){B.unshift("embedded")}else(/\bBlackBerry\b/.test(M)||/\bBB10\b/.test(v))&&(A=(RegExp(M.replace(/ +/g," *")+"/([.\\d]+)","i").exec(v)||0)[1]||C)?(A=[A,/BB10/.test(v)],K=(A[1]?(M=null,Q="BlackBerry"):"Device Software")+" "+A[0],C=null):this!=f&&"Wii"!=M&&(ra&&ka||/Opera/.test(D)&&/\b(?:MSIE|Firefox)\b/i.test(v)||"Firefox"==D&&/\bOS X (?:\d+\.){2,}/.test(K)||"IE"==D&&(K&&!/^Win/.test(K)&&5.5<
C||/\bWindows XP\b/.test(K)&&8<C||8==C&&!/\bTrident\b/.test(v)))&&!r.test(A=k.call(f,v.replace(r,"")+";"))&&A.name&&(A="ing as "+A.name+((A=A.version)?" "+A:""),r.test(D)?(/\bIE\b/.test(A)&&"Mac OS"==K&&(K=null),A="identify"+A):(A="mask"+A,D=J?c(J.replace(/([a-z])([A-Z])/g,"$1 $2")):"Opera",/\bIE\b/.test(A)&&(K=null),ra||(C=null)),W=["Presto"],B.push(A));else D+=" Mobile";if(A=(/\bAppleWebKit\/([\d.]+\+?)/i.exec(v)||0)[1]){A=[parseFloat(A.replace(/\.(\d)$/,".0$1")),A];if("Safari"==D&&"+"==A[1].slice(-1))D=
"WebKit Nightly",ta="alpha",C=A[1].slice(0,-1);else if(C==A[1]||C==(A[2]=(/\bSafari\/([\d.]+\+?)/i.exec(v)||0)[1]))C=null;A[1]=(/\bChrome\/([\d.]+)/i.exec(v)||0)[1];537.36==A[0]&&537.36==A[2]&&28<=parseFloat(A[1])&&"WebKit"==W&&(W=["Blink"]);ra&&(V||A[1])?(W&&(W[1]="like Chrome"),A=A[1]||(A=A[0],530>A?1:532>A?2:532.05>A?3:533>A?4:534.03>A?5:534.07>A?6:534.1>A?7:534.13>A?8:534.16>A?9:534.24>A?10:534.3>A?11:535.01>A?12:535.02>A?"13+":535.07>A?15:535.11>A?16:535.19>A?17:536.05>A?18:536.1>A?19:537.01>
A?20:537.11>A?"21+":537.13>A?23:537.18>A?24:537.24>A?25:537.36>A?26:"Blink"!=W?"27":"28")):(W&&(W[1]="like Safari"),A=(A=A[0],400>A?1:500>A?2:526>A?3:533>A?4:534>A?"4+":535>A?5:537>A?6:538>A?7:601>A?8:"8"));W&&(W[1]+=" "+(A+="number"==typeof A?".x":/[.+]/.test(A)?"":"+"));"Safari"==D&&(!C||45<parseInt(C))&&(C=A)}"Opera"==D&&(A=/\bzbov|zvav$/.exec(K))?(D+=" ",B.unshift("desktop mode"),"zvav"==A?(D+="Mini",C=null):D+="Mobile",K=K.replace(RegExp(" *"+A+"$"),"")):"Safari"==D&&/\bChrome\b/.exec(W&&W[1])&&
(B.unshift("desktop mode"),D="Chrome Mobile",C=null,/\bOS X\b/.test(K)?(Q="Apple",K="iOS 4.3+"):K=null);C&&0==C.indexOf(A=/[\d.]+$/.exec(K))&&-1<v.indexOf("/"+A+"-")&&(K=String(K.replace(A,"")).replace(/^ +| +$/g,""));W&&!/\b(?:Avant|Nook)\b/.test(D)&&(/Browser|Lunascape|Maxthon/.test(D)||"Safari"!=D&&/^iOS/.test(K)&&/\bSafari\b/.test(W[1])||/^(?:Adobe|Arora|Breach|Midori|Opera|Phantom|Rekonq|Rock|Samsung Internet|Sleipnir|Web)/.test(D)&&W[1])&&(A=W[W.length-1])&&B.push(A);B.length&&(B=["("+B.join("; ")+
")"]);Q&&M&&0>M.indexOf(Q)&&B.push("on "+Q);M&&B.push((/^on /.test(B[B.length-1])?"":"on ")+M);if(K){var pa=(A=/ ([\d.+]+)$/.exec(K))&&"/"==K.charAt(K.length-A[0].length-1);K={architecture:32,family:A&&!pa?K.replace(A[0],""):K,version:A?A[1]:null,toString:function(){var ma=this.version;return this.family+(ma&&!pa?" "+ma:"")+(64==this.architecture?" 64-bit":"")}}}(A=/\b(?:AMD|IA|Win|WOW|x86_|x)64\b/i.exec(Z))&&!/\bi686\b/i.test(Z)?(K&&(K.architecture=64,K.family=K.family.replace(RegExp(" *"+A),"")),
D&&(/\bWOW64\b/i.test(v)||ra&&/\w(?:86|32)$/.test(L.cpuClass||L.platform)&&!/\bWin64; x64\b/i.test(v))&&B.unshift("32-bit")):K&&/^OS X/.test(K.family)&&"Chrome"==D&&39<=parseFloat(C)&&(K.architecture=64);v||(v=null);t={};t.description=v;t.layout=W&&W[0];t.manufacturer=Q;t.name=D;t.prerelease=ta;t.product=M;t.ua=v;t.version=D&&C;t.os=K||{architecture:null,family:null,version:null,toString:function(){return"null"}};t.parse=k;t.toString=function(){return this.description||""};t.version&&B.unshift(C);
t.name&&B.unshift(D);K&&D&&(K!=String(K).split(" ")[0]||K!=D.split(" ")[0]&&!M)&&B.push(M?"("+K+")":"on "+K);B.length&&(t.description=B.join(" "));return t}var l={"function":!0,object:!0},m=l[typeof window]&&window||this,n=l[typeof exports]&&exports;l=l[typeof module]&&module&&!module.nodeType&&module;var p=n&&l&&"object"==typeof global&&global;!p||p.global!==p&&p.window!==p&&p.self!==p||(m=p);var q=Math.pow(2,53)-1,r=/\bOpera/;p=Object.prototype;var u=p.hasOwnProperty,x=p.toString,w=k();"function"==
typeof define&&"object"==typeof define.amd&&define.amd?(m.platform=w,define(function(){return w})):n&&l?f(w,function(v,F){n[F]=v}):m.platform=w}).call(this);var FORBIDDEN_LIST="2 girls 1 cup;2g1c;4r5e;5h1t;5hit;a_s_s;a55;a55hole;acrotomophilia;aeolus;ahole;alabama hot pocket;alaskan pipeline;anal;analprobe;anilingus;anus;apeshit;ar5e;areola;areole;arian;arrse;arse;arsehole;aryan;ass;ass hole;assbag;assbandit;assbang;assbanged;assbanger;assbangs;assbite;assclown;asscock;asscracker;asses;assface;assfuck;assfucker;ass-fucker;assfukka;assgoblin;assh0le;asshat;ass-hat;asshead;assho1e;asshole;assholes;asshopper;ass-jabber;assjacker;asslick;asslicker;assmaster;assmonkey;assmunch;assmuncher;assnigger;asspirate;ass-pirate;assshit;assshole;asssucker;asswad;asswhole;asswipe;asswipes;auto erotic;autoerotic;axwound;azazel;azz;b!tch;b00bs;b17ch;b1tch;babe;babeland;babes;baby batter;baby juice;ball gag;ball gravy;ball kicking;ball licking;ball sack;ball sucking;ballbag;balls;ballsack;bampot;bang;bangbros;banger;bareback;barely legal;barenaked;barf;bastard;bastardo;bastards;bastinado;bawdy;bbw;bdsm;beaner;beaners;beardedclam;beastial;beastiality;beatch;beater;beaver;beaver cleaver;beaver lips;beer;beeyotch;bellend;beotch;bestial;bestiality;bi+ch;biatch;big black;big breasts;big knockers;big tits;bigtits;bimbo;bimbos;birdlock;bitch;bitchass;bitched;bitcher;bitchers;bitches;bitchin;bitching;bitchtits;bitchy;black cock;blonde action;blonde on blonde action;bloody;blow;blow job;blow your load;blowjob;blowjobs;blue waffle;blumpkin;bod;bodily;boink;boiolas;bollock;bollocks;bollok;bollox;bondage;bone;boned;boner;boners;bong;boob;boobies;boobs;booby;booger;bookie;booobs;boooobs;booooobs;booooooobs;bootee;bootie;booty;booty call;booze;boozer;boozy;bosom;bosomy;bowel;bowels;bra;brassiere;breast;breasts;breeder;brotherfucker;brown showers;brunette action;buceta;bugger;bukkake;bull shit;bulldyke;bullet vibe;bullshit;bullshits;bullshitted;bullturds;bum;bumblefuck;bung;bung hole;bunghole;bunny fucker;busty;butt;butt fuck;butt plug;buttcheeks;buttfuck;buttfucka;buttfucker;butthole;buttmuch;butt-pirate;buttplug;c.0.c.k;c.o.c.k.;c.u.n.t;c0ck;c-0-c-k;c0cksucker;caca;cahone;camel toe;cameltoe;camgirl;camslut;camwhore;carpet muncher;carpetmuncher;cawk;cervix;chesticle;chinc;chincs;chink;choad;chocolate rosebuds;chode;chodes;cipa;circlejerk;cl1t;cleveland steamer;climax;clit;clitface;clitfuck;clitoris;clitorus;clits;clitty;clover clamps;clusterfuck;cnut;cocain;cocaine;cock;c-o-c-k;cock sucker;cockass;cockbite;cockblock;cockburger;cockeye;cockface;cockfucker;cockhead;cockholster;cockjockey;cockknocker;cockknoker;cocklump;cockmaster;cockmongler;cockmongruel;cockmonkey;cockmunch;cockmuncher;cocknose;cocknugget;cocks;cockshit;cocksmith;cocksmoke;cocksmoker;cocksniffer;cocksuck;cocksucked;cocksucker;cock-sucker;cocksucking;cocksucks;cocksuka;cocksukka;cockwaffle;coital;cok;cokmuncher;coksucka;commie;condom;coochie;coochy;coon;coons;cooter;coprolagnia;coprophilia;corksucker;cornhole;cox;crabs;crack;cracker;crackwhore;crap;crappy;creampie;crotte;cum;cumbubble;cumdumpster;cumguzzler;cumjockey;cummer;cummin;cumming;cums;cumshot;cumshots;cumslut;cumstain;cumtart;cunilingus;cunillingus;cunnie;cunnilingus;cunny;cunt;c-u-n-t;cuntass;cuntface;cunthole;cunthunter;cuntlick;cuntlicker;cuntlicking;cuntrag;cunts;cuntslut;cyalis;cyberfuc;cyberfuck;cyberfucked;cyberfucker;cyberfuckers;cyberfucking;d0ng;d0uch3;d0uche;d1ck;d1ld0;d1ldo;dago;dagos;dammit;damn;damned;damnit;darkie;date rape;daterape;dawgie-style;deep throat;deepthroat;deggo;dendrophilia;dick;dickbag;dickbeaters;dickdipper;dickface;dickflipper;dickfuck;dickfucker;dickhead;dickheads;dickhole;dickish;dick-ish;dickjuice;dickmilk\ufffd;dickmonger;dickripper;dicks;dicksipper;dickslap;dick-sneeze;dicksucker;dicksucking;dicktickler;dickwad;dickweasel;dickweed;dickwhipper;dickwod;dickzipper;diddle;dike;dildo;dildos;diligaf;dillweed;dimwit;dingle;dingleberries;dingleberry;dink;dinks;dipship;dipshit;dirsa;dirty pillows;dirty sanchez;dlck;dog style;dog-fucker;doggie style;doggiestyle;doggie-style;doggin;dogging;doggy style;doggystyle;doggy-style;dolcett;domination;dominatrix;dommes;dong;donkey punch;donkeyribber;doochbag;doofus;dookie;doosh;dopey;double dong;double penetration;doublelift;douch3;douche;douchebag;douchebags;douche-fag;douchewaffle;douchey;dp action;drunk;dry hump;duche;dumass;dumb ass;dumbass;dumbasses;dumbcunt;dumbfuck;dumbshit;dummy;dumshit;dvda;dyke;dykes;eat my ass;ecchi;ejaculate;ejaculated;ejaculates;ejaculating;ejaculatings;ejaculation;ejakulate;enlargement;erect;erection;erotic;erotism;escort;essohbee;eunuch;extacy;extasy;f u c k;f u c k e r;f.u.c.k;f_u_c_k;f4nny;fack;fag;fagbag;fagfucker;fagg;fagged;fagging;faggit;faggitt;faggot;faggotcock;faggs;fagot;fagots;fags;fagtard;faig;faigt;fanny;fannybandit;fannyflaps;fannyfucker;fanyy;fart;fartknocker;fat;fatass;fcuk;fcuker;fcuking;fecal;feck;fecker;felch;felcher;felching;fellate;fellatio;feltch;feltcher;female squirting;femdom;figging;fingerbang;fingerfuck;fingerfucked;fingerfucker;fingerfuckers;fingerfucking;fingerfucks;fingering;fisted;fistfuck;fistfucked;fistfucker;fistfuckers;fistfucking;fistfuckings;fistfucks;fisting;fisty;flamer;flange;floozy;foad;foah;fondle;foobar;fook;fooker;foot fetish;footjob;foreskin;freex;frigg;frigga;frotting;fubar;fuck;f-u-c-k;fuck buttons;fuck off;fucka;fuckass;fuckbag;fuckboy;fuckbrain;fuckbutt;fuckbutter;fucked;fucker;fuckers;fuckersucker;fuckface;fuckhead;fuckheads;fuckhole;fuckin;fucking;fuckings;fuckingshitmotherfucker;fuckme;fucknugget;fucknut;fucknutt;fuckoff;fucks;fuckstick;fucktard;fuck-tard;fucktards;fucktart;fucktwat;fuckup;fuckwad;fuckwhit;fuckwit;fuckwitt;fudge packer;fudgepacker;fuk;fuker;fukker;fukkin;fuks;fukwhit;fukwit;futanari;fux;fux0r;fvck;fxck;gae;gai;gang bang;gangbang;gangbanged;gangbangs;ganja;gay;gay sex;gayass;gaybob;gaydo;gayfuck;gayfuckist;gaylord;gays;gaysex;gaytard;gaywad;genitals;gey;gfy;ghay;ghey;giant cock;gigolo;girl on;girl on top;girls gone wild;glans;goatcx;goatse;god damn;godamn;godamnit;goddam;god-dam;goddammit;goddamn;goddamned;god-damned;goddamnit;gokkun;golden shower;goldenshower;gonad;gonads;goo girl;gooch;goodpoop;gook;gooks;goregasm;gringo;grope;group sex;gspot;g-spot;gtfo;guido;guro;h0m0;h0mo;hand job;handjob;hard core;hard on;hardcore;hardcoresex;he11;hebe;heeb;hell;hemp;hentai;heroin;herp;herpes;herpy;heshe;hitler;hiv;ho;hoar;hoare;hobag;hoe;hoer;hom0;homey;homo;homodumbshit;homoerotic;homoey;honkey;honky;hooch;hookah;hooker;hoor;hootch;hooter;hooters;hore;horniest;horny;hot carl;hot chick;hotsex;how to kill;how to murder;huge fat;hump;humped;humping;hussy;hymen;inbred;incest;injun;intercourse;j3rk0ff;jack Off;jackass;jackhole;jackoff;jack-off;jaggi;jagoff;jail bait;jailbait;jap;japs;jelly donut;jerk;jerk off;jerk0ff;jerkass;jerked;jerkoff;jerk-off;jigaboo;jiggaboo;jiggerboo;jism;jiz;jizm;jizz;jizzed;juggs;jungle bunny;junglebunny;junkie;junky;kawk;kike;kikes;kill;kinbaku;kinkster;kinky;kkk;klan;knob;knobbing;knobead;knobed;knobend;knobhead;knobjocky;knobjokey;kock;kondum;kondums;kooch;kooches;kootch;kraut;kum;kummer;kumming;kums;kunilingus;kunja;kunt;kyke;l3i+ch;l3itch;labia;lameass;lardass;leather restraint;leather straight jacket;lech;lemon party;leper;lesbian;lesbians;lesbo;lesbos;lez;lezbian;lezbians;lezbo;lezbos;lezzie;lezzies;lezzy;lmao;lmfao;loin;loins;lolita;lovemaking;lube;lust;lusting;lusty;m0f0;m0fo;m45terbate;ma5terb8;ma5terbate;make me come;male squirting;mams;masochist;massa;masterb8;masterbat;masterbat3;masterbate;master-bate;masterbating;masterbation;masterbations;masturbate;masturbating;masturbation;maxi;mcfagget;menage a trois;menses;menstruate;menstruation;meth;m-fucking;mick;milf;minge;missionary position;mof0;mofo;mo-fo;molest;moolie;moron;mothafuck;mothafucka;mothafuckas;mothafuckaz;mothafucked;mothafucker;mothafuckers;mothafuckin;mothafucking;mothafuckings;mothafucks;mother fucker;motherfuck;motherfucka;motherfucked;motherfucker;motherfuckers;motherfuckin;motherfucking;motherfuckings;motherfuckka;motherfucks;mound of venus;mr hands;mtherfucker;mthrfucker;mthrfucking;muff;muff diver;muffdiver;muffdiving;munging;murder;mutha;muthafecker;muthafuckaz;muthafucker;muthafuckker;muther;mutherfucker;mutherfucking;muthrfucking;n1gga;n1gger;nad;nads;naked;nambla;napalm;nappy;nawashi;nazi;nazism;negro;neonazi;nig nog;nigaboo;nigg3r;nigg4h;nigga;niggah;niggas;niggaz;nigger;niggers;niggle;niglet;nimphomania;nimrod;ninny;nipple;nipples;nob;nob jokey;nobhead;nobjocky;nobjokey;nooky;nsfw images;nude;nudity;numbnuts;nut sack;nutsack;nympho;nymphomania;octopussy;omorashi;one cup two girls;one guy one jar;opiate;opium;oral;orally;organ;orgasim;orgasims;orgasm;orgasmic;orgasms;orgies;orgy;ovary;ovum;ovums;p.u.s.s.y.;p0rn;paddy;paedophile;paki;panooch;pantie;panties;panty;pastie;pasty;pawn;pcp;pecker;peckerhead;pedo;pedobear;pedophile;pedophilia;pedophiliac;pee;peepee;pegging;penetrate;penetration;penial;penile;penis;penisbanger;penisfucker;penispuffer;perversion;peyote;phalli;phallic;phone sex;phonesex;phuck;phuk;phuked;phuking;phukked;phukking;phuks;phuq;piece of shit;pigfucker;pillowbiter;pimp;pimpis;pinko;piss;piss pig;pissed;pissed off;pisser;pissers;pisses;pissflaps;pissin;pissing;pissoff;piss-off;pisspig;playboy;pleasure chest;pms;polack;pole smoker;polesmoker;pollock;ponyplay;poof;poon;poonani;poonany;poontang;poop;poop chute;poopchute;poopuncher;porch monkey;porchmonkey;porn;porno;pornography;pornos;pot;potty;prick;pricks;prig;prince albert piercing;pron;prostitute;prude;pthc;pube;pubes;pubic;pubis;punanny;punany;punkass;punky;punta;puss;pusse;pussi;pussies;pussy;pussylicking;pussypounder;pussys;pust;puto;queaf;queef;queer;queerbait;queerhole;queero;queers;quicky;quim;racy;raghead;raging boner;rape;raped;raper;raping;rapist;raunch;rectal;rectum;rectus;reefer;reetard;reich;renob;retard;retarded;reverse cowgirl;revue;rimjaw;rimjob;rimming;ritard;rosy palm;rosy palm and her 5 sisters;rtard;r-tard;rum;rump;rumprammer;ruski;rusty trombone;s hit;s&m;s.h.i.t.;s.o.b.;s_h_i_t;s0b;sadism;sadist;sand nigger;sandler;sandnigger;sanger;santorum;scag;scantily;scat;schizo;schlong;scissoring;screw;screwed;screwing;scroat;scrog;scrot;scrote;scrotum;scrud;scum;seaman;seamen;seduce;seks;semen;sex;sexo;sexual;sexy;sh!+;sh!t;sh1t;s-h-1-t;shag;shagger;shaggin;shagging;shamedame;shaved beaver;shaved pussy;shemale;shi+;shibari;shit;s-h-i-t;shitass;shitbag;shitbagger;shitblimp;shitbrains;shitbreath;shitcanned;shitcunt;shitdick;shite;shiteater;shited;shitey;shitface;shitfaced;shitfuck;shitfull;shithead;shithole;shithouse;shiting;shitings;shits;shitspitter;shitstain;shitt;shitted;shitter;shitters;shittiest;shitting;shittings;shitty;shiz;shiznit;shota;shrimping;sissy;skag;skank;skeet;skullfuck;slag;slanteye;slave;sleaze;sleazy;slut;slutbag;slutdumper;slutkiss;sluts;smeg;smegma;smut;smutty;snatch;sniper;snowballing;snuff;s-o-b;sodom;sodomize;sodomy;son-of-a-bitch;souse;soused;spac;sperm;spic;spick;spik;spiks;splooge;splooge moose;spooge;spook;spread legs;spunk;steamy;stfu;stiffy;stoned;strap on;strapon;strappado;strip;strip club;stroke;stupid;style doggy;suck;suckass;sucked;sucking;sucks;suicide girls;sultry women;sumofabiatch;swastika;swinger;t1t;t1tt1e5;t1tties;tainted love;tampon;tard;taste my;tawdry;tea bagging;teabagging;teat;teets;teez;terd;teste;testee;testes;testical;testicle;testis;threesome;throating;thrust;thug;thundercunt;tied up;tight white;tinkle;tit;titfuck;titi;tits;titt;tittie5;tittiefucker;titties;titty;tittyfuck;tittyfucker;tittywank;titwank;toke;tongue in a;toots;topless;tosser;towelhead;tramp;tranny;transsexual;trashy;tribadism;tub girl;tubgirl;turd;tush;tushy;tw4t;twat;twathead;twatlips;twats;twatty;twatwaffle;twink;twinkie;two girls one cup;twunt;twunter;ugly;unclefucker;undies;undressing;unwed;upskirt;urethra play;urinal;urine;urophilia;uterus;uzi;v14gra;v1gra;vag;vagina;vajayjay;va-j-j;valium;venus mound;viagra;vibrator;violet wand;virgin;vixen;vjayjay;vodka;vomit;vorarephilia;voyeur;vulgar;vulva;w00se;wad;wang;wank;wanker;wankjob;wanky;wazoo;wedgie;weed;weenie;weewee;weiner;weirdo;wench;wet dream;wetback;wh0re;wh0reface;white power;whitey;whiz;whoar;whoralicious;whore;whorealicious;whorebag;whored;whoreface;whorehopper;whorehouse;whores;whoring;wigger;willies;willy;womb;woody;wop;wrapping men;wrinkled starfish;wtf;xrated;x-rated;xx;xxx;yaoi;yeasty;yellow showers;yiffy;yobbo;zoophile;zoophilia;zubb".split(";");
function CSecurityButton(a,d,c,f){var g,b,e,h,k,l,m,n,p,q,r,u;this._init=function(w,v,F,y){g=!1;b=1;e=[];h=[];k=new createjs.Container;k.x=w;k.y=v;y.addChild(k);l=createBitmap(F);l.scaleX=l.scaleY=b;l.regX=F.width/2;l.regY=F.height/2;k.addChild(l);q=DRAW_BUTTON_MAX_NUM_ASK;r=0;u=new CMoveTimeController(-4,-8,k,TIME_TO_WAIT_DRAW_ENABLED_AGAIN[r]);u.addEventListener(ON_TIMER_END,this.resumeFromTimeOver,this);u.setSpectatorMode();u.setAlwaysShown();u.showAttempt(!1);this._initListener()};this.unload=
function(){s_bMobile?k.off("mousedown",m):(k.off("mousedown",m),k.off("mouseover",n));k.off("pressup",p);f.removeChild(k)};this.setVisible=function(w){k.visible=w};this.setClickable=function(w){g=!w};this._initListener=function(){s_bMobile?m=k.on("mousedown",this.buttonDown):(m=k.on("mousedown",this.buttonDown),n=k.on("mouseover",this.buttonOver));p=k.on("pressup",this.buttonRelease)};this.addEventListener=function(w,v,F){e[w]=v;h[w]=F};this.buttonRelease=function(){g||(l.scaleX=b,l.scaleY=b,e[ON_MOUSE_UP]&&
e[ON_MOUSE_UP].call(h[ON_MOUSE_UP]),q--,0>=q&&(q=DRAW_BUTTON_MAX_NUM_ASK,x.setWaitTime(TIME_TO_WAIT_DRAW_ENABLED_AGAIN[r]),r++,r>=TIME_TO_WAIT_DRAW_ENABLED_AGAIN.length&&(r=TIME_TO_WAIT_DRAW_ENABLED_AGAIN.length-1)))};this.buttonDown=function(){g||(l.scaleX=.9*b,l.scaleY=.9*b,playSound("click",1,!1),e[ON_MOUSE_DOWN]&&e[ON_MOUSE_DOWN].call(h[ON_MOUSE_DOWN]))};this.buttonOver=function(w){s_bMobile||g||(w.target.cursor="pointer")};this.pulseAnimation=function(){createjs.Tween.get(l,{loop:!0}).to({scaleX:.9*
b,scaleY:.9*b},850,createjs.Ease.quadOut).to({scaleX:b,scaleY:b},650,createjs.Ease.quadIn)};this.trembleAnimation=function(){createjs.Tween.get(l,{loop:!0}).to({rotation:5},75,createjs.Ease.quadOut).to({rotation:-5},140,createjs.Ease.quadIn).to({rotation:0},75,createjs.Ease.quadIn).wait(750)};this.stopTrembleAnimation=function(){l.rotation=0;createjs.Tween.removeTweens(l)};this.stopAnimation=function(){l.rotation=0;createjs.Tween.removeTweens(l)};this.setPosition=function(w,v){k.x=w;k.y=v};this.setX=
function(w){k.x=w};this.setY=function(w){k.y=w};this.getButtonImage=function(){return l};this.getX=function(){return k.x};this.getY=function(){return k.y};this.setWaitTime=function(w){l.alpha=.5;u.setTime(w);u.startTimer();g=!0};this.resumeFromTimeOver=function(){l.alpha=1;u.stopTimer();g=!1};var x=this;this._init(a,d,c,f);return this}
!function(a){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=a();else if("function"==typeof define&&define.amd)define([],a);else{var d;"undefined"!=typeof window?d=window:"undefined"!=typeof global?d=global:"undefined"!=typeof self&&(d=self);d.TreeModel=a()}}(function(){return function g(d,c,f){function b(k,l){if(!c[k]){if(!d[k]){var m="function"==typeof require&&require;if(!l&&m)return m(k,!0);if(e)return e(k,!0);m=Error("Cannot find module '"+k+"'");throw m.code="MODULE_NOT_FOUND",
m;}m=c[k]={exports:{}};d[k][0].call(m.exports,function(n){var p=d[k][1][n];return b(p?p:n)},m,m.exports,g,d,c,f)}return c[k].exports}for(var e="function"==typeof require&&require,h=0;h<f.length;h++)b(f[h]);return b}({1:[function(d,c,f){var g=d("mergesort");var b=d("find-insert-index");c.exports=function(){function e(n){this.config=n=n||{};this.config.childrenPropertyName=n.childrenPropertyName||"children";this.config.modelComparatorFn=n.modelComparatorFn}function h(n,p){this.config=n;this.model=p;
this.children=[]}function k(n,p,q){if(!(p instanceof h))throw new TypeError("Child must be of type Node.");p.parent=n;n.model[n.config.childrenPropertyName]instanceof Array||(n.model[n.config.childrenPropertyName]=[]);if("function"===typeof n.config.modelComparatorFn){var r=b(n.config.modelComparatorFn,n.model[n.config.childrenPropertyName],p.model);n.model[n.config.childrenPropertyName].splice(r,0,p.model);n.children.splice(r,0,p)}else if(void 0===q)n.model[n.config.childrenPropertyName].push(p.model),
n.children.push(p);else{if(0>q||q>n.children.length)throw Error("Invalid index.");n.model[n.config.childrenPropertyName].splice(q,0,p.model);n.children.splice(r,0,p)}return p}function l(){var n={};1===arguments.length?n.fn=arguments[0]:2===arguments.length?"function"===typeof arguments[0]?(n.fn=arguments[0],n.ctx=arguments[1]):(n.options=arguments[0],n.fn=arguments[1]):(n.options=arguments[0],n.fn=arguments[1],n.ctx=arguments[2]);n.options=n.options||{};n.options.strategy||(n.options.strategy="pre");
if(!m[n.options.strategy])throw Error("Unknown tree walk strategy. Valid strategies are 'pre' [default], 'post' and 'breadth'.");return n}var m={};e.prototype.parse=function(n){var p;if(!(n instanceof Object))throw new TypeError("Model must be of type object.");var q=new h(this.config,n);if(n[this.config.childrenPropertyName]instanceof Array){this.config.modelComparatorFn&&(n[this.config.childrenPropertyName]=g(this.config.modelComparatorFn,n[this.config.childrenPropertyName]));var r=0;for(p=n[this.config.childrenPropertyName].length;r<
p;r++){var u=q,x=this.parse(n[this.config.childrenPropertyName][r]);x.parent=u;u.children.push(x)}}return q};h.prototype.isRoot=function(){return void 0===this.parent};h.prototype.hasChildren=function(){return 0<this.children.length};h.prototype.addChild=function(n){return k(this,n)};h.prototype.addChildAtIndex=function(n,p){if("function"===typeof this.config.modelComparatorFn)throw Error("Cannot add child at index when using a comparator function.");return k(this,n,p)};h.prototype.getPath=function(){var n=
[];(function r(q){n.unshift(q);q.isRoot()||r(q.parent)})(this);return n};h.prototype.walk=function(){var n=l.apply(this,arguments);m[n.options.strategy].call(this,n.fn,n.ctx)};m.pre=function r(p,q){var u;var x=p.call(q,this);var w=0;for(u=this.children.length;w<u;w++){if(!1===x)return!1;x=r.call(this.children[w],p,q)}return x};m.post=function u(q,r){var x;var w=0;for(x=this.children.length;w<x;w++){var v=u.call(this.children[w],q,r);if(!1===v)return!1}return v=q.call(r,this)};m.breadth=function(q,
r){var u=[this];(function w(){var v;if(0!==u.length){var F=u.shift();var y=0;for(v=F.children.length;y<v;y++)u.push(F.children[y]);!1!==q.call(r,F)&&w()}})()};h.prototype.all=function(){var q=[];var r=l.apply(this,arguments);m[r.options.strategy].call(this,function(u){r.fn.call(r.ctx,u)&&q.push(u)},r.ctx);return q};h.prototype.first=function(){var q;var r=l.apply(this,arguments);m[r.options.strategy].call(this,function(u){if(r.fn.call(r.ctx,u))return q=u,!1},r.ctx);return q};h.prototype.drop=function(){if(!this.isRoot()){var q=
this.parent.children.indexOf(this);this.parent.children.splice(q,1);this.parent.model[this.config.childrenPropertyName].splice(q,1);this.parent=void 0;delete this.parent}return this};return e}()},{"find-insert-index":2,mergesort:3}],2:[function(d,c,f){c.exports=function(){return function(g,b,e){var h;var k=0;for(h=b.length;k<h&&!(0<g(b[k],e));k++);return k}}()},{}],3:[function(d,c,f){c.exports=function(){function g(b,e){var h=e.length;if(2<=h){var k=e.slice(0,h/2);h=e.slice(h/2,h);k=g(b,k);h=g(b,
h);for(var l=[],m=k.length,n=h.length;0<m&&0<n;)0>=b(k[0],h[0])?(l.push(k.shift()),m--):(l.push(h.shift()),n--);0<m?l.push.apply(l,k):l.push.apply(l,h);return l}return e.slice()}return g}()},{}]},{},[1])(1)});
var s_iScaleFactor=1,s_iOffsetX,s_iOffsetY,s_bIsIphone,s_bFocus=!0,s_bLandscape=!1,MIN_KEYBOARD_HEIGHT=300,s_bIsKeyboardOpen=!1,browserName=function(a){switch(!0){case -1<a.indexOf("edge"):return"MS Edge";case -1<a.indexOf("edg/"):return"Edge ( chromium based)";case -1<a.indexOf("opr")&&!!window.opr:return"Opera";case -1<a.indexOf("chrome")&&!!window.chrome:return"Chrome";case -1<a.indexOf("trident"):return"MS IE";case -1<a.indexOf("firefox"):return"Mozilla Firefox";case -1<a.indexOf("safari"):return"Safari";
default:return"other"}}(window.navigator.userAgent.toLowerCase());window.addEventListener("resize",function(a){sizeHandler()},!0);
window.visualViewport.addEventListener("resize",function(a){a.target.height<MIN_KEYBOARD_HEIGHT?(s_bIsKeyboardOpen=!0,document.querySelector(".ctl-multiplayer-dlg-wrapper")&&(document.querySelector(".ctl-multiplayer-dlg-wrapper").style.height=a.target.height,document.querySelector(".ctl-multiplayer-dlg-content").style.transform="translate(-50%, -50%) scale(0.5)")):(s_bIsKeyboardOpen=!1,document.querySelector(".ctl-multiplayer-dlg-wrapper")&&(document.querySelector(".ctl-multiplayer-dlg-content").style.transform=
"translate(-50%, -50%) scale(1)",document.querySelector(".ctl-multiplayer-dlg-wrapper").style.height="100%"))});function trace(a){console.log(a)}
function getSize(a){var d=a.toLowerCase(),c=window.document,f=c.documentElement;if(void 0===window["inner"+a])a=f["client"+a];else if(window["inner"+a]!=f["client"+a]){var g=c.createElement("body");g.id="vpw-test-b";g.style.cssText="overflow:scroll";var b=c.createElement("div");b.id="vpw-test-d";b.style.cssText="position:absolute;top:-1000px";b.innerHTML="<style>@media("+d+":"+f["client"+a]+"px){body#vpw-test-b div#vpw-test-d{"+d+":7px!important}}</style>";g.appendChild(b);f.insertBefore(g,c.head);
a=7==b["offset"+a]?f["client"+a]:window["inner"+a];f.removeChild(g)}else a=window["inner"+a];return a}window.addEventListener("orientationchange",onOrientationChange);function onOrientationChange(){window.matchMedia("(orientation: portrait)").matches&&sizeHandler();window.matchMedia("(orientation: landscape)").matches&&sizeHandler()}function isChrome(){return/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)}
function isIpad(){var a=-1!==navigator.userAgent.toLowerCase().indexOf("ipad");return!a&&navigator.userAgent.match(/Mac/)&&navigator.maxTouchPoints&&2<navigator.maxTouchPoints?!0:a}function isMobile(){return isIpad()?!0:navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/webOS/i)||navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/BlackBerry/i)||navigator.userAgent.match(/Windows Phone/i)?!0:!1}
function isIOS(){if(isIpad())return!0;for(var a="iPad Simulator;iPhone Simulator;iPod Simulator;iPad;iPhone;iPod".split(";");a.length;)if(navigator.platform===a.pop())return s_bIsIphone=!0;return s_bIsIphone=!1}function getIOSWindowHeight(){return document.documentElement.clientWidth/window.innerWidth*window.innerHeight}function getHeightOfIOSToolbars(){var a=(0===window.orientation?screen.height:screen.width)-getIOSWindowHeight();return 1<a?a:0}
function playSound(a,d,c){return!1===DISABLE_SOUND_MOBILE||!1===s_bMobile?(s_aSounds[a].play(),s_aSounds[a].volume(d),s_aSounds[a].loop(c),s_aSounds[a]):null}function stopSound(a){!1!==DISABLE_SOUND_MOBILE&&!1!==s_bMobile||s_aSounds[a].stop()}function setVolume(a,d){!1!==DISABLE_SOUND_MOBILE&&!1!==s_bMobile||s_aSounds[a].volume(d)}function setMute(a,d){!1!==DISABLE_SOUND_MOBILE&&!1!==s_bMobile||s_aSounds[a].mute(d)}
function fadeSound(a,d,c,f){!1!==DISABLE_SOUND_MOBILE&&!1!==s_bMobile||s_aSounds[a].fade(d,c,f)}function soundPlaying(a){if(!1===DISABLE_SOUND_MOBILE||!1===s_bMobile)return s_aSounds[a].playing()}
function sizeHandler(){window.scrollTo(0,1);if(document.querySelector("#canvas")){var a=null!==platform.name&&"safari"===platform.name.toLowerCase()?getIOSWindowHeight():getSize("Height");var d=getSize("Width");s_bFocus&&_checkOrientation(d,a);var c=Math.min(a/CANVAS_HEIGHT,d/CANVAS_WIDTH);s_bSquareSize=!1;s_iAspectRatio=d/a;.75<s_iAspectRatio&&1.33>s_iAspectRatio&&(s_bSquareSize=!0);d>a?(s_bLandscape=!0,s_bMobile&&(document.querySelector("#div_display_id").style.display="none")):(s_bLandscape=!1,
null!==s_oMenu&&768<=d?document.querySelector("#div_display_id").style.display="block":document.querySelector("#div_display_id").style.display="none");var f=Math.round(CANVAS_WIDTH*c);c=Math.round(CANVAS_HEIGHT*c);if(c<a){var g=a-c;c+=g;f+=CANVAS_WIDTH/CANVAS_HEIGHT*g}else f<d&&(g=d-f,f+=g,c+=CANVAS_HEIGHT/CANVAS_WIDTH*g);g=a/2-c/2;var b=d/2-f/2,e=CANVAS_WIDTH/f;if(b*e<-EDGEBOARD_X||g*e<-EDGEBOARD_Y)c=Math.min(a/(CANVAS_HEIGHT-2*EDGEBOARD_Y),d/(CANVAS_WIDTH-2*EDGEBOARD_X)),f=CANVAS_WIDTH*c,c*=CANVAS_HEIGHT,
g=(a-c)/2,b=(d-f)/2,e=CANVAS_WIDTH/f;s_iOffsetX=-1*b*e;s_iOffsetY=-1*g*e;0<=g&&(s_iOffsetY=0);0<=b&&(s_iOffsetX=0);null!==s_oInterface&&s_oInterface.refreshButtonPos(s_iOffsetX,s_iOffsetY);null!==s_oMenu&&s_oMenu.refreshButtonPos(s_iOffsetX,s_iOffsetY);null!==s_oModeMenu&&s_oModeMenu.refreshButtonPos(s_iOffsetX,s_iOffsetY);document.querySelector("#canvas").style.width=f+"px";document.querySelector("#canvas").style.height=c+"px";0>g||(g=(a-c)/2);document.querySelector("#canvas").style.top=g+"px";document.querySelector("#canvas").style.left=
b+"px";fullscreenHandler()}}function zoomInCamera(a,d,c,f,g){if(null!==a.getBounds()&&void 0!==a.getBounds())return d/=f,c/=g,c=d<=c?d:c,a.scaleX=a.scaleY=c}function inRectResize(a,d,c){if(null!==a.getBounds()&&void 0!==a.getBounds()){var f=a.getBounds().width;d/=f;f=a.getBounds().height;c=Math.min(d,c/f);return a.scaleX=a.scaleY=c}}
function _checkOrientation(a,d){s_bMobile&&ENABLE_CHECK_ORIENTATION&&(a>d?"landscape"===document.querySelector(".orientation-msg-container").getAttribute("data-orientation")?(document.querySelector(".orientation-msg-container").style.display="none",document.querySelector("body").classList.remove("orientation-alert"),s_oMain.startUpdate()):(document.querySelector(".orientation-msg-container").style.display="block",document.querySelector("body").classList.add("orientation-alert"),s_oMain.stopUpdate()):
"portrait"===document.querySelector(".orientation-msg-container").getAttribute("data-orientation")?(document.querySelector(".orientation-msg-container").style.display="none",document.querySelector("body").classList.remove("orientation-alert"),s_oMain.startUpdate()):(document.querySelector(".orientation-msg-container").style.display="block",document.querySelector("body").classList.add("orientation-alert"),s_oMain.stopUpdate()))}
function inIframe(){try{return window.self!==window.top}catch(a){return!0}}function createBitmap(a,d,c){var f=new createjs.Bitmap(a),g=new createjs.Shape;d&&c?g.graphics.beginFill("#fff").drawRect(0,0,d,c):g.graphics.beginFill("#ff0").drawRect(0,0,a.width,a.height);f.hitArea=g;return f}function createSprite(a,d,c,f,g,b){a=null!==d?new createjs.Sprite(a,d):new createjs.Sprite(a);d=new createjs.Shape;d.graphics.beginFill("#000000").drawRect(-c,-f,g,b);a.hitArea=d;return a}
function pad(a,d,c){a+="";return a.length>=d?a:Array(d-a.length+1).join(c||"0")+a}function randomFloatBetween(a,d,c){"undefined"===typeof c&&(c=2);return parseFloat(Math.min(a+Math.random()*(d-a),d).toFixed(c))}function rotateVector2D(a,d){var c=d.getX()*Math.cos(a)+d.getY()*Math.sin(a),f=d.getX()*-Math.sin(a)+d.getY()*Math.cos(a);d.set(c,f)}function tweenVectorsOnX(a,d,c){return a+c*(d-a)}
function shuffle(a){for(var d=a.length,c,f;0!==d;)f=Math.floor(Math.random()*d),--d,c=a[d],a[d]=a[f],a[f]=c;return a}function bubbleSort(a){do{var d=!1;for(var c=0;c<a.length-1;c++)a[c]>a[c+1]&&(d=a[c],a[c]=a[c+1],a[c+1]=d,d=!0)}while(d)}function compare(a,d){return a.index>d.index?-1:a.index<d.index?1:0}function easeLinear(a,d,c,f){return c*a/f+d}function easeInQuad(a,d,c,f){return c*(a/=f)*a+d}function easeInSine(a,d,c,f){return-c*Math.cos(a/f*(Math.PI/2))+c+d}
function easeInCubic(a,d,c,f){return c*(a/=f)*a*a+d}function getTrajectoryPoint(a,d){var c=new createjs.Point,f=(1-a)*(1-a),g=a*a;c.x=f*d.start.x+2*(1-a)*a*d.traj.x+g*d.end.x;c.y=f*d.start.y+2*(1-a)*a*d.traj.y+g*d.end.y;return c}function formatTime(a){a/=1E3;var d=Math.floor(a/60);a=Math.floor(a-60*d);var c="";c=10>d?c+("0"+d+":"):c+(d+":");return 10>a?c+("0"+a):c+a}function degreesToRadians(a){return a*Math.PI/180}
function checkRectCollision(a,d){var c=getBounds(a,.9);var f=getBounds(d,.98);return calculateIntersection(c,f)}function calculateIntersection(a,d){var c,f,g,b;var e=a.x+(c=a.width/2);var h=a.y+(f=a.height/2);var k=d.x+(g=d.width/2);var l=d.y+(b=d.height/2);e=Math.abs(e-k)-(c+g);h=Math.abs(h-l)-(f+b);return 0>e&&0>h?(e=Math.min(Math.min(a.width,d.width),-e),h=Math.min(Math.min(a.height,d.height),-h),{x:Math.max(a.x,d.x),y:Math.max(a.y,d.y),width:e,height:h,rect1:a,rect2:d}):null}
function getBounds(a,d){var c={x:Infinity,y:Infinity,width:0,height:0};if(a instanceof createjs.Container){c.x2=-Infinity;c.y2=-Infinity;var f=a.children,g=f.length,b;for(b=0;b<g;b++){var e=getBounds(f[b],1);e.x<c.x&&(c.x=e.x);e.y<c.y&&(c.y=e.y);e.x+e.width>c.x2&&(c.x2=e.x+e.width);e.y+e.height>c.y2&&(c.y2=e.y+e.height)}Infinity==c.x&&(c.x=0);Infinity==c.y&&(c.y=0);Infinity==c.x2&&(c.x2=0);Infinity==c.y2&&(c.y2=0);c.width=c.x2-c.x;c.height=c.y2-c.y;delete c.x2;delete c.y2}else{if(a instanceof createjs.Bitmap){g=
a.sourceRect||a.image;b=g.width*d;var h=g.height*d}else if(a instanceof createjs.Sprite)if(a.spriteSheet._frames&&a.spriteSheet._frames[a.currentFrame]&&a.spriteSheet._frames[a.currentFrame].image){g=a.spriteSheet.getFrame(a.currentFrame);b=g.rect.width;h=g.rect.height;f=g.regX;var k=g.regY}else c.x=a.x||0,c.y=a.y||0;else c.x=a.x||0,c.y=a.y||0;f=f||0;b=b||0;k=k||0;h=h||0;c.regX=f;c.regY=k;g=a.localToGlobal(0-f,0-k);e=a.localToGlobal(b-f,h-k);b=a.localToGlobal(b-f,0-k);f=a.localToGlobal(0-f,h-k);c.x=
Math.min(Math.min(Math.min(g.x,e.x),b.x),f.x);c.y=Math.min(Math.min(Math.min(g.y,e.y),b.y),f.y);c.width=Math.max(Math.max(Math.max(g.x,e.x),b.x),f.x)-c.x;c.height=Math.max(Math.max(Math.max(g.y,e.y),b.y),f.y)-c.y}return c}function NoClickDelay(a){this.element=a;window.Touch&&this.element.addEventListener("touchstart",this,!1)}function shuffle(a){for(var d=a.length,c,f;0<d;)f=Math.floor(Math.random()*d),d--,c=a[d],a[d]=a[f],a[f]=c;return a}
NoClickDelay.prototype={handleEvent:function(a){switch(a.type){case "touchstart":this.onTouchStart(a);break;case "touchmove":this.onTouchMove(a);break;case "touchend":this.onTouchEnd(a)}},onTouchStart:function(a){a.preventDefault();this.moved=!1;this.element.addEventListener("touchmove",this,!1);this.element.addEventListener("touchend",this,!1)},onTouchMove:function(a){this.moved=!0},onTouchEnd:function(a){this.element.removeEventListener("touchmove",this,!1);this.element.removeEventListener("touchend",
this,!1);if(!this.moved){a=document.elementFromPoint(a.changedTouches[0].clientX,a.changedTouches[0].clientY);3==a.nodeType&&(a=a.parentNode);var d=document.createEvent("MouseEvents");d.initEvent("click",!0,!0);a.dispatchEvent(d)}}};
(function(){function a(c){var f={focus:"visible",focusin:"visible",pageshow:"visible",blur:"hidden",focusout:"hidden",pagehide:"hidden"};c=c||window.event;c.type in f?document.body.className=f[c.type]:(document.body.className=this[d]?"hidden":"visible","hidden"===document.body.className?(s_oMain.stopUpdate(),s_bFocus=!1):(s_oMain.startUpdate(),s_bFocus=!0))}var d="hidden";d in document?document.addEventListener("visibilitychange",a):(d="mozHidden")in document?document.addEventListener("mozvisibilitychange",
a):(d="webkitHidden")in document?document.addEventListener("webkitvisibilitychange",a):(d="msHidden")in document?document.addEventListener("msvisibilitychange",a):"onfocusin"in document?document.onfocusin=document.onfocusout=a:window.onpageshow=window.onpagehide=window.onfocus=window.onblur=a})();function ctlArcadeResume(){null!==s_oMain&&s_oMain.startUpdate()}function ctlArcadePause(){null!==s_oMain&&s_oMain.stopUpdate()}
function getParamValue(a){for(var d=window.location.search.substring(1).split("&"),c=0;c<d.length;c++){var f=d[c].split("=");if(f[0]==a)return f[1]}}function getParameterByName(a,d){d=void 0===d?window.location.href:d;a=a.replace(/[\[\]]/g,"\\$&");var c=(new RegExp("[?&]"+a+"(=([^&#]*)|&|#|$)")).exec(d);return c?c[2]?decodeURIComponent(c[2].replace(/\+/g," ")):"":null}
function removeParamFromURL(a,d){d=void 0===d?window.location.href:d;var c=new URL(d);c.searchParams["delete"](a);return c.toString()}String.prototype.format=function(){for(var a=this,d=arguments.length;d--;)a=a.replace(new RegExp("\\{"+d+"\\}","gm"),arguments[d]);return a};function copyObjectByValue(a){return JSON.parse(JSON.stringify(a))}
function fullscreenHandler(){ENABLE_FULLSCREEN&&screenfull.isEnabled&&(s_bFullscreen=screenfull.isFullscreen,null!==s_oInterface&&s_oInterface.resetFullscreenBut(),null!==s_oMenu&&s_oMenu.resetFullscreenBut(),null!==s_oModeMenu&&s_oModeMenu.resetFullscreenBut())}if(screenfull.isEnabled)screenfull.on("change",function(){s_bFullscreen=screenfull.isFullscreen;null!==s_oInterface&&s_oInterface.resetFullscreenBut();null!==s_oMenu&&s_oMenu.resetFullscreenBut();null!==s_oModeMenu&&s_oModeMenu.resetFullscreenBut()});
function linearFunction(a,d,c,f,g){return(a-d)*(g-f)/(c-d)+f}function removeElementByValue(a,d){var c=a.indexOf(d);-1!==c&&a.splice(c,1)}function deepEqual(a,d){return a&&d&&"object"===typeof a&&"object"===typeof d?Object.keys(a).length===Object.keys(d).length&&Object.keys(a).reduce(function(c,f){return c&&deepEqual(a[f],d[f])},!0):a===d}function insertInRoundBracket(a){return"("+a+")"}var s_szGameID="99c1e54e4bb14c88ab77ec6a35f93b05";
window.GD_OPTIONS={gameId:s_szGameID,onEvent:function(a){switch(a.name){case "SDK_GAME_START":s_bAdShown=!1;s_oMain&&s_oMain.startUpdate();break;case "SDK_GAME_PAUSE":s_bAdShown=!0;s_oMain&&s_oMain.stopUpdate();break;case "SDK_READY":a=getSize("Width"),s_bMobile&&s_bLandscape||!(768<=a)||(document.querySelector("#div_display_id").style.display="block","undefined"!==typeof gdsdk&&"undefined"!==gdsdk.showAd&&gdsdk.showAd(gdsdk.AdType.Display,{containerId:"div_display_id"}).then(function(){return console.info("showAd(gdsdk.AdType.Display) resolved.")})["catch"](function(d){return console.info(d)}))}}};
(function(a,d,c){var f=a.getElementsByTagName(d)[0];a.getElementById(c)||(a=a.createElement(d),a.id=c,a.src="https://html5.api.gamedistribution.com/main.min.js",f.parentNode.insertBefore(a,f))})(document,"script","gamedistribution-jssdk");var s_bAdShown=!1;
function CSpriteLibrary(){var a={},d,c,f,g,b,e;this.init=function(h,k,l){d={};f=c=0;g=h;b=k;e=l};this.addSprite=function(h,k){if(!a.hasOwnProperty(h)){var l=new Image;a[h]=d[h]={szPath:k,oSprite:l,bLoaded:!1};c++}};this.getSprite=function(h){return a.hasOwnProperty(h)?a[h].oSprite:null};this._onSpritesLoaded=function(){c=0;b.call(e)};this._onSpriteLoaded=function(){g.call(e);++f===c&&this._onSpritesLoaded()};this.loadSprites=function(){for(var h in d)d[h].oSprite.oSpriteLibrary=this,d[h].oSprite.szKey=
h,d[h].oSprite.onload=function(){this.oSpriteLibrary.setLoaded(this.szKey);this.oSpriteLibrary._onSpriteLoaded(this.szKey)},d[h].oSprite.onerror=function(k){var l=k.currentTarget;setTimeout(function(){d[l.szKey].oSprite.src=d[l.szKey].szPath},500)},d[h].oSprite.src=d[h].szPath};this.setLoaded=function(h){a[h].bLoaded=!0};this.isLoaded=function(h){return a[h].bLoaded};this.getNumSprites=function(){return c}}
!function(){function a(g){var b=g;if(f[b])b=f[b];else{for(var e=b,h,k=[],l=0;e;){if(null!==(h=c.text.exec(e)))k.push(h[0]);else if(null!==(h=c.modulo.exec(e)))k.push("%");else if(null!==(h=c.placeholder.exec(e))){if(h[2]){l|=1;var m=[],n=h[2],p;if(null!==(p=c.key.exec(n)))for(m.push(p[1]);""!==(n=n.substring(p[0].length));)if(null!==(p=c.key_access.exec(n)))m.push(p[1]);else if(null!==(p=c.index_access.exec(n)))m.push(p[1]);else throw new SyntaxError("[sprintf] failed to parse named argument key");
else throw new SyntaxError("[sprintf] failed to parse named argument key");h[2]=m}else l|=2;if(3===l)throw Error("[sprintf] mixing positional and named placeholders is not (yet) supported");k.push({placeholder:h[0],param_no:h[1],keys:h[2],sign:h[3],pad_char:h[4],align:h[5],width:h[6],precision:h[7],type:h[8]})}else throw new SyntaxError("[sprintf] unexpected placeholder");e=e.substring(h[0].length)}b=f[b]=k}e=arguments;h=1;k=b.length;m="";var q,r;for(n=0;n<k;n++)if("string"===typeof b[n])m+=b[n];
else if("object"===typeof b[n]){p=b[n];if(p.keys)for(l=e[h],q=0;q<p.keys.length;q++){if(void 0==l)throw Error(a('[sprintf] Cannot access property "%s" of undefined value "%s"',p.keys[q],p.keys[q-1]));l=l[p.keys[q]]}else l=p.param_no?e[p.param_no]:e[h++];c.not_type.test(p.type)&&c.not_primitive.test(p.type)&&l instanceof Function&&(l=l());if(c.numeric_arg.test(p.type)&&"number"!==typeof l&&isNaN(l))throw new TypeError(a("[sprintf] expecting number but found %T",l));c.number.test(p.type)&&(r=0<=l);
switch(p.type){case "b":l=parseInt(l,10).toString(2);break;case "c":l=String.fromCharCode(parseInt(l,10));break;case "d":case "i":l=parseInt(l,10);break;case "j":l=JSON.stringify(l,null,p.width?parseInt(p.width):0);break;case "e":l=p.precision?parseFloat(l).toExponential(p.precision):parseFloat(l).toExponential();break;case "f":l=p.precision?parseFloat(l).toFixed(p.precision):parseFloat(l);break;case "g":l=p.precision?String(Number(l.toPrecision(p.precision))):parseFloat(l);break;case "o":l=(parseInt(l,
10)>>>0).toString(8);break;case "s":l=String(l);l=p.precision?l.substring(0,p.precision):l;break;case "t":l=String(!!l);l=p.precision?l.substring(0,p.precision):l;break;case "T":l=Object.prototype.toString.call(l).slice(8,-1).toLowerCase();l=p.precision?l.substring(0,p.precision):l;break;case "u":l=parseInt(l,10)>>>0;break;case "v":l=l.valueOf();l=p.precision?l.substring(0,p.precision):l;break;case "x":l=(parseInt(l,10)>>>0).toString(16);break;case "X":l=(parseInt(l,10)>>>0).toString(16).toUpperCase()}if(c.json.test(p.type))m+=
l;else{if(!c.number.test(p.type)||r&&!p.sign)var u="";else u=r?"+":"-",l=l.toString().replace(c.sign,"");q=p.pad_char?"0"===p.pad_char?"0":p.pad_char.charAt(1):" ";var x=p.width-(u+l).length;x=p.width?0<x?q.repeat(x):"":"";m+=p.align?u+l+x:"0"===q?u+x+l:x+u+l}}return m}function d(g,b){return a.apply(null,[g].concat(b||[]))}var c={not_string:/[^s]/,not_bool:/[^t]/,not_type:/[^T]/,not_primitive:/[^v]/,number:/[diefg]/,numeric_arg:/[bcdiefguxX]/,json:/[j]/,not_json:/[^j]/,text:/^[^\x25]+/,modulo:/^\x25{2}/,
placeholder:/^\x25(?:([1-9]\d*)\$|\(([^)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-gijostTuvxX])/,key:/^([a-z_][a-z_\d]*)/i,key_access:/^\.([a-z_][a-z_\d]*)/i,index_access:/^\[(\d+)\]/,sign:/^[+-]/},f=Object.create(null);"undefined"!==typeof exports&&(exports.sprintf=a,exports.vsprintf=d);"undefined"!==typeof window&&(window.sprintf=a,window.vsprintf=d,"function"===typeof define&&define.amd&&define(function(){return{sprintf:a,vsprintf:d}}))}();
CTLText.prototype={constructor:CTLText,__autofit:function(){var a=this._szMsg,d=3>a.length?!1:this._bEllipsis;d&&(this._oText.text=this._szMsg);if(d||this._bMultiline){var c=a.length-2,f=this._iStartingFontSize;this.__refreshTextFont(f);for(var g=this._oText.getBounds();g.height+this._iOutline>this._iEffectiveHeight||g.width+this._iOutline>this._iEffectiveWidth;){if(d&&f<this._iMinTextSize){if(c--,this._oText.text=a.slice(0,c)+"...",this.__updateY(),this.__verticalAlign(),1==c)break}else if(f--,this.__refreshTextFont(f),
this.__updateY(),this.__verticalAlign(),f<this._iMinTextSize&&!d)break;g=this._oText.getBounds()}this._iFontSize=f;this.__updateY();this.__verticalAlign();this.__updateStroke()}else this.__autofitLight()},__checkAutofit:function(){this._bFitText?this.__autofit():(this.__refreshTextFont(this._iStartingFontSize),this.__updateY(),this.__verticalAlign(),this.__updateStroke())},__autofitLight:function(){this.__refreshTextFont(this._iStartingFontSize);var a=Math.floor(linearFunction(this._iEffectiveWidth,
this._oText.getBounds().width+this._iOutline,0,this._iStartingFontSize,0));a>this._iStartingFontSize?a=this._iStartingFontSize:a<this._iMinTextSize&&(a=this._iMinTextSize);this.__refreshTextFont(a);this._iFontSize=a;this.__updateY();this.__verticalAlign();this.__updateStroke()},__refreshTextFont:function(a){this._oText.font=a+"px "+this._szFont;this._oText.lineHeight=Math.round(a*this._fLineHeightFactor)},__verticalAlign:function(){if(this._bVerticalAlign){var a=this._oText.getBounds().height;this._oText.y-=
(a-this._iHeight)/2+this._iPaddingV}},__updateY:function(){this._oText.y=this._iPaddingV;switch(this._oText.textBaseline){case "middle":this._oText.y+=this._oText.lineHeight/2+(this._iFontSize*this._fLineHeightFactor-this._iFontSize)}},__updateStroke:function(){this._oStroke&&(this._oStroke.x=this._oText.x,this._oStroke.y=this._oText.y,this._oStroke.text=this._oText.text,this._oStroke.font=this._oText.font,this._oStroke.lineHeight=this._oText.lineHeight)},__updateOutline:function(){this._iOutline=
this._oStroke&&this._oStroke.outline>this._oText.outline?this._oStroke.outline:this._oText.outline},__updateHorizontalAlign:function(){switch(this._szAlign){case "center":this._oText.x=this._iWidth/2;break;case "left":this._oText.x=this._iPaddingH;break;case "right":this._oText.x=this._iWidth-this._iPaddingH}},__setMsg:function(a){this._szMsg=a;""!==this._szMsg&&this._szMsg||(this._szMsg=" ")},__createDebugShape:function(){this._oDebugShape=new createjs.Shape;this.__refreshDebugShape()},__refreshDebugShape:function(){this._oDebugShape.graphics.clear();
this._oDebugShape.graphics.beginFill("rgba(255,130,0,0.5)").drawRect(0,0,this._iWidth,this._iHeight).moveTo(this._iPaddingH,this._iHeight-this._iPaddingV).lineTo(this._iWidth-this._iPaddingH,this._iHeight-this._iPaddingV).lineTo(this._iWidth-this._iPaddingH,this._iPaddingV).lineTo(this._iPaddingH,this._iPaddingV).closePath().beginFill("rgba(255,0,0,0.5)").drawRect(this._iPaddingH,this._iPaddingV,this._iEffectiveWidth,this._iEffectiveHeight)},__updateLineWidth:function(){this._oText.lineWidth=this._bMultiline?
this._iWidth-2*this._iPaddingH:null;this._oStroke&&(this._oStroke.lineWidth=this._oText.lineWidth)},__updateWidth:function(){this.__updateLineWidth();this.__updateHorizontalAlign()},__updateSize:function(){this.__checkAutofit();this._bDebug&&this.__refreshDebugShape()},__createText:function(){this._bDebug&&(this.__createDebugShape(),this._oContainer.addChild(this._oDebugShape));this._oText=new createjs.Text(this._szMsg,this._iFontSize+"px "+this._szFont,this._szColor);this._oText.textBaseline="middle";
this._oText.lineHeight=Math.round(this._iFontSize*this._fLineHeightFactor);this._oText.textAlign=this._szAlign;this.__updateLineWidth();this.__updateHorizontalAlign();this._oContainer.addChild(this._oText);this.refreshText(this._szMsg)},setStroke:function(a,d){this._oStroke||(this._oStroke=this._oText.clone(),this._oContainer.addChild(this._oStroke),this._oContainer.swapChildren(this._oStroke,this._oText));this.setStrokeColor(d?d:this._szStrokeColor);this.setStrokeSize(a?a:this._iStrokeSize)},setStrokeColor:function(a){this._szStrokeColor=
a;this._oStroke&&(this._oStroke.color=this._szStrokeColor)},setStrokeSize:function(a){this._iStrokeSize=a;this._oStroke&&(this._oStroke.outline=this._iStrokeSize,this.__updateOutline(),this.__checkAutofit())},removeStroke:function(){this._oStroke&&(this._oContainer.removeChild(this._oStroke),this._oStroke=null,this.__updateOutline(),this.__checkAutofit())},roll:function(a,d,c,f,g,b){d=null==d?1500:d;c=null==c?createjs.Ease.linear:c;var e={score:parseInt(this._szMsg)};this._szMsg=a;var h=this._bFitText?
function(){this._oText.text=Math.floor(e.score);this.__autofitLight()}:function(){this._oText.text=Math.floor(e.score);this.__updateY();this.__verticalAlign();this.__updateStroke()};this.stopRolling();this._oTweenRollText=createjs.Tween.get(e,{override:!0}).to({score:a},d,c);this._oTweenRollText.on("change",h,this);this._oTweenRollText.on("complete",function(){f&&f.apply(g,b);this.stopRolling()},this,!0)},isRolling:function(){return null==this._oTweenRollText?!1:!0},stopRolling:function(){this.isRolling()&&
(this._oTweenRollText.removeAllEventListeners(),this._oTweenRollText.paused=!0,this._oTweenRollText=null)},pauseRolling:function(){this.isRolling()&&(this._oTweenRollText.paused=!0)},resumeRolling:function(){this.isRolling()&&(this._oTweenRollText.paused=!1)},setY:function(a){this._oContainer.y=a},setX:function(a){this._oContainer.x=a},setHorizontalSize:function(a,d){d=void 0===d?this._iPaddingH:d;this.__setHorizontalSizeVars(a,d);this.__updateWidth();this.__updateSize()},setVerticalSize:function(a,
d){d=void 0===d?this._iPaddingV:d;this.__setVerticalSizeVars(a,d);this.__updateSize()},setSize:function(a,d,c,f){c=void 0===c?this._iPaddingH:c;f=void 0===f?this._iPaddingV:f;this.__setHorizontalSizeVars(a,c);this.__setVerticalSizeVars(d,f);this.__updateWidth();this.__updateSize()},__setHorizontalSizeVars:function(a,d){this._iWidth=a;this._iPaddingH=d;this._iEffectiveWidth=this._iWidth-2*this._iPaddingH},__setVerticalSizeVars:function(a,d){this._iHeight=a;this._iPaddingV=d;this._iEffectiveHeight=
this._iHeight-2*this._iPaddingV},setPosition:function(a,d){this._oContainer.x=a;this._oContainer.y=d},setHorizontalAlign:function(a){this._szAlign=a;this._oText.textAlign=this._szAlign;this.__updateHorizontalAlign()},setVerticalAlign:function(a){this._bVerticalAlign=a},setOutline:function(a){this._oText.outline=a;this.__updateOutline()},setShadow:function(a,d,c,f){this._oText.shadow=new createjs.Shadow(a,d,c,f)},setColor:function(a){this._szColor=a;this._oText.color=this._szColor},setAlpha:function(a){this._oContainer.alpha=
a},setVisible:function(a){this._oContainer.visible=a},setFontSize:function(a){this._iFontSize=this._iStartingFontSize=a;this.refreshText(this._szMsg)},setRegX:function(a){this._oContainer.regX=a},setRegY:function(a){this._oContainer.regY=a},removeTweens:function(){createjs.Tween.removeTweens(this._oContainer)},getText:function(){return this._oText},getTextWidth:function(){return this._oText.getBounds().width+this._iOutline},getTextHeight:function(){return this._oText.getBounds().height+this._iOutline},
getMsg:function(){return this._szMsg},getX:function(){return this._oContainer.x},getY:function(){return this._oContainer.y},getHeight:function(){return this._iHeight},getWidth:function(){return this._iWidth},getPaddingH:function(){return this._iPaddingH},getPaddingV:function(){return this._iPaddingV},getColor:function(){return this._szColor},getFontSize:function(){return this._iFontSize},getContainer:function(){return this._oContainer},unload:function(){this.stopRolling();createjs.Tween.removeTweens(this._oContainer);
this._oParentContainer.removeChild(this._oContainer)},refreshText:function(a){this.__setMsg(a);this._oText.text=this._szMsg;this.__checkAutofit()}};
function CTLText(a,d,c,f,g,b,e,h,k,l,m,n,p,q,r,u,x,w,v){w=void 0===w?11:w;v=void 0===v?!0:v;this._oParentContainer=a;this._oContainer=new createjs.Container;this._oContainer.x=d;this._oContainer.y=c;this._oParentContainer.addChild(this._oContainer);this._iOutline=0;this._iWidth=f;this._iHeight=g;this._bMultiline=u;this._iStartingFontSize=this._iFontSize=b;this._szAlign=e;this._szColor=h;this._szFont=k;this._iPaddingH=m;this._iPaddingV=n;this._iEffectiveWidth=this._iWidth-2*this._iPaddingH;this._iEffectiveHeight=
this._iHeight-2*this._iPaddingV;this._bVerticalAlign=r;this._bFitText=q;this._iMinTextSize=w;this._bDebug=x;this._bEllipsis=v;this._oDebugShape=null;this._fLineHeightFactor=l;this._oText=null;this.__setMsg(p);this.__createText()}
function CToggle(a,d,c,f,g){var b,e,h,k,l=[],m,n,p,q;this._init=function(r,u,x,w){e=!1;h=[];k=[];var v=new createjs.SpriteSheet({images:[x],frames:{width:x.width/2,height:x.height,regX:x.width/2/2,regY:x.height/2},animations:{state_true:[0],state_false:[1]}});b=w;m=createSprite(v,"state_"+b,x.width/2/2,x.height/2,x.width/2,x.height);m.x=r;m.y=u;m.stop();g.addChild(m);this._initListener()};this.unload=function(){s_bMobile?m.off("mousedown",n):(m.off("mousedown",n),m.off("mouseover",p));m.off("pressup",
q);g.removeChild(m)};this._initListener=function(){s_bMobile?n=m.on("mousedown",this.buttonDown):(n=m.on("mousedown",this.buttonDown),p=m.on("mouseover",this.buttonOver));q=m.on("pressup",this.buttonRelease)};this.addEventListener=function(r,u,x){h[r]=u;k[r]=x};this.addEventListenerWithParams=function(r,u,x,w){h[r]=u;k[r]=x;l=w};this.enable=function(){e=!1;m.alpha=1;m.gotoAndStop("state_"+b)};this.disable=function(){e=!0;m.alpha=.5;m.gotoAndStop("state_false")};this.setClickable=function(r){e=!r};
this.setActive=function(r){b=r;m.gotoAndStop("state_"+b)};this.buttonRelease=function(){e||(m.scaleX=1,m.scaleY=1,playSound("click",1,!1),b=!b,m.gotoAndStop("state_"+b),h[ON_MOUSE_UP]&&h[ON_MOUSE_UP].call(k[ON_MOUSE_UP],l))};this.buttonDown=function(){e||(m.scaleX=.9,m.scaleY=.9,h[ON_MOUSE_DOWN]&&h[ON_MOUSE_DOWN].call(k[ON_MOUSE_DOWN],l))};this.buttonOver=function(r){s_bMobile||e||(r.target.cursor="pointer")};this.stopAnimation=function(){m.rotation=0;createjs.Tween.removeTweens(m)};this.getButtonImage=
function(){return m};this.setPosition=function(r,u){m.x=r;m.y=u};this.setVisible=function(r){m.visible=r};this.setRotation=function(r){m.rotation=r};this.getState=function(){return b};this._init(a,d,c,f)}
function CGfxButton(a,d,c,f){var g,b,e,h,k,l,m,n;this._init=function(p,q,r,u){g=!1;b=1;e=[];h=[];k=createBitmap(r);k.x=p;k.y=q;k.regX=r.width/2;k.regY=r.height/2;u.addChild(k);this._initListener()};this.unload=function(){s_bMobile?k.off("mousedown",l):(k.off("mousedown",l),k.off("mouseover",m));k.off("pressup",n);f.removeChild(k)};this.setVisible=function(p){k.visible=p};this.isVisible=function(){return k.visible};this.setClickable=function(p){g=!p};this.enable=function(){g=!1;k.alpha=1};this.disable=
function(){g=!0;k.alpha=.5};this._initListener=function(){s_bMobile?l=k.on("mousedown",this.buttonDown):(l=k.on("mousedown",this.buttonDown),m=k.on("mouseover",this.buttonOver));n=k.on("pressup",this.buttonRelease)};this.addEventListener=function(p,q,r){e[p]=q;h[p]=r};this.buttonRelease=function(){g||(k.scale=b,e[ON_MOUSE_UP]&&e[ON_MOUSE_UP].call(h[ON_MOUSE_UP]))};this.buttonDown=function(){g||(k.scale=.9*b,playSound("click",1,!1),e[ON_MOUSE_DOWN]&&e[ON_MOUSE_DOWN].call(h[ON_MOUSE_DOWN]))};this.buttonOver=
function(p){s_bMobile||g||(p.target.cursor="pointer")};this.pulseAnimation=function(){createjs.Tween.get(k,{loop:!0}).to({scaleX:.9*b,scaleY:.9*b},850,createjs.Ease.quadOut).to({scaleX:b,scaleY:b},650,createjs.Ease.quadIn)};this.trembleAnimation=function(){createjs.Tween.get(k,{loop:!0}).to({rotation:5},75,createjs.Ease.quadOut).to({rotation:-5},140,createjs.Ease.quadIn).to({rotation:0},75,createjs.Ease.quadIn).wait(750)};this.stopTrembleAnimation=function(){createjs.Tween.removeTweens(k)};this.stopAnimation=
function(){k.rotation=0;createjs.Tween.removeTweens(k)};this.setPosition=function(p,q){k.x=p;k.y=q};this.setScale=function(p){b=p;k.scale=p};this.setX=function(p){k.x=p};this.setY=function(p){k.y=p};this.getButtonImage=function(){return k};this.getX=function(){return k.x};this.getY=function(){return k.y};this._init(a,d,c,f);return this}
var ON_CONNECTION_ERROR=0,ON_DISCONNECTION=1,ON_DISCONNECTION_FROM_MATCH=2,ON_LOGIN_SUCCESS=3,ON_MATCHMAKING_CONNECTION_SUCCESS=4,ON_GAMEROOM_CONNECTION_SUCCESS=5,ON_USEROWNERROOM_CREATE_SUCCESS=6,ON_USEROWNERROOM_JOIN_SUCCESS=7,ON_ROOM_INFO_RETURNED=8,ON_BACK_FROM_A_ROOM=9,ERROR_CODE_UNKNOWNROOM="UnknownRoom",ON_STATUS_ONLINE="online",ON_STATUS_OFFLINE="offline",ROOM_TYPE_MATCHMAKING="MatchmakingRoom",ROOM_TYPE_USEROWNER="UserOwnerRoom",ROOM_TYPE_GAME="GameRoom",WAITING_PLAYERS_TIMEOUT=1E4;
function CNetworkManager(){var a,d,c,f,g,b,e,h,k,l,m,n,p,q,r,u,x,w,v,F,y;this._init=function(){a=navigator.onLine;d=[];c=[];f=[];g=[];n=0;window.addEventListener("online",this._onConnectionChangeStatusOnline);window.addEventListener("offline",this._onConnectionChangeStatusOffline);h=new CNetworkMessageForwarder;y=this};this.unload=function(){window.removeEventListener("online",this._onConnectionChangeStatusOnline);window.removeEventListener("offline",this._onConnectionChangeStatusOffline);d=[];c=
[];b&&(b.removeDisconnectCallback(),b.removeMessageCallback());s_oNetworkManager=null};this.disconnectFromSystem=function(){g_oCTLMultiplayer.closeAllDialog();y.disconnectFromCurRoom()};this.connectToSystem=function(){a?g_oCTLMultiplayer.showChooseNickName():y.showErrorMessage(TEXT_NO_CONNECTION)};this.login=function(t){y.isAllowedWord(t)?(r=t,t=y._setValidNick(t),g_oCTLMultiplayer.closeAllDialog(),g_oCTLMultiplayer.showLoading(TEXT_SYS_LOADING),PlayerIO.useSecureApiRequests=!MULTIPLAYER_TEST_LOCAL,
PlayerIO.authenticate(GAME_PLAYERIO_ID,"public",{userId:t},{},function(B){e=B;e.multiplayer.useSecureConnections=!MULTIPLAYER_TEST_LOCAL;MULTIPLAYER_TEST_LOCAL&&(e.multiplayer.developmentServer="localhost:8184");d[ON_LOGIN_SUCCESS]&&d[ON_LOGIN_SUCCESS].call(c[ON_LOGIN_SUCCESS])},y.callbackError)):(g_oCTLMultiplayer.closeAllDialog(),g_oCTLMultiplayer.showGeneralDialog(TEXT_INVALID_NAME,"g_oCTLMultiplayer.closeAllDialog"))};this._stripHTML=function(t){return t.replace(/<[^>]*>?/gm,"")};this.isAllowedWord=
function(t){var B=!0;t=t.toLocaleLowerCase();for(var L=0;L<FORBIDDEN_LIST.length;L++){var C=FORBIDDEN_LIST[L];if(t.includes(C)&&2>t.length/C.length){B=!1;break}}return B};this._setValidNick=function(t){var B=y._getRandomCodeNumber();""===t?r=t="guest-"+B:t=t+"-"+B;return t=this._stripHTML(t)};this._getRandomCodeNumber=function(){return Math.floor(1E3*Math.random())};this.generateRandomName=function(){var t="xmariox alex max mahuro biajus rob idah fabrix seth ikillyou commander admiral general seasalt emperorofthesea Aspect Kraken Dragon Shiver Dracula Doom Scar Roadkill Cobra Psycho Ranger Ripley Clink Bruise Bowser Creep Cannon Daemon Steel Tempest Hurricane Titanium Tito Lightning IronHeart Sabotage Rex Hydra Terminator Agrippa Gash Blade Katana Gladius Angon Claymore Pike Hammer Club Heart Gauntlet Montante Longbow bow Dagger".split(" "),
B=Math.floor(Math.random()*t.length);t=t[B];if(.5<Math.random()){var L=Math.floor(100*Math.random());if(.5<Math.random()){var C=["-","_"];B=Math.floor(Math.random()*C.length);t+=C[B]}t+=L}return F=t};this.getBotName=function(){return F};this.getMinutesMatch=function(){return l};this.getRulesMatch=function(){return q};this._onConnectionChangeStatusOnline=function(t){a=!0;d[ON_STATUS_ONLINE]&&d[ON_STATUS_ONLINE].call(c[ON_STATUS_ONLINE]);null!==document.querySelector(".ctl-multiplayer-dlg-content")&&
y._onReconnection()};this._onConnectionChangeStatusOffline=function(){a=!1;d[ON_STATUS_OFFLINE]&&d[ON_STATUS_OFFLINE].call(c[ON_STATUS_OFFLINE]);null!==document.querySelector(".ctl-multiplayer-dlg-content")&&y.showErrorMessage(TEXT_NO_CONNECTION);y.disconnect()};this._onReconnection=function(){null===r||void 0===r?(g_oCTLMultiplayer.closeAllDialog(),y.connectToSystem()):(g_oCTLMultiplayer.closeAllDialog(),y.gotoLobby())};this.showErrorMessage=function(t){g_oCTLMultiplayer.closeAllDialog();g_oCTLMultiplayer.showGeneralDialog(t,
"g_oCTLMultiplayer.closeAllDialog")};this.addEventListener=function(t,B,L){d[t]=B;c[t]=L};this.callbackError=function(t){console.log("Error: "+t.code+" - "+t.message);d[ON_CONNECTION_ERROR]&&d[ON_CONNECTION_ERROR].call(c[ON_CONNECTION_ERROR],t);switch(t.code){case ERROR_CODE_UNKNOWNROOM:g_oCTLMultiplayer.closeAllDialog();g_oCTLMultiplayer.showGeneralDialog(TEXT_ROOM_DOESNT_EXIST,"s_oNetworkManager.gotoLobby");break;default:y.showErrorMessage(t)}};this.callbackDisconnect=function(t){console.log("Disconnected From Menu");
d[ON_DISCONNECTION]&&d[ON_DISCONNECTION].call(c[ON_DISCONNECTION],t)};this.callbackDisconnectFromMatch=function(t){console.log("Disconnected From Match");d[ON_DISCONNECTION_FROM_MATCH]&&d[ON_DISCONNECTION_FROM_MATCH].call(c[ON_DISCONNECTION_FROM_MATCH],t)};this.sendMsg=function(t,B){b&&b.send(t,B)};this.disconnect=function(){b&&(b.disconnect(),b=null)};this.isUserA=function(){return 0===parseInt(k)?!0:!1};this.getPlayerOrderID=function(){return k};this.getPlayerNickname=function(){return r};this.getNicknameByID=
function(t){return u[t]};this.getNicknameList=function(){return u};this.getAvatarByID=function(t){return x[t]};this.getAvatarList=function(){return x};this.createRoom=function(t,B,L,C){MULTIPLAYER_TEST_LOCAL&&(e.multiplayer.developmentServer="localhost:8184");e.multiplayer.createJoinRoom(t,ROOM_TYPE_USEROWNER,!0,{id:t,pass:B,curusers:1,minutes:L,rules:C},{nickname:r,avatar:""},function(V){b=V;V.addMessageCallback("*",h.messageHandler);V.addDisconnectCallback(y.callbackDisconnect);d[ON_USEROWNERROOM_CREATE_SUCCESS]&&
d[ON_USEROWNERROOM_CREATE_SUCCESS].call(c[ON_USEROWNERROOM_CREATE_SUCCESS]);y._onRoomCreated()},y.callbackError)};this.joinRoom=function(t){w=t;MULTIPLAYER_TEST_LOCAL&&(e.multiplayer.developmentServer="localhost:8184");e.multiplayer.joinRoom(t,{nickname:r,avatar:""},function(B){b=B;B.addMessageCallback("*",h.messageHandler);B.addDisconnectCallback(y.callbackDisconnect);d[ON_USEROWNERROOM_JOIN_SUCCESS]&&d[ON_USEROWNERROOM_JOIN_SUCCESS].call(c[ON_USEROWNERROOM_JOIN_SUCCESS]);y._onRoomJoined()},y.callbackError)};
this.gotoGameRoom=function(t){MULTIPLAYER_TEST_LOCAL&&(e.multiplayer.developmentServer="localhost:8184");playSound("match_found",1,!1);g_oCTLMultiplayer.closeAllDialog();g_oCTLMultiplayer.showLoading(TEXT_MATCH_FOUND.toUpperCase());var B=t.getString(0);k=t.getInt(1);var L=t.getString(2),C=JSON.parse(L);C=Object.values(C);l=t.getInt(3);q=t.getString(4);u=[];x=[];for(t=0;t<C.length;t++)u[t]=C[t].nickname,x[t]=C[t].avatar;m=C.length;e.multiplayer.createJoinRoom(B,ROOM_TYPE_GAME,!0,{minutes:l,rules:q,
pass:"",maxusers:m,playersinfo:L},{ingameid:k},function(V){y.disconnectFromCurRoom();b=V;V.addMessageCallback("*",h.messageHandler);V.addDisconnectCallback(y.callbackDisconnectFromMatch);d[ON_GAMEROOM_CONNECTION_SUCCESS]&&d[ON_GAMEROOM_CONNECTION_SUCCESS].call(c[ON_GAMEROOM_CONNECTION_SUCCESS],m);y._onGameRoomEntered()},y.callbackError)};this.gotoGameRoomWithBot=function(){MULTIPLAYER_TEST_LOCAL&&(e.multiplayer.developmentServer="localhost:8184");var t=randomFloatBetween(1E6,2E6,0)+"";k=0;u=[];u[0]=
r;u[1]=F;x=["",""];e.multiplayer.createJoinRoom(t,ROOM_TYPE_GAME,!0,{pass:"",maxusers:2,bot:!0},{ingameid:k},function(B){y.disconnectFromCurRoom();b=B;B.addMessageCallback("*",h.messageHandler);B.addDisconnectCallback(y.callbackDisconnectFromMatch);g_oCTLMultiplayer.closeAllDialog()},y.callbackError)};this.gotoMatchMakingRoom=function(t,B){MULTIPLAYER_TEST_LOCAL&&(e.multiplayer.developmentServer="localhost:8184");e.multiplayer.createJoinRoom("matchmakingroom"+t+"_"+B,ROOM_TYPE_MATCHMAKING,!0,{minutes:t,
rules:B},{nickname:r,avatar:""},function(L){b=L;L.addMessageCallback("*",h.messageHandler);L.addDisconnectCallback(y.callbackDisconnect);g_oCTLMultiplayer.closeAllDialog();g_oCTLMultiplayer.showVsPanel(TEXT_VS,"s_oNetworkManager._onDisconnectFromARoom")},y.callbackError)};this.onMatchmakingConnectionSucces=function(t,B,L){d[ON_MATCHMAKING_CONNECTION_SUCCESS]&&d[ON_MATCHMAKING_CONNECTION_SUCCESS].call(c[ON_MATCHMAKING_CONNECTION_SUCCESS],[t,B,L])};this._onGameRoomEntered=function(){p=setTimeout(function(){g_oCTLMultiplayer.closeAllDialog();
g_oCTLMultiplayer.showGeneralDialog(TEXT_OPPONENT_LEFT,"s_oNetworkManager.gotoLobby");y.disconnect()},WAITING_PLAYERS_TIMEOUT)};this.onGameStarted=function(){g_oCTLMultiplayer.closeAllDialog();clearTimeout(p)};this.tryCreateUniqueRoom=function(t,B,L,C){y.isAllowedWord(t)?(w=w=s_oNetworkManager._stripHTML(t),v=B,l=L,q=C,g_oCTLMultiplayer.showLoading(TEXT_NETWORK_CONNECTING),e.multiplayer.listRooms(ROOM_TYPE_USEROWNER,{id:t},0,0,y._onUniqueListRoomSearch,y.callbackError)):(g_oCTLMultiplayer.closeAllDialog(),
g_oCTLMultiplayer.showGeneralDialog(TEXT_INVALID_NAME,"g_oCTLMultiplayer.closeAllDialog"))};this._onUniqueListRoomSearch=function(t){0<t.length&&(w+="-"+y._getRandomCodeNumber());y.createRoom(w,v,l,q)};this._onPlayNow=function(){y.sendMsg(MSG_PLAYNOW,"")};this._addBotInRoom=function(){COMBINED_PLAYERS_MODE&&(y.sendMsg(MSG_ADDBOT,y.generateRandomName()+"-bot"),document.querySelector(".ctl-multiplayer-room-add-bot").classList.add("ctl-multiplayer-display-none"),document.querySelector(".ctl-multiplayer-room-remove-bot").classList.add("ctl-multiplayer-display-none"))};
this._removeBotInRoom=function(){COMBINED_PLAYERS_MODE&&(y.sendMsg(MSG_REMOVEBOT,""),document.querySelector(".ctl-multiplayer-room-add-bot").classList.add("ctl-multiplayer-display-none"),document.querySelector(".ctl-multiplayer-room-remove-bot").classList.add("ctl-multiplayer-display-none"))};this.onBotAdded=function(t){COMBINED_PLAYERS_MODE&&(document.querySelector(".ctl-multiplayer-room-add-bot").classList.remove("ctl-multiplayer-display-none"),document.querySelector(".ctl-multiplayer-room-remove-bot").classList.remove("ctl-multiplayer-display-none"))};
this.onBotRemoved=function(t){COMBINED_PLAYERS_MODE&&(0<t?(document.querySelector(".ctl-multiplayer-room-add-bot").classList.remove("ctl-multiplayer-display-none"),document.querySelector(".ctl-multiplayer-room-remove-bot").classList.remove("ctl-multiplayer-display-none")):(document.querySelector(".ctl-multiplayer-room-add-bot").classList.remove("ctl-multiplayer-display-none"),document.querySelector(".ctl-multiplayer-room-remove-bot").classList.add("ctl-multiplayer-display-none")))};this.disconnectFromCurRoom=
function(){b&&(b.removeDisconnectCallback(y.callbackDisconnect),b.disconnect())};this._onDisconnectFromARoom=function(){d[ON_BACK_FROM_A_ROOM]&&d[ON_BACK_FROM_A_ROOM].call(c[ON_BACK_FROM_A_ROOM]);g_oCTLMultiplayer.closeAllDialog();g_oCTLMultiplayer.showLoading(TEXT_CONNECT_TO_LOBBY);y.disconnectFromCurRoom();setTimeout(function(){y.gotoLobby()},500)};this.inviteLink=function(){var t=Base64.encode(w),B=Base64.encode(v);return window.location.href+"?"+PARAM_ROOM_ID+"="+t+"&"+PARAM_PASSWORD+"="+B};this._onClickInvite=
function(){};this._onRoomCreated=function(){var t={id:"playnow",func:"s_oNetworkManager._onPlayNow",label:TEXT_PLAY_NOW,classes:"ctl-multiplayer-room-play-now ctl-multiplayer-display-none"},B={id:"back",func:"s_oNetworkManager._onDisconnectFromARoom",label:TEXT_SYS_BACK},L={id:"addbot",func:"s_oNetworkManager._addBotInRoom",label:TEXT_SYS_ADD_BOT,classes:"ctl-multiplayer-room-add-bot ctl-multiplayer-display-block"},C={id:"removebot",func:"s_oNetworkManager._removeBotInRoom",label:TEXT_SYS_REMOVE_BOT,
classes:"ctl-multiplayer-room-remove-bot ctl-multiplayer-display-none"},V={id:"invite",func:"s_oNetworkManager._onClickInvite",label:TEXT_SYS_INVITE,classes:"ctl-multiplayer-room-invite"},ba=y.inviteLink();t=[t,B,V];COMBINED_PLAYERS_MODE&&t.push(L,C);g_oCTLMultiplayer.closeAllDialog();g_oCTLMultiplayer.showWaitingPlayersInRoom(TEXT_WAITING_FOR_PLAYERS_IN_ROOM+w,[r],t,ba);tippy("#link",{content:TEXT_SYS_COPIED_TO_CLIPBOARD,trigger:"click",duration:100});tippy("#invite",{content:TEXT_SYS_COPIED_TO_CLIPBOARD,
trigger:"click",duration:100});new ClipboardJS(".ctl-multiplayer-room-invite");new ClipboardJS(".ctl-multiplayer-room-link")};this._onRoomJoined=function(){g_oCTLMultiplayer.closeAllDialog();g_oCTLMultiplayer.showWaitingPlayersInRoom(TEXT_WAITING_FOR_PLAYERS_IN_ROOM+w,[],[{func:"s_oNetworkManager._onDisconnectFromARoom",label:TEXT_SYS_BACK}])};this.gotoLobby=function(){g_oCTLMultiplayer.closeAllDialog();g_oCTLMultiplayer.showLoading(TEXT_CONNECT_TO_LOBBY);y.refreshRooms()};this.refreshRooms=function(){e.multiplayer.listRooms(ROOM_TYPE_USEROWNER,
null,0,0,y._onFillWithOwnerRoom,y.callbackError);e.multiplayer.listRooms(ROOM_TYPE_GAME,null,0,0,y._onFillWithGameRoom,y.callbackError)};this._onFillWithOwnerRoom=function(t){n++;y._extractOwnerRoomInfo(t);2<=n&&y._onFinalUpdateRoomList()};this._onFillWithGameRoom=function(t){n++;y._extractGameRoomInfo(t);2<=n&&y._onFinalUpdateRoomList()};this._onFinalUpdateRoomList=function(){var t=y._getCombinedRoomsLists();null!==document.querySelector(".ctl-multiplayer-room-list")?g_oCTLMultiplayer.refreshRoomList(t):
this._showLobby(t);t="300px";s_bMobile&&(t="200px");document.querySelector(".ctl-multiplayer-room-list").style.maxHeight=t};this._showLobby=function(t){n=0;g_oCTLMultiplayer.closeAllDialog();g_oCTLMultiplayer.showRoomList(t)};this._extractOwnerRoomInfo=function(t){f=[];for(var B=0;B<t.length;B++){var L=0===t[B].roomData.pass.length?!1:!0,C=s_oNetworkManager._stripHTML(t[B].id);f[B]={name:C,"private":L,accessible:!0,minutes:t[B].roomData.minutes,rules:t[B].roomData.rules}}return f};this._extractGameRoomInfo=
function(t){g=[];for(var B=0;B<t.length;B++){var L=0===t[B].roomData.pass.length?!1:!0,C=s_oNetworkManager._stripHTML(t[B].id);g[B]={name:"game-"+C,"private":L,accessible:!1,minutes:t[B].roomData.minutes,rules:t[B].roomData.rules}}return g};this._getCombinedRoomsLists=function(){for(var t=[],B=0;B<f.length;B++)g_oCTLMultiplayer.getRuleTag()===f[B].rules&&t.push(f[B]);for(B=0;B<g.length;B++)g_oCTLMultiplayer.getRuleTag()===g[B].rules&&t.push(g[B]);return t};this.joinQuickMatch=function(t,B){g_oCTLMultiplayer.showLoading(TEXT_NETWORK_CONNECTING);
y.gotoMatchMakingRoom(t,B)};this.tryJoinFromInvitation=function(t,B){w=Base64.decode(t);v=Base64.decode(B);e.multiplayer.listRooms(ROOM_TYPE_USEROWNER,{id:w,pass:v},0,0,y._checkRoomAvailableFromInvitation,y.callbackError)};this._checkRoomAvailableFromInvitation=function(t){0<t.length?y.joinRoom(t[0].roomData.id,t[0].roomData.pass):(g_oCTLMultiplayer.closeAllDialog(),g_oCTLMultiplayer.showGeneralDialog(TEXT_ROOM_IS_EXPIRED,"s_oNetworkManager.gotoLobby"))};this.tryJoinRoomWithPass=function(t,B){g_oCTLMultiplayer.closeAllDialog();
g_oCTLMultiplayer.showLoading(TEXT_NETWORK_CONNECTING);w=t;v=B;e.multiplayer.listRooms(ROOM_TYPE_USEROWNER,{id:t,pass:B},0,0,y._checkUserPermissionToJoin,y.callbackError)};this._checkUserPermissionToJoin=function(t){0<t.length?y.joinRoom(t[0].roomData.id,t[0].roomData.pass):(g_oCTLMultiplayer.closeAllDialog(),g_oCTLMultiplayer.showGeneralDialog(TEXT_WRONG_PASSWORD,"s_oNetworkManager._onPasswordFailed"))};this._onPasswordFailed=function(){g_oCTLMultiplayer.closeAllDialog();g_oCTLMultiplayer.showTypeRoomPassword(w)};
this.filterRoomsShown=function(t){var B=y._getCombinedRoomsLists();t=t.toLowerCase();for(var L=[],C=0;C<B.length;C++){var V=B[C].name.toLowerCase();void 0!==V&&V.includes(t)&&L.push(B[C])}0<t.length?g_oCTLMultiplayer.refreshRoomList(L):g_oCTLMultiplayer.refreshRoomList(B)};this._init()}
var MSG_ROOM_UPDATE="room_update",MSG_ROOM_IS_FULL="room_is_full",MSG_ROOM_EXPIRED="room_expired",MSG_MATCHMAKING_CONNECTION_SUCCESS="matchmaking_connection_success",MSG_GAME_FOUND="game_found",MSG_PLAYER_LEFT_GAME="player_left_game",MSG_REMATCH_PANEL="rematch_panel",MSG_REMATCH_ANSWER_RESULTS="rematch_answer_results",MSG_OPPONENT_MOVES="opponent_moves",MSG_NOTIFY_ACCEPT_REMATCH="notify_accept_rematch",MSG_START_THE_GAME="start_the_game",MSG_BOT_ADDED="bot_added",MSG_BOT_REMOVED="bot_removed",MSG_END_MATCH=
"end_match",MSG_ACCEPT_REMATCH="accept_rematch",MSG_DISCONNECTION="disconnection",MSG_MOVE="move",MSG_PLAYNOW="play_now",MSG_ADDBOT="add_bot",MSG_REMOVEBOT="remove_bot",MSG_PING="ping",MSG_DRAW_STATE="draw_state",MSG_SURRENDER="surrender",MSG_REFLECT_SURRENDER="reflect_surrender";
function CNetworkMessageForwarder(){this._init=function(){};this.messageHandler=function(d){switch(d.type){case MSG_ROOM_UPDATE:a._onUpdateRoom(d);break;case MSG_ROOM_IS_FULL:a._onFullRoom(d);break;case MSG_ROOM_EXPIRED:a._onExpiredRoom(d);break;case MSG_MATCHMAKING_CONNECTION_SUCCESS:a._onMatchmakingConnectionSuccess(d);break;case MSG_GAME_FOUND:a._onGameFound(d);break;case MSG_PLAYER_LEFT_GAME:a._onPlayerLeft(d);break;case MSG_REMATCH_PANEL:a._onRematchPanel(d);break;case MSG_REMATCH_ANSWER_RESULTS:a._onRematchResults(d);
break;case MSG_OPPONENT_MOVES:a._onEnemyMoves(d);break;case MSG_DRAW_STATE:a._onDrawState(d);break;case MSG_NOTIFY_ACCEPT_REMATCH:a._onNotifyAcceptRematch(d);break;case MSG_SURRENDER:a._onSurrender(d);break;case MSG_START_THE_GAME:a._onGameStart(d);break;case MSG_BOT_ADDED:a._onBotAdded(d);break;case MSG_BOT_REMOVED:a._onBotRemoved(d);break;case MSG_PING:a._onPingReceived(d)}};this._onUpdateRoom=function(d){};this._onFullRoom=function(){g_oCTLMultiplayer.closeAllDialog();g_oCTLMultiplayer.showGeneralDialog(TEXT_ROOM_IS_FULL,
"s_oNetworkManager.gotoLobby")};this._onExpiredRoom=function(){s_oNetworkManager.disconnectFromCurRoom();g_oCTLMultiplayer.closeAllDialog();g_oCTLMultiplayer.showGeneralDialog(TEXT_ROOM_IS_EXPIRED,"s_oNetworkManager.gotoLobby")};this._onMatchmakingConnectionSuccess=function(d){var c=d.getInt(0);c=JSON.parse(c);var f=d.getString(1);d=d.getInt(2);d=JSON.parse(d);s_oNetworkManager.onMatchmakingConnectionSucces(c,f,d)};this._onGameFound=function(d){var c=0==d.getInt(1)?1:0,f=d.getString(2);f=JSON.parse(f);
f=Object.values(f);g_oCTLMultiplayer.onPlayerFound(f[c].nickname);setTimeout(function(){s_oNetworkManager.gotoGameRoom(d)},1500)};this._onGameStart=function(d){d=d.getString(0);var c=JSON.parse(d);d=parseInt(c.minutes);c=c.rules;if(s_oMenu)s_oMenu.onRemoteGameStart(d,c);s_oNetworkManager.onGameStarted()};this._onBotAdded=function(d){d=d.getInt(0);d=parseInt(JSON.parse(d));s_oNetworkManager.onBotAdded(d)};this._onBotRemoved=function(d){d=d.getInt(0);d=parseInt(JSON.parse(d));s_oNetworkManager.onBotRemoved(d)};
this._onPingReceived=function(d){var c=d.getInt(1);console.log(c);s_oNetworkManager.sendMsg(MSG_PING,JSON.stringify(d.getLong(0)))};this._onPlayerLeft=function(d){s_oGame&&s_oGame.opponentLeftTheGame()};this._onRematchPanel=function(d){var c=d.getString(0),f=d.getString(1),g=d.getLong(2);d=d.getLong(3);if(s_oGame)switch(s_oGame.updateTimeFromServer(g,d),c){case SURRENDER:s_oGame.showRematchPanel(f,c);break;case DRAW:s_oGame.showRematchPanel(f);break;case DRAW_AGREED:s_oGame.showRematchPanel(c);break;
case TIME_OVER:s_oGame.showRematchPanel(c);break;default:s_oGame.showRematchPanel(f)}};this._onRematchResults=function(d){d=d.getBoolean(0);if(s_oGame)if(d)s_oGame.onOpponentAcceptRematch();else s_oGame.onOpponentRefuseRematch()};this._onEnemyMoves=function(d){var c=d.getString(0);c=JSON.parse(c);var f=d.getLong(1);d=d.getLong(2);s_oGame&&(s_oGame.getCurPlayer()===WHITE?d-=s_oGame.getAnimTime():f-=s_oGame.getAnimTime(),s_oGame.updateTimeFromServer(f,d),s_oGame.remoteMovePiece(c[MSG_MOVE]))};this._onDrawState=
function(d){d=d.getBoolean(0);if(s_oGame)s_oGame.onOpponentDraw(d)};this._onNotifyAcceptRematch=function(){if(s_oGame)s_oGame.onNotifyAcceptRematch()};this._onSurrender=function(d){d=d.getString(0);s_oNetworkManager.sendMsg(MSG_REFLECT_SURRENDER,d)};var a=this;this._init()}function on_ctl_multiplayer_send_nickname(){var a=document.querySelector("input[name='nickname']").value;g_oCTLMultiplayer.setNickName(a);s_oNetworkManager.login(a)}
function on_ctl_multiplayer_send_password(){var a=document.querySelector("[id='"+g_oCTLMultiplayer._idCurDialog+"']").querySelector("input[name='password']"),d=a.getAttribute("data-room-name");s_oNetworkManager.tryJoinRoomWithPass(d,a.value)}function on_ctl_multiplayer_join_room_with_password(){g_oCTLMultiplayer.closeAllDialog();g_oCTLMultiplayer.showLoading(TEXT_NETWORK_CONNECTING)}
function on_ctl_multiplayer_show_create_match(){g_oCTLMultiplayer.closeAllDialog();g_oCTLMultiplayer.showCreateRoom()}function on_ctl_multiplayer_join_quick_match(){g_oCTLMultiplayer.closeAllDialog();var a=MATCH_MINUTES_TYPE[0],d=g_oCTLMultiplayer.getRuleTag();s_oNetworkManager.joinQuickMatch(a,d)}
function on_ctl_multiplayer_join_quick_match_time(){g_oCTLMultiplayer.closeAllDialog();var a=g_oCTLMultiplayer.getRuleTag();s_oNetworkManager.joinQuickMatch(RULE_PRESET[a].meta.suggested_quickmatch_time,a)}function on_ctl_multiplayer_close_type_room_password(){g_oCTLMultiplayer.closeAllDialog();s_oNetworkManager.gotoLobby()}function on_ctl_multiplayer_close_create_room(){g_oCTLMultiplayer.closeAllDialog();s_oNetworkManager.gotoLobby()}
function on_ctl_multiplayer_refresh_room_list(){s_oNetworkManager.gotoLobby()}function on_ctl_multiplayer_create_room(){var a=document.querySelector("input[name='roomname']").value,d=document.querySelector("input[name='password']").value,c=document.querySelector("input[name='minutes']:checked").value,f=g_oCTLMultiplayer.getRuleTag();s_oNetworkManager.tryCreateUniqueRoom(a,d,c,f)}function on_ctl_multiplayer_join_room(a){s_oNetworkManager.joinRoom(a)}
function on_room_search(a){s_oNetworkManager.filterRoomsShown(a)}var LANG_WIDTH=109,LANG_HEIGHT=109;
function CButLang(a,d,c,f,g,b){var e=f,h,k,l,m,n,p;this._init=function(q,r,u,x){h=[];k=[];p=new createjs.Container;p.x=q;p.y=r;m=p.on("mousedown",this._onPress,this);l=p.on("click",this._onChangeLang,this);b.addChild(p);q={};for(r=0;r<u;r++)q["lang_"+r]=r;u=new createjs.SpriteSheet({images:[x],frames:{width:LANG_WIDTH,height:LANG_HEIGHT},animations:q});n=createSprite(u,"lang_"+e,0,0,LANG_WIDTH,LANG_HEIGHT);p.addChild(n);p.regX=LANG_WIDTH/2;p.regY=LANG_HEIGHT/2};this.unload=function(){p.off("mousedown",
m);p.off("click",l)};this.addEventListener=function(q,r,u){h[q]=r;k[q]=u};this.setPosition=function(q,r){p.x=q;p.y=r};this.setLang=function(q){e=q;n.gotoAndStop("lang_"+e)};this._onPress=function(){p.scale=.9};this._onChangeLang=function(){p.scale=1;h[ON_SELECT_LANG]&&h[ON_SELECT_LANG].call(k[ON_SELECT_LANG],e)};this.getButtonImage=function(){return p};this._init(a,d,c,g)}
function CRadialWipeWidget(a,d,c){var f,g,b,e,h,k,l;this._init=function(m,n,p){g=f=!1;b=0;l=new createjs.Container;l.x=m;l.y=n;p.addChild(l);e=createjs.Graphics.getRGB(13211971);h=new createjs.Shape;h.rotation=-90;h.alpha=1;l.addChild(h);k=new createjs.Text(""," 60px "+PRIMARY_FONT,"#ffffff");k.textAlign="center";k.textBaseline="alphabetic";k.y=20;k.shadow=new createjs.Shadow("#000000",5,5,10);l.addChild(k)};this.unload=function(){c.removeChild(l)};this.setPos=function(m,n){l.x=m;l.y=n};this.reset=
function(){k.text="";stopSound("hurryup");k.color="#ffffff"};this.setVisible=function(m){l.visible=m};this.setScale=function(m){l.scaleX=l.scaleY=m};this.setHurryUpMode=function(m){f=!0;b=m};this.removeHurryUpMode=function(){f=!1};this._showHurryUpWarning=function(){playSound("hurryup",1,!1)};this.alwaysShown=function(){g=!0};this._updateTimeText=function(m){k.text=Math.ceil(m/1E3)};this._updateRadialWipe=function(m,n){g||(n=b);var p=linearFunction(m,n,0,0,360);h.graphics.clear();h.graphics.f(e);
h.graphics.moveTo(0,0);h.graphics.arc(0,0,TIME_CONTROLLER_RADIUS,0,degreesToRadians(p),!0)};this.update=function(m,n){this._updateTimeText(m);this._updateRadialWipe(m,n);if(0===m||m>b&&!g)k.text="",h.graphics.clear();f&&m<b&&(f=!1,this._showHurryUpWarning())};this._init(a,d,c)}
function CTremble(a,d,c,f){var g,b,e,h,k,l,m;this._init=function(p,q,r,u){h=e=!1;l=0;this._calculateDuration();g=p.x;b=p.y;e||(e=!0,k=setInterval(function(){n._tremble()},r))};this._tremble=function(){if(h=!h){var p=.5>Math.random()?-f:f;var q=.5>Math.random()?-f:f;a.x+=p;a.y+=q}else a.x=g,a.y=b;l++;l>m&&(l=0,e=!1,a.x=g,a.y=b,0===d?k=setInterval(function(){n._tremble()},c):clearInterval(k))};this._calculateDuration=function(){m=d/c};this.stopTremble=function(){clearInterval(k)};var n=this;this._init(a,
d,c,f)}
function CVector2(a,d){var c,f;this._init=function(g,b){c=g;f=b};this.add=function(g,b){c+=g;f+=b};this.addV=function(g){c+=g.getX();f+=g.getY()};this.scalarDivision=function(g){c/=g;f/=g};this.subV=function(g){c-=g.getX();f-=g.getY()};this.scalarProduct=function(g){c*=g;f*=g};this.invert=function(){c*=-1;f*=-1};this.dotProduct=function(g){return c*g.getX()+f*g.getY()};this.set=function(g,b){c=g;f=b};this.setV=function(g){c=g.getX();f=g.getY()};this.length=function(){return Math.sqrt(c*c+f*f)};this.length2=
function(){return c*c+f*f};this.normalize=function(){var g=this.length();0<g&&(c/=g,f/=g)};this.getNormalize=function(g){this.length();g.set(c,f);g.normalize()};this.rot90CCW=function(){var g=c;c=-f;f=g};this.rot90CW=function(){var g=c;c=f;f=-g};this.getRotCCW=function(g){g.set(c,f);g.rot90CCW()};this.getRotCW=function(g){g.set(c,f);g.rot90CW()};this.ceil=function(){c=Math.ceil(c);f=Math.ceil(f)};this.round=function(){c=Math.round(c);f=Math.round(f)};this.toString=function(){return"Vector2: "+c+", "+
f};this.print=function(){trace("Vector2: "+c+", "+f)};this.getX=function(){return c};this.getY=function(){return f};this._init(a,d)}
function CAlertIcon(a,d,c,f){var g,b;this._init=function(e,h,k,l){b=l;g=new createjs.Container;g.x=e;g.y=h;b.addChild(g);e=s_oSpriteLibrary.getSprite("icon_notify");h=createBitmap(e);g.addChild(h);new CTLText(g,0,0,e.width,e.height,40,"center","#fff",PRIMARY_FONT,1,0,0,k,!0,!0,!1,!1);g.regX=e.width/2;g.regY=e.height/2};this.unload=function(){b.removeChild(g)};this.pulseAnimation=function(){createjs.Tween.get(g,{loop:!0}).to({scaleX:.8,scaleY:.8},850,createjs.Ease.quadOut).to({scaleX:1,scaleY:1},650,
createjs.Ease.quadIn)};this._init(a,d,c,f)}
function CTreeDecision(a){var d,c,f;this._init=function(g){d=[];for(var b=0;b<SEARCH_DEPTH+1;b++)d[b]=[];c=new TreeModel;f=c.parse(g);d[0][0]=f};this.getRoot=function(){return f};this.initNewNode=function(g){d[g].push(c.parse({rating:0,moves:[],depth:g}));return d[g][d[g].length-1]};this.addNode=function(g,b,e,h){h=g+1;var k=d[h].length-1;d[h][k].model.moves=e;d[h][k].model.rating=b;d[g][d[g].length-1].addChild(d[h][k])};this.rateNode=function(g,b){g.model.rating=b};this.getNode=function(g,b){return f.all(function(e){return e.model.rating===
g&&e.model.depth===b})};this.getAllNodeByDepth=function(g){return f.all(function(b){return b.model.depth===g})};this.getPath=function(g){return g.getPath()};this.getTerminalNodes=function(){return f.all(function(g){return!g.hasChildren()})};this._init(a)}
var CANVAS_WIDTH=1920,CANVAS_HEIGHT=1920,CANVAS_WIDTH_HALF=CANVAS_WIDTH/2,CANVAS_HEIGHT_HALF=CANVAS_HEIGHT/2,EDGEBOARD_X=530,EDGEBOARD_Y=530,FPS=60,FPS_TIME=1E3/FPS,DISABLE_SOUND_MOBILE=!1,GAME_ORIENTATION="portrait",MANDATORY_JUMP_ACTIVE=!1,TIME_PER_MOVE=3E4,TIME_HURRYUP_WARNING=1E4,GAME_PLAYERIO_ID="master-checkers-new-baozbv63ea0y5vcunaqkw",GAME_NAME="master_checkers",MULTIPLAYER_TEST_LOCAL=!1,COMBINED_PLAYERS_MODE=!1,PRIMARY_FONT="RoundedMplus1c",SECONDARY_FONT="ArialRounded",FONT_COLOR="#402604",
STATE_LOADING=0,STATE_MENU=1,STATE_HELP=1,STATE_GAME=3,ON_MOUSE_DOWN=0,ON_MOUSE_UP=1,ON_MOUSE_OVER=2,ON_MOUSE_OUT=3,ON_DRAG_START=4,ON_DRAG_END=5,ON_SELECT_LANG=6,ON_TIMER_END=7,ON_LAST_TIMER_END=8,ON_END_AI_COMPUTATION=15,ON_EXIT_RULE_PANEL=16,MODE_HUMAN=0,MODE_COMPUTER=1,EASY_MODE=0,MEDIUM_MODE=1,HARD_MODE=2,NUM_CELL_REFERENCE=8,BOARD_SIZE_REFERENCE=820,CELL_SIZE_REFERENCE=BOARD_SIZE_REFERENCE/NUM_CELL_REFERENCE,BG_BLACK=0,BG_WHITE=1,DRAW="draw",WIN_WHITE_BLACK_NOMOVES="win_white_black_nomoves",
WIN_BLACK_WHITE_NOMOVES="win_black_white_nomoves",TIME_OVER="time_over",DRAW_AGREED="draw_agreed",SURRENDER="surrender",TOP="top",BOTTOM="bottom",PAWN="pawn",KING="king",WHITE="white",BLACK="black",PAWN_STOP=-1,PAWN_MOVE=0,PAWN_EAT=1,PLAYER_STATE_WAIT=0,PLAYER_STATE_SELECTED=1,PLAYER_STATE_PATH_CHOSEN=2,PLAYER_STATE_MOVING=3,ALERT_TYPE_NOMOVES=0,ALERT_TYPE_STALL=1,PAWN_SIZE=100,MATCH_MINUTES_TYPE=[0,3,5,10],MATCH_MINUTES_DEFAULT_INDEX=2,ANIM_TIME_MOVE_TYPE=[500,150,500,500];
TIME_PER_MOVE=[9E4,6E4,9E4,9E4];TIME_HURRYUP_WARNING=[25E3,15E3,2E4,25E3];var TIME_CONTROLLER_RADIUS=50,NUM_ATTEMPT=0,DRAW_BUTTON_MAX_NUM_ASK=6,TIME_TO_WAIT_DRAW_ENABLED_AGAIN=[1E4,3E4,6E4];ON_TIMER_END=0;ON_LAST_TIMER_END=1;
var TIME_LOOP_WAIT=1E3,MIN_AI_THINKING=1E3,MAX_AI_THINKING=1500,INFINITE=99999,SEARCH_DEPTH=4,DRAW_COUNTER=40,START_SCORE,SCORE_DECREASE_PER_SECOND,SHOW_SCORE,ENABLE_CHECK_ORIENTATION,ENABLE_FULLSCREEN,DEFAULT_RULE_FLAG=2,NUM_LANGUAGES=13,LANG_EN=0,LANG_RU=1,LANG_ES=2,LANG_FR=3,LANG_DE=4,LANG_PT=5,LANG_IT=6,LANG_AR=7,LANG_HI=8,LANG_TR=9,LANG_ID=10,LANG_JA=11,LANG_ZH=12,LANG_CODES={};LANG_CODES.en=LANG_EN;LANG_CODES.ru=LANG_RU;LANG_CODES.es=LANG_ES;LANG_CODES.fr=LANG_FR;LANG_CODES.de=LANG_DE;
LANG_CODES.pt=LANG_PT;LANG_CODES.it=LANG_IT;LANG_CODES.ar=LANG_AR;LANG_CODES.hi=LANG_HI;LANG_CODES.tr=LANG_TR;LANG_CODES.id=LANG_ID;LANG_CODES.ja=LANG_JA;LANG_CODES.zh=LANG_ZH;LANG_CODES.be=LANG_RU;LANG_CODES.kk=LANG_RU;LANG_CODES.uk=LANG_RU;LANG_CODES.uz=LANG_RU;
var PARAM_ROOM_ID="roomid",PARAM_PASSWORD="pwd",PARAM_GAMETYPE="gametype",HTTPS_FORMAT="https://%s/",CODETHISLAB_LINK_COM="www.codethislab.com",CODETHISLAB_LINK_IT="www.codethislab.it",CODETHISLAB_LINK=CODETHISLAB_LINK_COM,RULE_INTERNATIONAL="rule_international",RULE_ENGLISH="rule_english",RULE_ITALIAN="rule_italian",RULE_SPANISH="rule_spanish",RULE_TURKISH="rule_turkish",RULE_CANADIAN="rule_canadian",RULE_BRAZILIAN="rule_brazilian",RULE_RUSSIAN="rule_russian",RULE_TEST="rule_test",RULES_ORDER=[RULE_INTERNATIONAL,
RULE_ENGLISH,RULE_ITALIAN,RULE_SPANISH,RULE_TURKISH,RULE_CANADIAN,RULE_BRAZILIAN,RULE_RUSSIAN],WP={color:WHITE,type:PAWN},WK={color:WHITE,type:KING},BP={color:BLACK,type:PAWN},BK={color:BLACK,type:KING},RULE_PRESET={},KING_MOVEMENT_SINGLE="single",KING_MOVEMENT_FLY="fly",KING_MOVEMENT_FLY_BLOCK="fly_block",KING_MOVE_ORDER=[KING_MOVEMENT_SINGLE,KING_MOVEMENT_FLY,KING_MOVEMENT_FLY_BLOCK],MOVEMENT_HORIZONTAL="movement_horizontal",MOVEMENT_DIAGONAL="movement_diagonal";
RULE_PRESET[RULE_TEST]={denom:"",notes:"",origin_cell_color:WHITE,starting_board:[[BP,null,BP,null,BP,null,null,null],[null,BP,null,null,null,BP,null,null],[BP,null,BP,null,null,null,BP,null],[null,null,null,null,null,WK,null,null],[null,null,null,null,null,BP,null,null],[null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null],[null,null,null,null,null,WP,null,WP]],starting_player:WHITE,movement:MOVEMENT_HORIZONTAL,capture_rule:{mandatory:!1,maximize:!0,king_first:!0,king_protected:!0,
back:!0},king_movement:KING_MOVEMENT_FLY,pawn_can_continue_as_king:!0};
RULE_PRESET[RULE_INTERNATIONAL]={id:RULE_INTERNATIONAL,meta:{denom:TEXT_RULE_INTERNATIONAL,notes:TEXT_RULE_NOTE_INTERNATIONAL,suggested_quickmatch_time:MATCH_MINUTES_TYPE[3]},origin_cell_color:WHITE,starting_board:[[null,BP,null,BP,null,BP,null,BP,null,BP],[BP,null,BP,null,BP,null,BP,null,BP,null],[null,BP,null,BP,null,BP,null,BP,null,BP],[BP,null,BP,null,BP,null,BP,null,BP,null],[null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null],[null,WP,null,
WP,null,WP,null,WP,null,WP],[WP,null,WP,null,WP,null,WP,null,WP,null],[null,WP,null,WP,null,WP,null,WP,null,WP],[WP,null,WP,null,WP,null,WP,null,WP,null]],starting_player:WHITE,movement:MOVEMENT_DIAGONAL,capture_rule:{mandatory:!0,maximize:!0,king_first:!0,king_protected:!1,back:!0},king_movement:KING_MOVEMENT_FLY,pawn_can_continue_as_king:!1};
RULE_PRESET[RULE_ENGLISH]={id:RULE_ENGLISH,meta:{denom:TEXT_RULE_ENGLISH,notes:"",suggested_quickmatch_time:MATCH_MINUTES_TYPE[MATCH_MINUTES_DEFAULT_INDEX]},origin_cell_color:WHITE,starting_board:[[null,BP,null,BP,null,BP,null,BP],[BP,null,BP,null,BP,null,BP,null],[null,BP,null,BP,null,BP,null,BP],[null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null],[WP,null,WP,null,WP,null,WP,null],[null,WP,null,WP,null,WP,null,WP],[WP,null,WP,null,WP,null,WP,null]],starting_player:BLACK,
movement:MOVEMENT_DIAGONAL,capture_rule:{mandatory:!0,maximize:!1,king_first:!1,king_protected:!1,back:!1},king_movement:KING_MOVEMENT_SINGLE,pawn_can_continue_as_king:!1};
RULE_PRESET[RULE_ITALIAN]={id:RULE_ITALIAN,meta:{denom:TEXT_RULE_ITALIAN,notes:"",suggested_quickmatch_time:MATCH_MINUTES_TYPE[MATCH_MINUTES_DEFAULT_INDEX]},origin_cell_color:BLACK,starting_board:[[BP,null,BP,null,BP,null,BP,null],[null,BP,null,BP,null,BP,null,BP],[BP,null,BP,null,BP,null,BP,null],[null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null],[null,WP,null,WP,null,WP,null,WP],[WP,null,WP,null,WP,null,WP,null],[null,WP,null,WP,null,WP,null,WP]],starting_player:WHITE,
movement:MOVEMENT_DIAGONAL,capture_rule:{mandatory:!0,maximize:!0,king_first:!0,king_protected:!0,back:!1},king_movement:KING_MOVEMENT_SINGLE,pawn_can_continue_as_king:!1};
RULE_PRESET[RULE_SPANISH]={id:RULE_SPANISH,meta:{denom:TEXT_RULE_SPANISH,notes:"",suggested_quickmatch_time:MATCH_MINUTES_TYPE[MATCH_MINUTES_DEFAULT_INDEX]},origin_cell_color:BLACK,starting_board:[[BP,null,BP,null,BP,null,BP,null],[null,BP,null,BP,null,BP,null,BP],[BP,null,BP,null,BP,null,BP,null],[null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null],[null,WP,null,WP,null,WP,null,WP],[WP,null,WP,null,WP,null,WP,null],[null,WP,null,WP,null,WP,null,WP]],starting_player:WHITE,
movement:MOVEMENT_DIAGONAL,capture_rule:{mandatory:!0,maximize:!0,king_first:!1,king_protected:!0,back:!1},king_movement:KING_MOVEMENT_FLY,pawn_can_continue_as_king:!1};
RULE_PRESET[RULE_TURKISH]={id:RULE_TURKISH,meta:{denom:TEXT_RULE_TURKISH,notes:"",suggested_quickmatch_time:MATCH_MINUTES_TYPE[MATCH_MINUTES_DEFAULT_INDEX]},origin_cell_color:BLACK,starting_board:[[null,null,null,null,null,null,null,null],[BP,BP,BP,BP,BP,BP,BP,BP],[BP,BP,BP,BP,BP,BP,BP,BP],[null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null],[WP,WP,WP,WP,WP,WP,WP,WP],[WP,WP,WP,WP,WP,WP,WP,WP],[null,null,null,null,null,null,null,null]],starting_player:WHITE,movement:MOVEMENT_HORIZONTAL,
capture_rule:{mandatory:!0,maximize:!0,king_first:!1,king_protected:!1,back:!1},king_movement:KING_MOVEMENT_FLY,pawn_can_continue_as_king:!1};
RULE_PRESET[RULE_CANADIAN]={id:RULE_CANADIAN,meta:{denom:TEXT_RULE_CANADIAN,notes:"",suggested_quickmatch_time:MATCH_MINUTES_TYPE[3]},origin_cell_color:WHITE,starting_board:[[null,BP,null,BP,null,BP,null,BP,null,BP,null,BP],[BP,null,BP,null,BP,null,BP,null,BP,null,BP,null],[null,BP,null,BP,null,BP,null,BP,null,BP,null,BP],[BP,null,BP,null,BP,null,BP,null,BP,null,BP,null],[null,BP,null,BP,null,BP,null,BP,null,BP,null,BP],[null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,
null,null,null,null,null,null,null,null,null],[WP,null,WP,null,WP,null,WP,null,WP,null,WP,null],[null,WP,null,WP,null,WP,null,WP,null,WP,null,WP],[WP,null,WP,null,WP,null,WP,null,WP,null,WP,null],[null,WP,null,WP,null,WP,null,WP,null,WP,null,WP],[WP,null,WP,null,WP,null,WP,null,WP,null,WP,null]],starting_player:WHITE,movement:MOVEMENT_DIAGONAL,capture_rule:{mandatory:!0,maximize:!0,king_first:!0,king_protected:!1,back:!0},king_movement:KING_MOVEMENT_FLY,pawn_can_continue_as_king:!1};
RULE_PRESET[RULE_BRAZILIAN]={id:RULE_BRAZILIAN,meta:{denom:TEXT_RULE_BRAZILIAN,notes:"",suggested_quickmatch_time:MATCH_MINUTES_TYPE[MATCH_MINUTES_DEFAULT_INDEX]},origin_cell_color:WHITE,starting_board:[[null,BP,null,BP,null,BP,null,BP],[BP,null,BP,null,BP,null,BP,null],[null,BP,null,BP,null,BP,null,BP],[null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null],[WP,null,WP,null,WP,null,WP,null],[null,WP,null,WP,null,WP,null,WP],[WP,null,WP,null,WP,null,WP,null]],starting_player:WHITE,
movement:MOVEMENT_DIAGONAL,capture_rule:{mandatory:!0,maximize:!0,king_first:!0,king_protected:!1,back:!0},king_movement:KING_MOVEMENT_FLY,pawn_can_continue_as_king:!1};
RULE_PRESET[RULE_RUSSIAN]={id:RULE_RUSSIAN,meta:{denom:TEXT_RULE_RUSSIAN,notes:TEXT_RULE_NOTE_RUSSIAN,suggested_quickmatch_time:MATCH_MINUTES_TYPE[MATCH_MINUTES_DEFAULT_INDEX]},origin_cell_color:WHITE,starting_board:[[null,BP,null,BP,null,BP,null,BP],[BP,null,BP,null,BP,null,BP,null],[null,BP,null,BP,null,BP,null,BP],[null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null],[WP,null,WP,null,WP,null,WP,null],[null,WP,null,WP,null,WP,null,WP],[WP,null,WP,null,WP,null,WP,null]],
starting_player:WHITE,movement:MOVEMENT_DIAGONAL,capture_rule:{mandatory:!0,maximize:!0,king_first:!0,king_protected:!1,back:!0},king_movement:KING_MOVEMENT_FLY,pawn_can_continue_as_king:!0};
function refreshPresetsText(){RULE_PRESET[RULE_INTERNATIONAL].meta.denom=TEXT_RULE_INTERNATIONAL;RULE_PRESET[RULE_ENGLISH].meta.denom=TEXT_RULE_ENGLISH;RULE_PRESET[RULE_ITALIAN].meta.denom=TEXT_RULE_ITALIAN;RULE_PRESET[RULE_SPANISH].meta.denom=TEXT_RULE_SPANISH;RULE_PRESET[RULE_TURKISH].meta.denom=TEXT_RULE_TURKISH;RULE_PRESET[RULE_CANADIAN].meta.denom=TEXT_RULE_CANADIAN;RULE_PRESET[RULE_BRAZILIAN].meta.denom=TEXT_RULE_BRAZILIAN;RULE_PRESET[RULE_RUSSIAN].meta.denom=TEXT_RULE_RUSSIAN;RULE_PRESET[RULE_INTERNATIONAL].meta.notes=
TEXT_RULE_NOTE_INTERNATIONAL;RULE_PRESET[RULE_RUSSIAN].meta.notes=TEXT_RULE_NOTE_RUSSIAN}var LATIN_ALPHABET="ABCDEFGHIJKLMNOPQRSTUVWXYZ".split(""),BOARD_PRESET=[{white_tile:"#f4be55",black_tile:"#552916",frame:"#f4be55",white_pawn:"#dbbb60",black_pawn:"#424242",letters_color:"#482c13",coords:LATIN_ALPHABET,path_colors:"rgb(75, 192, 192);rgb(54, 162, 235);rgb(153, 102, 255);rgb(201, 203, 207);rgb(255, 99, 132);rgb(255, 159, 64);rgb(255, 205, 86)".split(";")}];
function CPreloader(){var a,d,c,f,g,b,e,h,k;this._init=function(){s_oSpriteLibrary.init(this._onImagesLoaded,this._onAllImagesLoaded,this);s_oSpriteLibrary.addSprite("progress_bar","./sprites/progress_bar.png");s_oSpriteLibrary.addSprite("200x200","./sprites/200x200.png");s_oSpriteLibrary.loadSprites();k=new createjs.Container;s_oStage.addChild(k)};this.unload=function(){k.removeAllChildren()};this._onImagesLoaded=function(){};this._onAllImagesLoaded=function(){this.attachSprites();s_oMain.preloaderReady()};
this.attachSprites=function(){var l=new createjs.Shape;l.graphics.beginFill("black").drawRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT);k.addChild(l);l=s_oSpriteLibrary.getSprite("200x200");e=createBitmap(l);e.regX=.5*l.width;e.regY=.5*l.height;e.x=CANVAS_WIDTH_HALF;e.y=CANVAS_HEIGHT_HALF-180;k.addChild(e);h=new createjs.Shape;h.graphics.beginFill("rgba(0,0,0,0.01)").drawRoundRect(e.x-100,e.y-100,200,200,10);k.addChild(h);e.mask=h;l=s_oSpriteLibrary.getSprite("progress_bar");f=createBitmap(l);f.x=CANVAS_WIDTH_HALF-
l.width/2;f.y=CANVAS_HEIGHT_HALF+50;k.addChild(f);a=l.width;d=l.height;g=new createjs.Shape;g.graphics.beginFill("rgba(0,0,0,0.01)").drawRect(f.x,f.y,1,d);k.addChild(g);f.mask=g;c=new createjs.Text("","30px "+PRIMARY_FONT,"#fff");c.x=CANVAS_WIDTH_HALF;c.y=CANVAS_HEIGHT_HALF+100;c.textBaseline="alphabetic";c.textAlign="center";k.addChild(c);b=new createjs.Shape;b.graphics.beginFill("black").drawRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT);k.addChild(b);createjs.Tween.get(b).to({alpha:0},500).call(function(){createjs.Tween.removeTweens(b);
k.removeChild(b)})};this.refreshLoader=function(l){c.text=l+"%";100===l&&(c.visible=!1,f.visible=!1,s_oMain._onRemovePreloader());g.graphics.clear();l=Math.floor(l*a/100);g.graphics.beginFill("rgba(0,0,0,0.01)").drawRect(f.x,f.y,l,d)};this._init()}
function CCreditsPanel(){var a,d,c,f,g,b,e,h,k;this._init=function(){g=new createjs.Shape;g.graphics.beginFill("black").drawRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT);g.alpha=0;f=g.on("click",function(){});s_oStage.addChild(g);createjs.Tween.get(g).to({alpha:.7},500);b=new createjs.Container;s_oStage.addChild(b);var l=s_oSpriteLibrary.getSprite("msg_box");k=createBitmap(l);b.addChild(k);c=k.on("click",this._onLogoButRelease);a=CANVAS_WIDTH_HALF;d=-l.height/2;b.x=a;b.y=d;b.regX=l.width/2;b.regY=l.height/
2;var m=l.width-100,n=l.height/2+150;new CTLText(b,l.width/2-10-m/2,n,m,70,36,"center","#402604",PRIMARY_FONT,1,2,2,CODETHISLAB_LINK,!0,!0,!1,!1);m=s_oSpriteLibrary.getSprite("logo_ctl");h=createBitmap(m);h.regX=m.width/2;h.regY=m.height/2;h.x=l.width/2-10;h.y=l.height/2-20;b.addChild(h);m=s_oSpriteLibrary.getSprite("but_exit");n=l.height-35-30;new CTLText(b,30,n,150,30,20,"left","#402604",PRIMARY_FONT,1,0,0,"v.1.1.0",!0,!0,!1,!1);e=new CGfxButton(l.width-m.width/2-30,m.height/2+30,m,b);e.addEventListener(ON_MOUSE_UP,
this.unload,this);createjs.Tween.get(b).to({y:CANVAS_HEIGHT_HALF},700,createjs.Ease.backOut)};this.unload=function(){e.setClickable(!1);createjs.Tween.get(g).to({alpha:0},500);createjs.Tween.get(b).to({y:d},500,createjs.Ease.backIn).call(function(){s_oStage.removeChild(g);s_oStage.removeChild(b);e.unload()});g.off("click",f);k.off("click",c)};this._onLogoButRelease=function(){};this._init()}
function CMain(a){var d,c=0,f=0,g=STATE_LOADING,b;this.initContainer=function(){s_oCanvas=document.getElementById("canvas");s_oStage=new createjs.Stage(s_oCanvas);s_bMobile=isMobile();!1===s_bMobile?s_oStage.enableMouseOver(20):createjs.Touch.enable(s_oStage,!0);s_iPrevTime=(new Date).getTime();createjs.Ticker.addEventListener("tick",this._update);createjs.Ticker.framerate=FPS;navigator.userAgent.match(/Windows Phone/i)&&(DISABLE_SOUND_MOBILE=!0);s_oSpriteLibrary=new CSpriteLibrary;s_oLocalStorage=
new CLocalStorage(GAME_NAME);s_oNetworkManager=new CNetworkManager;b=new CPreloader};this.preloaderReady=function(){!1!==DISABLE_SOUND_MOBILE&&!1!==s_bMobile||this._initSounds();this._loadImages();d=!0};this.soundLoaded=function(){c++;b.refreshLoader(Math.floor(c/f*100))};this._initSounds=function(){Howler.mute(!s_bAudioActive);s_aSoundsInfo=[];s_aSoundsInfo.push({path:"./sounds/",filename:"press_button",loop:!1,volume:1,ingamename:"click"});s_aSoundsInfo.push({path:"./sounds/",filename:"ot_game_over",
loop:!1,volume:1,ingamename:"game_over"});s_aSoundsInfo.push({path:"./sounds/",filename:"ot_click_cell",loop:!1,volume:1,ingamename:"click_cell"});s_aSoundsInfo.push({path:"./sounds/",filename:"ot_win",loop:!1,volume:1,ingamename:"win"});s_aSoundsInfo.push({path:"./sounds/",filename:"king",loop:!1,volume:1,ingamename:"king"});s_aSoundsInfo.push({path:"./sounds/",filename:"jump",loop:!1,volume:1,ingamename:"jump"});s_aSoundsInfo.push({path:"./sounds/",filename:"pawn_move",loop:!1,volume:1,ingamename:"pawn_move"});
s_aSoundsInfo.push({path:"./sounds/",filename:"hurryup",loop:!1,volume:1,ingamename:"hurryup"});s_aSoundsInfo.push({path:"./sounds/",filename:"match_found",loop:!1,volume:1,ingamename:"match_found"});f+=s_aSoundsInfo.length;s_aSounds=[];for(var h=0;h<s_aSoundsInfo.length;h++)this.tryToLoadSound(s_aSoundsInfo[h],!1)};this.tryToLoadSound=function(h,k){setTimeout(function(){s_aSounds[h.ingamename]=new Howl({src:[h.path+h.filename+".mp3"],autoplay:!1,preload:!0,loop:h.loop,volume:h.volume,onload:s_oMain.soundLoaded,
onloaderror:function(l,m){for(var n=0;n<s_aSoundsInfo.length;n++)if(l===s_aSounds[s_aSoundsInfo[n].ingamename]._sounds[0]._id){s_oMain.tryToLoadSound(s_aSoundsInfo[n],!0);break}},onplayerror:function(l){for(var m=0;m<s_aSoundsInfo.length;m++)if(l===s_aSounds[s_aSoundsInfo[m].ingamename]._sounds[0]._id){s_aSounds[s_aSoundsInfo[m].ingamename].once("unlock",function(){s_aSounds[s_aSoundsInfo[m].ingamename].play()});break}}})},k?200:0)};this._loadImages=function(){s_oSpriteLibrary.init(this._onImagesLoaded,
this._onAllImagesLoaded,this);s_oSpriteLibrary.addSprite("local_but","./sprites/local_but.png");s_oSpriteLibrary.addSprite("multiplayer_but","./sprites/multiplayer_but.png");s_oSpriteLibrary.addSprite("msg_box","./sprites/msg_box.png");s_oSpriteLibrary.addSprite("msg_box_small","./sprites/msg_box_small.png");s_oSpriteLibrary.addSprite("bg_menu","./sprites/bg_menu.jpg");s_oSpriteLibrary.addSprite("bg_game","./sprites/bg_game.jpg");s_oSpriteLibrary.addSprite("but_credits","./sprites/but_credits.png");
s_oSpriteLibrary.addSprite("but_fullscreen","./sprites/but_fullscreen.png");s_oSpriteLibrary.addSprite("logo_ctl","./sprites/logo_ctl.png");s_oSpriteLibrary.addSprite("but_vs_man","./sprites/vs_man_panel.png");s_oSpriteLibrary.addSprite("but_vs_pc","./sprites/vs_pc_panel.png");s_oSpriteLibrary.addSprite("but_exit","./sprites/but_exit.png");s_oSpriteLibrary.addSprite("audio_icon","./sprites/audio_icon.png");s_oSpriteLibrary.addSprite("but_settings","./sprites/but_settings.png");s_oSpriteLibrary.addSprite("piece_lit",
"./sprites/piece_lit.png");s_oSpriteLibrary.addSprite("highlight","./sprites/highlight.png");s_oSpriteLibrary.addSprite("highlight_last_move","./sprites/highlight_last_move.png");s_oSpriteLibrary.addSprite("highlight_landing","./sprites/highlight_landing.png");s_oSpriteLibrary.addSprite("player_panel","./sprites/player_panel.png");s_oSpriteLibrary.addSprite("but_lang","./sprites/but_lang.png");s_oSpriteLibrary.addSprite("but_yes","./sprites/but_yes.png");s_oSpriteLibrary.addSprite("but_no","./sprites/but_no.png");
s_oSpriteLibrary.addSprite("but_restart","./sprites/but_restart.png");s_oSpriteLibrary.addSprite("but_home","./sprites/but_home.png");s_oSpriteLibrary.addSprite("but_show","./sprites/but_show.png");for(var h=0;h<NUM_LANGUAGES;h++)s_oSpriteLibrary.addSprite("logo_"+h,"./sprites/logo_"+h+".png");s_oSpriteLibrary.addSprite("highlight_capture","./sprites/highlight_capture.png");s_oSpriteLibrary.addSprite("time_panel","./sprites/time_panel.png");s_oSpriteLibrary.addSprite("but_time_nomin","./sprites/but_time_nomin.png");
s_oSpriteLibrary.addSprite("but_time_1min","./sprites/but_time_1min.png");s_oSpriteLibrary.addSprite("but_time_3min","./sprites/but_time_3min.png");s_oSpriteLibrary.addSprite("but_time_5min","./sprites/but_time_5min.png");s_oSpriteLibrary.addSprite("but_time_10min","./sprites/but_time_10min.png");s_oSpriteLibrary.addSprite("but_bwd","./sprites/but_bwd.png");s_oSpriteLibrary.addSprite("but_fwd","./sprites/but_fwd.png");for(var k=0;8>k;k++)s_oSpriteLibrary.addSprite("rule_flag_"+k,"./sprites/rule_flag_"+
k+".png");s_oSpriteLibrary.addSprite("custom_icon","./sprites/custom_icon.png");s_oSpriteLibrary.addSprite("rule_toggle","./sprites/rule_toggle.png");s_oSpriteLibrary.addSprite("but_info_rules","./sprites/but_info_rules.png");s_oSpriteLibrary.addSprite("board_frame","./sprites/board_frame.png");s_oSpriteLibrary.addSprite("board_frame_1","./sprites/board_frame.png");s_oSpriteLibrary.addSprite("board_occlusion","./sprites/board_occlusion.png");s_oSpriteLibrary.addSprite("board_pattern","./sprites/board_pattern.png");
s_oSpriteLibrary.addSprite("board_pattern_1","./sprites/board_pattern.png");s_oSpriteLibrary.addSprite("board_focus_shape","./sprites/board_focus_shape.png");var l=[KING,PAWN],m=[WHITE,BLACK];for(h=0;h<m.length;h++)for(s_oSpriteLibrary.addSprite(m[h]+"_marker","./sprites/"+m[h]+"_marker.png"),k=0;k<l.length;k++){var n=m[h]+"_"+l[k];s_oSpriteLibrary.addSprite(n+"_marker","./sprites/"+n+"_marker.png")}s_oSpriteLibrary.addSprite("shader_king","./sprites/shader_king.png");s_oSpriteLibrary.addSprite("shader_pawn",
"./sprites/shader_pawn.png");s_oSpriteLibrary.addSprite("shader_pawn_positive","./sprites/shader_pawn_positive.png");s_oSpriteLibrary.addSprite("arrow_up","./sprites/arrow_up.png");s_oSpriteLibrary.addSprite("arrow_down","./sprites/arrow_down.png");s_oSpriteLibrary.addSprite("arrow_equal","./sprites/arrow_equal.png");s_oSpriteLibrary.addSprite("but_draw","./sprites/but_draw.png");s_oSpriteLibrary.addSprite("but_surrender","./sprites/but_surrender.png");s_oSpriteLibrary.addSprite("rule_desc_label",
"./sprites/rule_desc_label.png");s_oSpriteLibrary.addSprite("flag_desc_label","./sprites/flag_desc_label.png");s_oSpriteLibrary.addSprite("icon_notify","./sprites/icon_notify.png");s_oSpriteLibrary.addSprite("checkers","./sprites/checkers.png");for(h=0;22>h;h++)s_oSpriteLibrary.addSprite("particle_stars_"+h,"./sprites/particle_stars/particle_stars_"+h+".png");f+=s_oSpriteLibrary.getNumSprites();s_oSpriteLibrary.loadSprites()};this._onImagesLoaded=function(){c++;b.refreshLoader(Math.floor(c/f*100))};
this._onRemovePreloader=function(){try{checkMoreGames(s_szGameID,"middle-left",["board","multiplayer"],[],-1,"brown")}catch(h){}b.unload();this.gotoMenu()};this._onAllImagesLoaded=function(){};this.onAllPreloaderImagesLoaded=function(){this._loadImages()};this.gotoMenu=function(){try{showMoreGames()}catch(h){}new CMenu;g=STATE_MENU};this.gotoModeMenu=function(){new CModeMenu;g=STATE_MENU};this.gotoGame=function(h,k,l){s_iGameType=h;s_oGame=new CGameSingle(e,k,l);g=STATE_GAME};this.gotoGameMulti=function(h,
k){s_iGameType=MODE_HUMAN;s_oGame=new CGameMulti(e,h,k);g=STATE_GAME};this.gotoGameWithBot=function(h,k){s_oGame=new CGameSingleWithBot(e,h,k);g=STATE_GAME};this.gotoHelp=function(){new CHelp;g=STATE_HELP};this.stopUpdate=function(){!1!==DISABLE_SOUND_MOBILE&&!1!==s_bMobile||Howler.mute(!0);s_bMultiplayer||(d=!1,createjs.Ticker.paused=!0)};this.startUpdate=function(){!1!==DISABLE_SOUND_MOBILE&&!1!==s_bMobile||!s_bAudioActive||s_bAdShown||Howler.mute(!1);s_bMultiplayer||(s_iPrevTime=(new Date).getTime(),
d=!0,createjs.Ticker.paused=!1)};this._update=function(h){if(!1!==d){var k=(new Date).getTime();s_iTimeElaps=k-s_iPrevTime;s_iCntTime+=s_iTimeElaps;s_iCntFps++;s_iPrevTime=k;1E3<=s_iCntTime&&(s_iCurFps=s_iCntFps,s_iCntTime-=1E3,s_iCntFps=0);g===STATE_GAME&&s_oGame.update();s_oStage.update(h)}};s_oMain=this;var e=a;s_bAudioActive=a.audio_enable_on_startup;ENABLE_CHECK_ORIENTATION=a.check_orientation;ENABLE_FULLSCREEN=a.fullScreen;a=navigator.language.split("-")[0];void 0===LANG_CODES[a]&&(a="en");
s_iCurLang=LANG_CODES[a];console.log("LANG_CODES["+navigator.language+"] "+s_iCurLang);this.initContainer();refreshLanguage()}
var s_bMobile,s_bAudioActive=!0,s_bFullscreen=!1,s_iCntTime=0,s_iTimeElaps=0,s_iPrevTime=0,s_iCntFps=0,s_iCurFps=0,s_aSoundsInfo,s_oStage,s_oMain,s_oSpriteLibrary,s_oCanvas,s_iGameType,s_bWeightSquares=!1,s_bEdgeSensitive=!1,s_aSounds,s_oGame,s_oLocalStorage,s_oNetworkManager=null,s_bMultiplayer=!1,g_oCTLMultiplayer,s_iCurLang=LANG_EN,s_szCurVers="1.00",s_bAdsRemoved=!1,INVITE_LINK="",s_iCurRuleFlag=DEFAULT_RULE_FLAG;
function CMenu(){var a,d,c,f,g,b,e,h,k,l,m,n,p,q,r,u,x,w,v,F=null,y=null,t,B,L;this._init=function(){768<=getSize("Width")&&(document.querySelector("#div_display_id").style.display="block");m=createBitmap(s_oSpriteLibrary.getSprite("bg_menu"));s_oStage.addChild(m);var C=s_oSpriteLibrary.getSprite("logo_"+s_iCurLang);L=createBitmap(C);L.regX=C.width/2;L.x=CANVAS_WIDTH/2;L.y=500;s_oStage.addChild(L);C=s_oSpriteLibrary.getSprite("but_rules");c=CANVAS_WIDTH/2;t=new CRuleButton(c,1720,s_oStage);t.addEventListener(ON_MOUSE_UP,
this._onRules,this);C=s_oSpriteLibrary.getSprite("local_but");n=new CButMenu(CANVAS_WIDTH/2,CANVAS_HEIGHT-330,C,TEXT_LOCAL_PLAY,PRIMARY_FONT,FONT_COLOR,60,s_oStage);n.addEventListener(ON_MOUSE_UP,this._onButLocalRelease,this);s_bAlertActive&&n.addAlert();C=s_oSpriteLibrary.getSprite("multiplayer_but");p=new CButMenu(CANVAS_WIDTH/2,CANVAS_HEIGHT-550,C,TEXT_MULTIPLAYER,PRIMARY_FONT,FONT_COLOR,60,s_oStage);p.addEventListener(ON_MOUSE_UP,this._onButMultiplayerRelease,this);C=s_oSpriteLibrary.getSprite("but_credits");
b=20+C.width/2;e=C.height/2+25;u=new CGfxButton(b,e,C,s_oStage);u.addEventListener(ON_MOUSE_UP,this._onCredits,this);var V=s_oSpriteLibrary.getSprite("but_lang");C=s_oSpriteLibrary.getSprite("audio_icon");!1===DISABLE_SOUND_MOBILE||!1===s_bMobile?(a=CANVAS_WIDTH-C.height/2-10,d=C.height/2+25,r=new CToggle(a,d,C,s_bAudioActive,s_oStage),r.addEventListener(ON_MOUSE_UP,this._onAudioToggle,this),h=a-LANG_WIDTH-10,k=d):(h=CANVAS_WIDTH-C.width/4-10,k=C.height/2+10);this._checkCodethislabLink();w=new CButLang(h,
k,NUM_LANGUAGES,s_iCurLang,V,s_oStage);w.addEventListener(ON_SELECT_LANG,this._onSelectLang,this);C=window.document;V=C.documentElement;F=V.requestFullscreen||V.mozRequestFullScreen||V.webkitRequestFullScreen||V.msRequestFullscreen;y=C.exitFullscreen||C.mozCancelFullScreen||C.webkitExitFullscreen||C.msExitFullscreen;!1===ENABLE_FULLSCREEN&&(F=!1);F&&screenfull.isEnabled&&(C=s_oSpriteLibrary.getSprite("but_fullscreen"),f=b+C.width/2+10,g=e,x=new CToggle(f,g,C,s_bFullscreen,s_oStage),x.addEventListener(ON_MOUSE_UP,
this._onFullscreenRelease,this));B=new CRulePanel(CANVAS_WIDTH/2,CANVAS_HEIGHT/2,s_oStage);B.addEventListener(ON_EXIT_RULE_PANEL,this._onExitRules,this);B.hide();C=B.getInfo();t.setPreset(C);v=new CLangPanel(s_oStage);v.addEventListener(ON_SELECT_LANG,this._onChangeLang,this);q=new createjs.Shape;q.graphics.beginFill("black").drawRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT);s_bAlertActive&&s_bFirstTimeAccess&&new CNewsPanel(TEXT_NEWS);s_oStage.addChild(q);createjs.Tween.get(q).to({alpha:0},1E3).call(function(){q.visible=
!1});this.refreshButtonPos(s_iOffsetX,s_iOffsetY);this.checkPendingInvitation()};this.checkPendingInvitation=function(){var C=getParameterByName(PARAM_ROOM_ID),V=getParameterByName(PARAM_PASSWORD);void 0!==C&&null!==C&&(window.history.replaceState(null,null,removeParamFromURL(PARAM_ROOM_ID,removeParamFromURL(PARAM_PASSWORD))),s_oNetworkManager.addEventListener(ON_LOGIN_SUCCESS,function(){s_oNetworkManager.tryJoinFromInvitation(C.toString(),V.toString())}),s_oNetworkManager.connectToSystem())};this.unload=
function(){w.unload();n.unload();n=null;p.unload();p=null;q.visible=!1;t.unload();B.unload();if(!1===DISABLE_SOUND_MOBILE||!1===s_bMobile)r.unload(),r=null;u.unload();F&&screenfull.isEnabled&&x.unload();v.unload();s_oStage.removeChild(m);s_oMenu=m=null};this.refreshButtonPos=function(){!1!==DISABLE_SOUND_MOBILE&&!1!==s_bMobile||r.setPosition(a-s_iOffsetX,d+s_iOffsetY);u.setPosition(b+s_iOffsetX,e+s_iOffsetY);F&&screenfull.isEnabled&&x.setPosition(f+s_iOffsetX,g+s_iOffsetY);w.setPosition(h-s_iOffsetX,
k+s_iOffsetY);s_bLandscape?(L.scale=.7,L.y=550,n.setPosition(CANVAS_WIDTH/2-300,CANVAS_HEIGHT/2+40),p.setPosition(CANVAS_WIDTH/2+300,CANVAS_HEIGHT/2+40),t.setY(CANVAS_HEIGHT/2+220),n.setScale(.7),p.setScale(.7),t.setScale(.7)):(L.y=350,n.setPosition(CANVAS_WIDTH/2,CANVAS_HEIGHT-450),p.setPosition(CANVAS_WIDTH/2,CANVAS_HEIGHT-700),t.setY(CANVAS_HEIGHT-950),n.setScale(1),p.setScale(1),t.setScale(1));B.refreshPos()};this._onAudioToggle=function(){Howler.mute(s_bAudioActive);s_bAudioActive=!s_bAudioActive};
this._onCredits=function(){new CCreditsPanel};this.resetFullscreenBut=function(){F&&screenfull.isEnabled&&x.setActive(s_bFullscreen)};this._onFullscreenRelease=function(){s_bFullscreen?y.call(window.document):F.call(window.document.documentElement);sizeHandler()};this._onButLocalRelease=function(){"undefined"!==typeof gdsdk&&"undefined"!==gdsdk.showAd&&gdsdk.showAd();try{hideMoreGames()}catch(C){}document.querySelector("#div_display_id").style.display="none";this.unload();s_bPlayWithBot=s_bMultiplayer=
!1;document.dispatchEvent(new CustomEvent("start_session"));s_oMain.gotoModeMenu()};this._onButMultiplayerRelease=function(){"undefined"!==typeof gdsdk&&"undefined"!==gdsdk.showAd&&gdsdk.showAd();try{hideMoreGames()}catch(C){}document.querySelector("#div_display_id").style.display="none";document.dispatchEvent(new CustomEvent("start_session"));s_bMultiplayer=!0;s_bPlayWithBot=!1;s_oNetworkManager.addEventListener(ON_MATCHMAKING_CONNECTION_SUCCESS,this._onMatchmakingConnected);s_oNetworkManager.addEventListener(ON_GAMEROOM_CONNECTION_SUCCESS,
this.clearBotCheck);s_oNetworkManager.addEventListener(ON_BACK_FROM_A_ROOM,this.clearBotCheck);s_oNetworkManager.addEventListener(ON_LOGIN_SUCCESS,s_oNetworkManager.gotoLobby);s_oNetworkManager.connectToSystem()};this.onRemoteGameStart=function(C,V){s_oMenu.clearBotCheck();s_bMultiplayer=!0;s_bPlayWithBot=!1;var ba=RULE_PRESET[V];s_oMenu.unload();s_oMain.gotoGameMulti(C,ba)};this._onMatchmakingConnected=function(C){s_oMenu._checkMatchWithBot(C)};this._checkMatchWithBot=function(C){var V=C[0],ba=C[1];
C=C[2];C=randomFloatBetween(.75*C,C);l=setTimeout(function(){s_bPlayWithBot=s_bMultiplayer=!0;s_iGameType=MODE_COMPUTER;g_oCTLMultiplayer.closeAllDialog();s_oNetworkManager.disconnect();s_oNetworkManager.generateRandomName();s_oMenu.unload();s_oMain.gotoGameWithBot(V,RULE_PRESET[ba])},C)};this.clearBotCheck=function(){clearTimeout(l)};this.changeFlagRule=function(){if(s_iCurRuleFlag!==t.getFlag()){B._changeRulePreset();var C=B.getInfo();t.setPreset(C)}};this._onSelectLang=function(){v.show()};this._onChangeLang=
function(C){s_iCurLang=C;w.setLang(C);refreshLanguage();C=s_oSpriteLibrary.getSprite("logo_"+s_iCurLang);L.image=C;L.regX=C.width/2;n.changeText(TEXT_LOCAL_PLAY.toUpperCase());p.changeText(TEXT_MULTIPLAYER.toUpperCase());B.setPreset(s_oRules);C=B.getInfo();t.refreshTextByLang(C.text);this._checkCodethislabLink()};this._checkCodethislabLink=function(){CODETHISLAB_LINK=CODETHISLAB_LINK_COM;s_iCurLang===LANG_CODES.it&&(CODETHISLAB_LINK=CODETHISLAB_LINK_IT)};this._onRules=function(){B.show();s_oLocalStorage.saveData()};
this._onExitRules=function(){B.hide();var C=B.getInfo();t.setPreset(C)};s_oMenu=this;this._init()}var s_oMenu=null,s_bFirstTimeAccess=!0;
function CModeMenu(){var a,d,c,f,g,b,e,h,k,l,m=null,n,p=null,q=null,r,u,x;this._init=function(){var w=createBitmap(s_oSpriteLibrary.getSprite("bg_menu"));s_oStage.addChild(w);w=s_oSpriteLibrary.getSprite("but_exit");d=CANVAS_WIDTH-w.height/2-10;c=w.height/2+25;l=new CGfxButton(d,c,w,s_oStage);l.addEventListener(ON_MOUSE_UP,this._onExit,this);f=CANVAS_WIDTH-w.width/2-125;g=w.height/2+25;if(!1===DISABLE_SOUND_MOBILE||!1===s_bMobile)w=s_oSpriteLibrary.getSprite("audio_icon"),m=new CToggle(f,g,w,s_bAudioActive,
s_oStage),m.addEventListener(ON_MOUSE_UP,this._onAudioToggle,this);w=window.document;var v=w.documentElement;p=v.requestFullscreen||v.mozRequestFullScreen||v.webkitRequestFullScreen||v.msRequestFullscreen;q=w.exitFullscreen||w.mozCancelFullScreen||w.webkitExitFullscreen||w.msExitFullscreen;!1===ENABLE_FULLSCREEN&&(p=!1);p&&screenfull.isEnabled&&(w=s_oSpriteLibrary.getSprite("but_fullscreen"),b=w.width/4+20,e=w.height/2+25,n=new CToggle(b,e,w,s_bFullscreen,s_oStage),n.addEventListener(ON_MOUSE_UP,
this._onFullscreenRelease,this));s_oSpriteLibrary.getSprite("but_rules");a=CANVAS_WIDTH/2;x=new CRuleButton(a,1720,s_oStage);x.addEventListener(ON_MOUSE_UP,this._onRules,this);w=s_oSpriteLibrary.getSprite("but_vs_man");h=new CGfxButton(CANVAS_WIDTH/2,800,w,s_oStage);h.addEventListener(ON_MOUSE_UP,this._onButHumanRelease,this);w=s_oSpriteLibrary.getSprite("but_vs_pc");k=new CGfxButton(CANVAS_WIDTH/2,1300,w,s_oStage);k.addEventListener(ON_MOUSE_UP,this._onButComputerRelease,this);r=new CTimePanel(CANVAS_WIDTH/
2,1720,s_oStage);u=new CRulePanel(CANVAS_WIDTH/2,CANVAS_HEIGHT/2,s_oStage);u.addEventListener(ON_EXIT_RULE_PANEL,this._onExitRules,this);u.hide();w=u.getInfo();x.setPreset(w);s_bAlertActive&&x.addAlert();this.refreshButtonPos()};this.unload=function(){h.unload();k.unload();l.unload();if(!1===DISABLE_SOUND_MOBILE||!1===s_bMobile)m.unload(),m=null;p&&screenfull.isEnabled&&n.unload();x.unload();r.unload();u.unload();s_oModeMenu=null;s_oStage.removeAllChildren()};this.refreshButtonPos=function(){l.setPosition(d-
s_iOffsetX,c+s_iOffsetY);!1!==DISABLE_SOUND_MOBILE&&!1!==s_bMobile||m.setPosition(f-s_iOffsetX,g+s_iOffsetY);p&&screenfull.isEnabled&&n.setPosition(b+s_iOffsetX,e+s_iOffsetY);x.refreshPos();r.refreshPos();u.refreshPos();if(s_bLandscape){var w=1,v=0;h.setPosition(CANVAS_WIDTH/2-350+v,CANVAS_HEIGHT/2-50);h.setScale(w);k.setPosition(CANVAS_WIDTH/2+350+v,CANVAS_HEIGHT/2-50)}else w=1.15,v=-4,h.setPosition(CANVAS_WIDTH/2+v,CANVAS_HEIGHT/2-500),h.setScale(w),k.setPosition(CANVAS_WIDTH/2+v,CANVAS_HEIGHT/
2+40);k.setScale(w)};this.resetFullscreenBut=function(){p&&screenfull.isEnabled&&n.setActive(s_bFullscreen)};this._onFullscreenRelease=function(){s_bFullscreen?q.call(window.document):p.call(window.document.documentElement);sizeHandler()};this._onAudioToggle=function(){Howler.mute(s_bAudioActive);s_bAudioActive=!s_bAudioActive};this._onExit=function(){this.unload();s_oMain.gotoMenu()};this._onButHumanRelease=function(){this.unload();s_oMain.gotoGame(MODE_HUMAN,MATCH_MINUTES_TYPE[s_iPrefTimeMode],
s_oRules)};this._onButComputerRelease=function(){this.unload();s_oMain.gotoGame(MODE_COMPUTER,MATCH_MINUTES_TYPE[s_iPrefTimeMode],s_oRules)};this._onRules=function(){u.show();s_bAlertActive=!1;x.removeAlert();s_oLocalStorage.saveData()};this._onExitRules=function(){u.hide();var w=u.getInfo();x.setPreset(w)};s_oModeMenu=this;this._init()}var s_oModeMenu=null;
function CGameBase(a,d){this._bStartGame;this._iCurPlayer;this._iBlackTime;this._iWhiteTime;this._iNumBlack;this._iNumWhite;this._iDrawCounter;this._aCell;this._oInterface;this._oEndPanel=null;this._oParent;this._oThinking;this._oBoard;this._oCellActive=null;this._oPathDrawer;this._iPlayerState;this._oRules;this._oPiecesValue;this._aCaptureList;this._aAllAvailablePath;this._oPathChosen;this._oCellClicked;this._aMandatoryCells;this._bWhiteBotSide;this._iAnimationTime;this._iMinutes;this._iGameTypeIndex;
SHOW_SCORE=!1;START_SCORE=5E3;SCORE_DECREASE_PER_SECOND=10;s_oGame=this;this._init(d)}
CGameBase.prototype._init=function(a){this._setRules(a);this._bWhiteBotSide=!0;this._iAnimationTime=ANIM_TIME_MOVE_TYPE[0];this._reset();a=createBitmap(s_oSpriteLibrary.getSprite("bg_game"));s_oStage.addChild(a);this._oGeneralContainer=new createjs.Container;this._oGeneralContainer.x=CANVAS_WIDTH/2;this._oGeneralContainer.y=CANVAS_HEIGHT/2;s_oStage.addChild(this._oGeneralContainer);this._oBoardContainer=new createjs.Container;this._oGeneralContainer.addChild(this._oBoardContainer);this._oPiecesContainer=
new createjs.Container;this._oGeneralContainer.addChild(this._oPiecesContainer);this._oInfoPanelContainer=new createjs.Container;this._oInfoPanelContainer.x=this._oGeneralContainer.x;this._oInfoPanelContainer.y=this._oGeneralContainer.y;s_oStage.addChild(this._oInfoPanelContainer);this._oThinking=new CThinking;this._oThinking.hide();this._initBoard();this._configureBoard();new CMovesController(this._aCell,this._oRules);new CBoardStateController;this._checkLegalMoves()};
CGameBase.prototype._reset=function(){this._bStartGame=!0;this._iCurPlayer=this._oRules.starting_player;this._iDrawCounter=this._iWhiteTime=this._iBlackTime=0;this._iPlayerState=PLAYER_STATE_WAIT;this._aCaptureList=[]};CGameBase.prototype._setRules=function(a){this._oRules=copyObjectByValue(a)};CGameBase.prototype.getRules=function(){return this._oRules};
CGameBase.prototype._initBoard=function(){var a=this._oRules.starting_board;this._setPiecesValue(this._oRules);this._oBoard=new CBoard(0,0,this._oBoardContainer,a.length,this._oRules.origin_cell_color);var d=this._oBoard.getCellSize(),c=this._oBoard.getCellsPos(),f=this._oBoard.getScale();this._aCell=[];for(var g=0;g<a.length;g++){this._aCell[g]=[];for(var b=0;b<a[g].length;b++){var e=c[g][b];e=new CCell(e.x,e.y,{row:g,col:b},this._oPiecesContainer,d);e.addEventListener(ON_MOUSE_DOWN,this.onCellDown,
this);e.addEventListener(ON_MOUSE_UP,this.onCellUp,this);e.addEventListener(ON_MOUSE_OVER,this.onCellOver,this);e.addEventListener(ON_MOUSE_OUT,this.onCellOut,this);this._aCell[g][b]=e}}this._oPiecesContainer.scale=f;this._oPathDrawer=new CPathDrawer(c,d,this._oPiecesContainer)};
CGameBase.prototype._configureBoard=function(){for(var a=this._oRules.starting_board,d=0;d<this._aCell.length;d++)for(var c=0;c<this._aCell[d].length;c++){var f=a[d][c];null!==f&&(f=this._aCell[d][c].createPiece(f.color,f.type),ON_PIECE_START_MOVE,f.addEventListener(ON_PIECE_START_MOVE,this.onPieceStartMove,this),f.addEventListener(ON_PIECE_MOVE,this.onPieceMove,this),f.addEventListener(ON_PIECE_MOVED,this.onPieceMoved,this),f.addEventListener(ON_PIECE_COMPLETED_ALL_MOVES,this.onFinishMove,this))}this.countPawn()};
CGameBase.prototype._cleanBoard=function(){for(var a=0;a<this._aCell.length;a++)for(var d=0;d<this._aCell[a].length;d++)this._aCell[a][d].setLastMove(!1),this._aCell[a][d].remove()};CGameBase.prototype.refreshGUI=function(){this.refreshSize();this.refreshControllerObjects()};
CGameBase.prototype.refreshSize=function(){var a=60,d=CANVAS_WIDTH-2*s_iOffsetX-a;a=CANVAS_HEIGHT-2*s_iOffsetY-a;if(s_bLandscape){if(this._oGeneralContainer&&this._oGeneralContainer.getBounds()){var c=0,f=450;1.6<s_iAspectRatio?f=740:1.6>=s_iAspectRatio&&(c=12);f=895+f;c=zoomInCamera(this._oGeneralContainer,d,a,f,895+c);a=0;1.6>=s_iAspectRatio&&(a=CANVAS_WIDTH/2-200-(f/2-350)*c);this._oGeneralContainer.x=CANVAS_WIDTH/2-a}}else this._oGeneralContainer&&this._oGeneralContainer.getBounds()&&(c=zoomInCamera(this._oGeneralContainer,
d,a,895,1189),this._oGeneralContainer.x=CANVAS_WIDTH/2);this._oInfoPanelContainer.x=this._oGeneralContainer.x;this._oInfoPanelContainer.y=this._oGeneralContainer.y;this._oInfoPanelContainer.scaleX=this._oInfoPanelContainer.scaleY=c};CGameBase.prototype.rotateBoard=function(a){a=a?0:180;this._oBoardContainer.rotation=a;this._oPiecesContainer.rotation=a;for(var d=0;d<this._aCell.length;d++)for(var c=0;c<this._aCell[d].length;c++)this._aCell[d][c].rotatePiece(a)};
CGameBase.prototype._checkEndGame=function(){if(0===this._iNumBlack)return this.gameOver(WHITE),!0;if(0===this._iNumWhite)return this.gameOver(BLACK),!0;this._iDrawCounter++;if(this._iDrawCounter===DRAW_COUNTER)return this.gameOver(DRAW),!0;var a=s_oBoardStateController.getOtherOpponent(this._iCurPlayer),d=s_oBoardStateController.copyBoard(this._aCell);return 0===s_oMovesController.getAllMovesInfoInBoard(a,d).length?(d=WIN_BLACK_WHITE_NOMOVES,a===BLACK&&(d=WIN_WHITE_BLACK_NOMOVES),this.gameOver(d),
!0):!1};CGameBase.prototype.gameOver=function(a){this._bStartGame=!1;this._oThinking.hide();switch(a){case WHITE:this._iBlackScore=0;break;case BLACK:this._iWhiteScore=0;break;default:this._iWhiteScore=this._iBlackScore=0}this.setEndPanel(a)};CGameBase.prototype._disableAllClick=function(){for(var a=0;a<this._aCell.length;a++)for(var d=0;d<this._aCell[a].length;d++)this._aCell[a][d].setClickableArea(!1)};
CGameBase.prototype.tryToSelect=function(a,d){if(0<this._aMandatoryCells.length)for(var c=0;c<this._aMandatoryCells.length;c++){var f=this._aMandatoryCells[c].logic_pos;a===f.row&&d===f.col&&(this._activeMandatoryCells(!1),this._selectPiece(a,d))}else this._aCell[a][d].getColor()===this._iCurPlayer&&this._selectPiece(a,d)};CGameBase.prototype._onBoardUp=function(){this._oCellClicked&&(this._oCellClicked.removeOverListeners(),this._oCellClicked=null)};
CGameBase.prototype.onCellDown=function(a,d){this._oCellClicked=this._aCell[a][d];switch(this._iPlayerState){case PLAYER_STATE_SELECTED:var c=this._getPath(a,d);null!==c&&(this._iPlayerState=PLAYER_STATE_PATH_CHOSEN,this._disableAllHighlight(),this._highlightFromPath(c,!0))}};
CGameBase.prototype.onCellOver=function(a,d){switch(this._iPlayerState){case PLAYER_STATE_SELECTED:var c=this._getPath(a,d);null!==c&&(this._iPlayerState=PLAYER_STATE_PATH_CHOSEN,this._disableAllHighlight(),this._highlightFromPath(c,!0))}};CGameBase.prototype.onCellOut=function(a,d){switch(this._iPlayerState){case PLAYER_STATE_PATH_CHOSEN:var c=this._oCellActive.getLogicPos();this._selectPiece(c.row,c.col)}};
CGameBase.prototype.onCellUp=function(a,d){this._oCellClicked&&(this._oCellClicked.removeOverListeners(),this._oCellClicked=null);switch(this._iPlayerState){case PLAYER_STATE_WAIT:this.tryToSelect(a,d);break;case PLAYER_STATE_SELECTED:this._aCell[a][d].getColor()===this._iCurPlayer?(this._deselectPiece(),this.tryToSelect(a,d)):this._deselectPiece();break;case PLAYER_STATE_PATH_CHOSEN:this._aCell[a][d].isLanding()&&this._movePiece(a,d)}};
CGameBase.prototype._selectPiece=function(a,d){this._oCellActive=this._aCell[a][d];this._oCellActive.setActive(!0);this._disableAllHighlight();var c=s_oBoardStateController.copyBoard(this._aCell);this._aAllAvailablePath=s_oMovesController.getMovesList(a,d,c);this._oPathDrawer.clear();this._highlightAllPaths();this._iPlayerState=PLAYER_STATE_SELECTED};
CGameBase.prototype._getPath=function(a,d){for(var c=null,f=0;f<this._aAllAvailablePath.length;f++)if(this._aAllAvailablePath[f].terminal.row===a&&this._aAllAvailablePath[f].terminal.col===d){c=this._aAllAvailablePath[f];break}return c};CGameBase.prototype.onPieceStartMove=function(a){this._hideLastMove();this._aCell[a.row][a.col].setLastMove(!0)};
CGameBase.prototype.onPieceMove=function(a,d,c){d=s_oMovesController.getLine(d,a.dest);for(var f=0;f<d.length;f++){for(var g=copyObjectByValue(this._oPathChosen),b=0;b<=c;b++)g.jump_list.splice(0,1);g.src=a.dest;var e=s_oMovesController.getAllCellsFromAPath(g);g=!0;var h=d[f];for(b=0;b<e.length;b++)if(e[b].row===h.row&&e[b].col===h.col){g=!1;this._aCell[h.row][h.col].captureHighlight(!1);break}b=500/d.length;e=b*f;g&&this._aCell[h.row][h.col].unlitAll(b,e)}};
CGameBase.prototype.onPieceMoved=function(a,d){if(a.capture){var c=a.capture.logic_pos;c=this._aCell[c.row][c.col];var f=c.getType(),g=c.getColor();this._aCaptureList.push({type:f,color:g});c.setCaptured();this._iDrawCounter=0}this._oRules.pawn_can_continue_as_king&&(f=a.dest,c=0===f.row&&d.getColor()===WHITE,f=f.row===this._aCell.length-1&&d.getColor()===BLACK,(c||f)&&d.promote())};
CGameBase.prototype.onFinishMove=function(a,d){if(d.getType()===PAWN){this._iDrawCounter=0;var c=0===a.row&&d.getColor()===WHITE,f=a.row===this._aCell.length-1&&d.getColor()===BLACK;(c||f)&&d.promote()}this._aCell[a.row][a.col].setLastMove(!0);this._aCell[a.row][a.col].setPiece(d);this._oPathDrawer.clear();this.countPawn();this.updateStats();this._checkEndGame()||this.changeTurn()};
CGameBase.prototype._checkLegalMoves=function(){this._aMandatoryCells=[];var a=s_oBoardStateController.copyBoard(this._aCell);this._aMandatoryCells=s_oMovesController.getMandatoryCells(this._iCurPlayer,a);this._activeMandatoryCells(!0)};CGameBase.prototype._activeMandatoryCells=function(a){for(var d=0;d<this._aMandatoryCells.length;d++){var c=this._aMandatoryCells[d].logic_pos;this._aCell[c.row][c.col].setActive(a)}};
CGameBase.prototype._deselectPiece=function(){this._aAllAvailablePath=null;this._disableAllHighlight();this._oCellActive.setActive(!1);this._oCellActive=null;this._activeMandatoryCells(!0);this._iPlayerState=PLAYER_STATE_WAIT};
CGameBase.prototype.restartGame=function(){s_oGame._oEndPanel.unload();s_oGame._oEndPanel=null;s_oGame._oCellActive=null;s_oGame._disableAllHighlight();s_oGame._reset();s_oGame._cleanBoard();s_oGame._configureBoard();s_oGame._oInterface.activePlayer(s_oGame._iCurPlayer);s_oGame._checkLegalMoves();s_oGame._checkTurn();s_oGame.updateStats();s_oGame._bStartGame=!0};CGameBase.prototype.pauseGame=function(a){this._bStartGame=!a};CGameBase.prototype.getAnimTime=function(){return this._iAnimationTime};
CGameBase.prototype.getCurPlayer=function(){return this._iCurPlayer};CGameBase.prototype._onExitHelp=function(){this._bStartGame=!0};CGameBase.prototype.getCapturedList=function(a){for(var d=[],c=0;c<this._aCaptureList.length;c++){var f=this._aCaptureList[c];f.color===a&&d.push(f)}return d};
CGameBase.prototype._setPiecesValue=function(a){this._oPiecesValue={};this._oPiecesValue[PAWN]=1;this._oPiecesValue[KING]=1.4;switch(a.king_movement){case KING_MOVEMENT_FLY:this._oPiecesValue[KING]+=1.2;break;case KING_MOVEMENT_FLY_BLOCK:this._oPiecesValue[KING]+=.5}a=a.capture_rule;a.king_protected&&(this._oPiecesValue[KING]+=.2);a.back&&(this._oPiecesValue[PAWN]+=.2);console.log("_iPawnValue:"+this._oPiecesValue[PAWN]);console.log("_iKingValue:"+this._oPiecesValue[KING])};
CGameBase.prototype.getWinChance=function(){var a=[];a[WHITE]=0;for(var d=a[BLACK]=0;d<this._aCell.length;d++)for(var c=0;c<this._aCell[d].length;c++){var f=this._aCell[d][c];f.getType()&&(a[f.getColor()]+=this._oPiecesValue[f.getType()])}d=[];d[WHITE]=a[WHITE]/(a[WHITE]+a[BLACK])*100;d[BLACK]=100-d[WHITE];return d};
CGameBase.prototype.updateStats=function(){var a=this.getCapturedList(WHITE),d=this.getCapturedList(BLACK),c=this.getWinChance()[WHITE].toFixed(1),f=(100-c).toFixed(1);this._oInterface.updateStats(a,d,c,f)};CGameBase.prototype.initTime=function(){this._iBlackTime=this._iWhiteTime=this._iMinutes;this._oInterface.refreshWhiteTime(this._iWhiteTime);this._oInterface.refreshBlackTime(this._iBlackTime)};
CGameBase.prototype._increaseTime=function(){this._iCurPlayer===WHITE?(this._iWhiteTime+=s_iTimeElaps,this._oInterface.refreshWhiteTime(this._iWhiteTime),this._iWhiteScore-=SCORE_DECREASE_PER_SECOND*s_iTimeElaps/1E3,0>this._iWhiteScore&&(this._iWhiteScore=0)):(this._iBlackTime+=s_iTimeElaps,this._oInterface.refreshBlackTime(this._iBlackTime),this._iBlackScore-=SCORE_DECREASE_PER_SECOND*s_iTimeElaps/1E3,0>this._iBlackScore&&(this._iBlackScore=0))};
CGameBase.prototype.refreshTime=function(){this._bNoTime?this._increaseTime():this._decreaseTime()};CGameBase.prototype.update=function(){this._bStartGame&&this.refreshTime()};CGameBase.prototype._hideLastMove=function(){for(var a=0;a<this._aCell.length;a++)for(var d=0;d<this._aCell[a].length;d++)this._aCell[a][d].setLastMove(!1)};CGameBase.prototype._highlightAllPaths=function(){for(var a=0;a<this._aAllAvailablePath.length;a++)this._highlightFromPath(this._aAllAvailablePath[a],!1);this._oPathDrawer.drawAllTrack(this._aAllAvailablePath)};
CGameBase.prototype._highlightFromPath=function(a,d){for(var c=a.jump_list,f=0;f<c.length;f++){var g=c[f].capture;null!==g&&(g=g.logic_pos,this._aCell[g.row][g.col].captureHighlight(d))}c=a.terminal;this._aCell[c.row][c.col].setLanding(!0);this._oPathDrawer.showSinglePath(c)};CGameBase.prototype._disableAllHighlight=function(){this._oPathDrawer.hideAll();for(var a=0;a<this._aCell.length;a++)for(var d=0;d<this._aCell[a].length;d++)this._aCell[a][d].captureHighlight(!1),this._aCell[a][d].setLanding(!1)};
CGameBase.prototype._checkMatrix=function(a){for(var d="",c=0;c<this._aCell.length;c++){for(var f=0;f<this._aCell[c].length;f++)d=0<=a[c][f]?d+(" "+a[c][f]+" | "):d+(a[c][f]+" | ");d+="|| "+c+"\n"}console.log(d)};CGameBase.prototype.countPawn=function(){for(var a,d=this._iNumWhite=this._iNumBlack=0;d<this._aCell.length;d++)for(var c=0;c<this._aCell[d].length;c++)a=this._aCell[d][c].getColor(),a===BLACK?this._iNumBlack++:a===WHITE&&this._iNumWhite++};CGameBase.prototype.getCells=function(){return this._aCell};
CGameBase.prototype.getCurrentPlayer=function(){return this._iCurPlayer};function CGameSingle(a,d,c){this._bNoTime;CGameBase.call(this,a,c);this._startGame(d)}CGameSingle.prototype=Object.create(CGameBase.prototype);
CGameSingle.prototype._startGame=function(a){this._oInterface=new CInterfaceSingle(this._oInfoPanelContainer);this._oInterface.configureInfoPanel(!0);this._bNoTime=!1;0===parseInt(a)&&(this._bNoTime=!0,this._oInterface.showTime(!1));this._iMinutes=6E4*a;this._iGameTypeIndex=MATCH_MINUTES_TYPE.indexOf(a);this._iAnimationTime=ANIM_TIME_MOVE_TYPE[this._iGameTypeIndex];this.initTime();s_iGameType===MODE_HUMAN?s_oInterface.setPlayersInfo(TEXT_WHITE,TEXT_BLACK):s_oInterface.setPlayersInfo(TEXT_PLAYER,TEXT_CPU);
this._oAI=new CAIController(this._oPiecesValue);this._oAI.addEventListener(ON_END_AI_COMPUTATION,this._onEndAIComputation,this);this.updateStats();this._checkTurn()};CGameSingle.prototype.refreshControllerObjects=function(){};
CGameSingle.prototype._movePiece=function(a,d){this._iPlayerState=PLAYER_STATE_MOVING;var c=this._getPath(a,d);this._disableAllHighlight();this._highlightFromPath(c,!0);for(var f=0;f<c.jump_list.length;f++){var g=c.jump_list[f],b=g.dest;g.pos=this._aCell[b.row][b.col].getPos()}this._oCellActive.move(c.jump_list,this._iAnimationTime);this._oPathChosen=c};
CGameSingle.prototype._checkTurn=function(){this._iCurPlayer===WHITE?s_iGameType===MODE_COMPUTER&&this._oThinking.hide():s_iGameType===MODE_COMPUTER&&(this._oThinking.show(),this._playAI());this._oInterface.activePlayer(this._iCurPlayer)};CGameSingle.prototype.changeTurn=function(){this._iCurPlayer=s_oBoardStateController.getOtherOpponent(this._iCurPlayer);this._checkTurn();this._iPlayerState=PLAYER_STATE_WAIT;this._checkLegalMoves()};
CGameSingle.prototype._playAI=function(a){a||(this._oThinking.show(),a=s_oBoardStateController.copyBoard(this._aCell),this._oAI.getMove(this._iCurPlayer,a))};
CGameSingle.prototype._onEndAIComputation=function(a){var d=MIN_AI_THINKING+Math.random()*(MAX_AI_THINKING-MIN_AI_THINKING);6E4===parseInt(this.iMinutes)&&(d=MIN_AI_THINKING);null!==a&&setTimeout(function(){s_oGame._oThinking.hide();console.log(a);var c=a.cell.logic_pos,f=a.path.terminal;s_oGame._activeMandatoryCells(!1);s_oGame._selectPiece(c.row,c.col);s_oGame._movePiece(f.row,f.col)},d)};
CGameSingle.prototype.unload=function(){this._bStartGame=!1;clearTimeout(this._iIDTimeoutAI);this._oInterface.unload();null!==this._oEndPanel&&this._oEndPanel.unload();createjs.Tween.removeAllTweens();s_oStage.removeAllChildren()};CGameSingle.prototype.onExit=function(){s_oGame.unload();s_oMain.gotoMenu()};
CGameSingle.prototype.setEndPanel=function(a){this._oEndPanel=new CEndPanel(s_oSpriteLibrary.getSprite("msg_box"));this._oEndPanel.setRestartBut(s_oGame._onConfirmRematch,s_oGame);this._oEndPanel.setCheckBut(function(){s_oGame.checkBoard(a)},s_oGame);this._oEndPanel.setHomeBut(s_oGame.onExit,s_oGame);setTimeout(function(){s_oGame._oEndPanel.show(a,s_oGame._iBlackTime,s_oGame._iWhiteTime,s_oGame._iBlackScore,s_oGame._iWhiteScore,s_oGame._iGameTypeIndex)},1E3)};
CGameSingle.prototype._onConfirmRematch=function(){this.restartGame();this.initTime()};CGameSingle.prototype.checkBoard=function(){var a=new createjs.Shape;a.graphics.beginFill("rgba(0,0,0,0.01)").drawRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT);a.on("click",s_oGame.returnToEndPanel,s_oGame,!0,a);s_oStage.addChild(a);this._oEndPanel.hide()};CGameSingle.prototype.returnToEndPanel=function(a,d){s_oStage.removeChild(d);this._oEndPanel.reShow()};CGameSingle.prototype.restartGame=function(){CGameBase.prototype.restartGame()};
CGameSingle.prototype._decreaseTime=function(){this._iCurPlayer===WHITE?(this._iWhiteTime-=s_iTimeElaps,this._iWhiteScore-=SCORE_DECREASE_PER_SECOND*s_iTimeElaps/1E3,0>this._iWhiteScore&&(this._iWhiteScore=0),0>this._iWhiteTime&&(this._iWhiteTime=0,this._bStartGame=!1,this.setEndPanel(TIME_OVER)),this._oInterface.refreshWhiteTime(this._iWhiteTime)):(this._iBlackTime-=s_iTimeElaps,this._iBlackScore-=SCORE_DECREASE_PER_SECOND*s_iTimeElaps/1E3,0>this._iBlackScore&&(this._iBlackScore=0),0>this._iBlackTime&&
(clearTimeout(this._iAITimeoutID),this._iBlackTime=0,this._bStartGame=!1,this.setEndPanel(TIME_OVER)),this._oInterface.refreshBlackTime(this._iBlackTime))};function CGameMulti(a,d,c){this._oCurMoveToSend=null;this._bDrawAsked;this._oMoveTimeController;CGameBase.call(this,a,c);this._startGame(d)}CGameMulti.prototype=Object.create(CGameBase.prototype);
CGameMulti.prototype._startGame=function(a){this._oInterface=new CInterfaceMulti(this._oInfoPanelContainer);this._bWhiteBotSide=s_oNetworkManager.isUserA();this._oInterface.configureInfoPanel(this._bWhiteBotSide);this._bDrawAsked=!1;this._iMinutes=a;this._iGameTypeIndex=MATCH_MINUTES_TYPE.indexOf(s_oNetworkManager.getMinutesMatch());this._iAnimationTime=ANIM_TIME_MOVE_TYPE[this._iGameTypeIndex];this._bNoTime=!1;0===parseInt(a)&&(this._bNoTime=!0,this._oInterface.showTime(!1));this._iBlackTime=this._iWhiteTime=
this._iMinutes;this._oInterface.refreshWhiteTime(this._iWhiteTime);this._oInterface.refreshBlackTime(this._iBlackTime);s_oInterface.setPlayersInfo(s_oNetworkManager.getNicknameByID(0),s_oNetworkManager.getNicknameByID(1));this.initTime();this.rotateBoard(this._bWhiteBotSide);this._oInterface.addDrawOption();this._oInterface.addSurrenderOption();this._oInterface.addStatsOption();this._oMoveTimeController=new CMoveTimeController(-4,-8,this._oInfoPanelContainer,TIME_PER_MOVE[this._iGameTypeIndex]);this._oMoveTimeController.addEventListener(ON_TIMER_END,
this._onTimerEnd,this);this._oMoveTimeController.showAttempt(!1);this._oMoveTimeController.setHurryUpMode(TIME_HURRYUP_WARNING[this._iGameTypeIndex]);s_oNetworkManager.isUserA()&&this._oMoveTimeController.startTimer();this.refreshControllerObjects();this._checkTurn();this.updateStats();s_oNetworkManager.addEventListener(ON_DISCONNECTION_FROM_MATCH,this.playerDisconnectedFromGame)};
CGameMulti.prototype.refreshControllerObjects=function(){var a=-400,d=2*TIME_CONTROLLER_RADIUS+434;s_bLandscape&&(a=760,d=250,2<s_iAspectRatio&&(a=880,d=384));this._oMoveTimeController&&this._oMoveTimeController.setPos(a,d)};
CGameMulti.prototype._movePiece=function(a,d){this._iPlayerState=PLAYER_STATE_MOVING;var c=this._getPath(a,d);this._disableAllHighlight();this._highlightFromPath(c,!0);for(var f=0;f<c.jump_list.length;f++){var g=c.jump_list[f],b=g.dest;g.pos=this._aCell[b.row][b.col].getPos()}this._oCellActive.move(c.jump_list,this._iAnimationTime);this._oCurMoveToSend=this._oPathChosen=c;this._oMoveTimeController.stopTimer();c={};c[MSG_MOVE]=this._oCurMoveToSend;s_oNetworkManager.sendMsg(MSG_MOVE,JSON.stringify(c))};
CGameMulti.prototype.remoteMovePiece=function(a){this._disableAllHighlight();var d=s_oBoardStateController.copyBoard(this._aCell);this._aAllAvailablePath=s_oMovesController.getMovesList(a.src.row,a.src.col,d);this._oPathDrawer.clear();this._highlightAllPaths();this._disableAllHighlight();this._highlightFromPath(a,!0);this._oPathChosen=a;this._oCellActive=this._aCell[a.src.row][a.src.col];this._oCellActive.setActive(!0);this._oCellActive.move(this._oPathChosen.jump_list,this._iAnimationTime)};
CGameMulti.prototype.changeTurn=function(){this._iPlayerState=PLAYER_STATE_WAIT;this._oCurMoveToSend=null;this._disableAllHighlight();this._iCurPlayer=s_oBoardStateController.getOtherOpponent(this._iCurPlayer);this._checkTurn();this._checkLegalMoves()};
CGameMulti.prototype._checkTurn=function(){this._iCurPlayer===WHITE?s_oNetworkManager.isUserA()?(this._oThinking.hide(),this._oMoveTimeController.startTimer(),this._checkLegalMoves()):this._oThinking.show():s_oNetworkManager.isUserA()?this._oThinking.show():(this._oThinking.hide(),this._oMoveTimeController.startTimer(),this._checkLegalMoves());this._oInterface.activePlayer(this._iCurPlayer)};
CGameMulti.prototype.unload=function(){this._bStartGame=!1;this._oInterface.unload();null!==this._oEndPanel&&this._oEndPanel.unload();this._oMoveTimeController.unload();createjs.Tween.removeAllTweens();s_oStage.removeAllChildren();s_oNetworkManager.addEventListener(ON_DISCONNECTION_FROM_MATCH,function(){})};
CGameMulti.prototype.onExit=function(){document.dispatchEvent(new CustomEvent("end_session"));document.dispatchEvent(new CustomEvent("show_interlevel_ad"));s_oGame.unload();s_oMain.gotoMenu();s_oNetworkManager.disconnect()};CGameMulti.prototype.onDrawToggle=function(){this._bDrawAsked=!this._bDrawAsked;var a=s_oNetworkManager.isUserA()?WHITE:BLACK;this._bDrawAsked?this._oInterface.setDrawState(a):this._oInterface.disableDrawState(a);s_oNetworkManager.sendMsg(MSG_DRAW_STATE,this._bDrawAsked)};
CGameMulti.prototype.onOpponentDraw=function(a){console.log("Opponent draw:"+a);var d=s_oNetworkManager.isUserA()?BLACK:WHITE;a?(this._oInterface.notifyOpponentDraw(d),this._oInterface.notifyAnimation()):this._oInterface.disableNotifyDraw(d)};
CGameMulti.prototype.onSurrender=function(){console.log("Opponent onSurrender");var a=new CMsgBox(TEXT_SURRENDER);a.addButton(s_oSpriteLibrary.getSprite("but_yes"),ON_MOUSE_UP,function(){a.unload();s_oNetworkManager.sendMsg(MSG_SURRENDER,"")},this);a.addButton(s_oSpriteLibrary.getSprite("but_no"),ON_MOUSE_UP,function(){a.unload()},this)};CGameMulti.prototype.updateTimeFromServer=function(a,d){this._iWhiteTime=a;this._iBlackTime=d};
CGameMulti.prototype._decreaseTime=function(){this._iCurPlayer===WHITE?(this._iWhiteTime-=s_iTimeElaps,0>this._iWhiteTime&&(this._iWhiteTime=0),this._oInterface.refreshWhiteTime(this._iWhiteTime),this._iWhiteScore-=SCORE_DECREASE_PER_SECOND*s_iTimeElaps/1E3,0>this._iWhiteScore&&(this._iWhiteScore=0),this._oInterface.refreshWhiteScore(Math.floor(this._iWhiteScore))):(this._iBlackTime-=s_iTimeElaps,0>this._iBlackTime&&(this._iBlackTime=0),this._oInterface.refreshBlackTime(this._iBlackTime),this._iBlackScore-=
SCORE_DECREASE_PER_SECOND*s_iTimeElaps/1E3,0>this._iBlackScore&&(this._iBlackScore=0),this._oInterface.refreshBlackScore(Math.floor(this._iBlackScore)))};CGameMulti.prototype.checkBoard=function(){var a=new createjs.Shape;a.graphics.beginFill("rgba(0,0,0,0.01)").drawRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT);a.on("click",s_oGame.returnToEndPanel,s_oGame,!0,a);s_oStage.addChild(a);this._oEndPanel.hide()};CGameMulti.prototype.returnToEndPanel=function(a,d){s_oStage.removeChild(d);this._oEndPanel.reShow()};
CGameMulti.prototype.setEndPanel=function(a){this._oMoveTimeController.stopTimer();s_oNetworkManager.sendMsg(MSG_END_MATCH,a)};
CGameMulti.prototype.showRematchPanel=function(a,d){this._oMoveTimeController.stopTimer();this._oInterface.stopNotifyAnimation();this._oInterface.refreshWhiteTime(this._iWhiteTime);this._oInterface.refreshBlackTime(this._iBlackTime);console.log(this._iWhiteTime);this._oEndPanel=new CEndPanel(s_oSpriteLibrary.getSprite("msg_box"));this._oEndPanel.show(a,this._iBlackTime,this._iWhiteTime,this._iBlackScore,this._iWhiteScore,this._iGameTypeIndex);if(d===SURRENDER){var c=TEXT_YOU_RESIGNED;s_oNetworkManager.isUserA()&&
a===WHITE&&(c=TEXT_OPPONENT_RESIGNED);s_oNetworkManager.isUserA()||a!==BLACK||(c=TEXT_OPPONENT_RESIGNED);this._oEndPanel.setMsgText(c)}this._oEndPanel.setRestartBut(s_oGame._onConfirmRematch,s_oGame);this._oEndPanel.setCheckBut(s_oGame.checkBoard,s_oGame);this._oEndPanel.setHomeBut(s_oGame.onExit,s_oGame)};
CGameMulti.prototype._onConfirmRematch=function(){this._oEndPanel.unload();this._oEndPanel=new CMsgBox(TEXT_WAIT_OPPONENT);this._oEndPanel.centerMessage();s_oNetworkManager.sendMsg(MSG_ACCEPT_REMATCH,"")};
CGameMulti.prototype.onOpponentRefuseRematch=function(){this._oEndPanel.unload();this._oEndPanel=new CMsgBox(TEXT_OPPONENT_LEFT);this._oEndPanel.addButton(s_oSpriteLibrary.getSprite("but_home"),ON_MOUSE_UP,this.onExit,this);this._oEndPanel.addButton(s_oSpriteLibrary.getSprite("but_show"),ON_MOUSE_UP,this.checkBoard,this)};
CGameMulti.prototype.onNotifyAcceptRematch=function(){var a=s_oNetworkManager.isUserA()?1:0;a=sprintf(TEXT_REMATCH_ALERT,s_oNetworkManager.getNicknameByID(a));this._oEndPanel.setMsgFooter(a.toUpperCase());this._oEndPanel.notifyRestart()};
CGameMulti.prototype.onOpponentAcceptRematch=function(){s_oNetworkManager.isUserA()?(this._oThinking.hide(),this._oMoveTimeController.startTimer()):this._oThinking.show();s_oGame.restartGame();this._bDrawAsked=!1;this._oInterface.disableDrawState(WHITE);this._oInterface.disableDrawState(BLACK);this.initTime()};
CGameMulti.prototype.playerDisconnectedFromGame=function(){s_oGame._oEndPanel&&s_oGame._oEndPanel.unload();s_oGame._oEndPanel=new CMsgBox(TEXT_CONNECTION_LOST);s_oGame._oEndPanel.addButton(s_oSpriteLibrary.getSprite("but_yes"),ON_MOUSE_UP,s_oGame.onExit,s_oGame);s_oNetworkManager.sendMsg(MSG_DISCONNECTION,"")};
CGameMulti.prototype.opponentLeftTheGame=function(){this._bStartGame=!1;this._oMoveTimeController.stopTimer();this._oEndPanel=new CMsgBox(TEXT_OPPONENT_LEFT);this._oEndPanel.addButton(s_oSpriteLibrary.getSprite("but_yes"),ON_MOUSE_UP,this.onExit,this);s_oNetworkManager.isUserA()?this._oEndPanel.setExplMsg(insertInRoundBracket(sprintf(TEXT_WINS,TEXT_WHITE))):this._oEndPanel.setExplMsg(insertInRoundBracket(sprintf(TEXT_WINS,TEXT_BLACK)))};
CGameMulti.prototype._onTimerEnd=function(){s_oNetworkManager.disconnect();this._bStartGame=!1;this._oEndPanel=new CMsgBox(TEXT_PLAYER_KICKED);this._oEndPanel.addButton(s_oSpriteLibrary.getSprite("but_yes"),ON_MOUSE_UP,this.onExit,this)};function CGameSingleWithBot(a,d,c){this._bDrawAsked;this._iAITimeoutID;this._oMoveTimeController;console.log(d,c);CGameSingle.call(this,a,d,c)}CGameSingleWithBot.prototype=Object.create(CGameSingle.prototype);
CGameSingleWithBot.prototype._startGame=function(a){this._oInterface=new CInterfaceMulti(this._oInfoPanelContainer);this._bWhiteBotSide=!0;this._oInterface.configureInfoPanel(this._bWhiteBotSide);this._bDrawAsked=!1;this._iMinutes=a;this._iGameTypeIndex=MATCH_MINUTES_TYPE.indexOf(a);this._bNoTime=!1;0===parseInt(a)&&(this._bNoTime=!0,this._oInterface.showTime(!1));this._iMinutes=6E4*MATCH_MINUTES_TYPE[this._iGameTypeIndex];this._iAnimationTime=ANIM_TIME_MOVE_TYPE[this._iGameTypeIndex];this._iBlackTime=
this._iWhiteTime=this._iMinutes;this._oInterface.refreshWhiteTime(this._iWhiteTime);this._oInterface.refreshBlackTime(this._iBlackTime);s_oInterface.setPlayersInfo(s_oNetworkManager.getPlayerNickname(),s_oNetworkManager.getBotName());this.initTime();this.rotateBoard(this._bWhiteBotSide);this._oInterface.addDrawOption();this._oInterface.addSurrenderOption();this._oInterface.addStatsOption();this._oMoveTimeController=new CMoveTimeController(-4,-8,this._oInfoPanelContainer,TIME_PER_MOVE[this._iGameTypeIndex]);
this._oMoveTimeController.addEventListener(ON_TIMER_END,this._onTimerEnd,this);this._oMoveTimeController.showAttempt(!1);this._oMoveTimeController.setHurryUpMode(TIME_HURRYUP_WARNING[this._iGameTypeIndex]);this._oMoveTimeController.startTimer();this.refreshControllerObjects();this._oAI=new CAIController(this._oPiecesValue);this._oAI.addEventListener(ON_END_AI_COMPUTATION,this._onEndAIComputation,this);this.updateStats()};
CGameSingleWithBot.prototype.refreshControllerObjects=function(){var a=-400,d=2*TIME_CONTROLLER_RADIUS+434;s_bLandscape&&(a=760,d=250,2<s_iAspectRatio&&(a=880,d=384));this._oMoveTimeController&&this._oMoveTimeController.setPos(a,d)};
CGameSingleWithBot.prototype._movePiece=function(a,d){this._oMoveTimeController.stopTimer();this._iPlayerState=PLAYER_STATE_MOVING;var c=this._getPath(a,d);this._disableAllHighlight();this._highlightFromPath(c,!0);for(var f=0;f<c.jump_list.length;f++){var g=c.jump_list[f],b=g.dest;g.pos=this._aCell[b.row][b.col].getPos()}this._oCellActive.move(c.jump_list,this._iAnimationTime);this._oPathChosen=c};
CGameSingleWithBot.prototype._playAI=function(a){a||(this._oThinking.show(),a=s_oBoardStateController.copyBoard(this._aCell),this._oAI.getMove(this._iCurPlayer,a))};
CGameSingleWithBot.prototype._onEndAIComputation=function(a){var d=MIN_AI_THINKING+Math.random()*(MAX_AI_THINKING-MIN_AI_THINKING);6E4===parseInt(this.iMinutes)&&(d=MIN_AI_THINKING);null!==a&&setTimeout(function(){s_oGame._oThinking.hide();console.log(a);var c=a.cell.logic_pos,f=a.path.terminal;s_oGame._activeMandatoryCells(!1);s_oGame._selectPiece(c.row,c.col);s_oGame._movePiece(f.row,f.col)},d)};
CGameSingleWithBot.prototype._checkTurn=function(){this._iCurPlayer===WHITE?(this._oMoveTimeController.startTimer(),this._oThinking.hide()):(this._oThinking.show(),this._playAI());this._oInterface.activePlayer(this._iCurPlayer)};
CGameSingleWithBot.prototype.setEndPanel=function(a){this._oMoveTimeController.stopTimer();this._oEndPanel=new CEndPanel(s_oSpriteLibrary.getSprite("msg_box"));this._oEndPanel.setRestartBut(s_oGame._onConfirmRematch,s_oGame);this._oEndPanel.setCheckBut(function(){s_oGame.checkBoard(a)},s_oGame);this._oEndPanel.setHomeBut(s_oGame.onExit,s_oGame);setTimeout(function(){s_oGame._oEndPanel.show(a,s_oGame._iBlackTime,s_oGame._iWhiteTime,s_oGame._iBlackScore,s_oGame._iWhiteScore,s_oGame._iGameTypeIndex)},
1E3)};CGameSingleWithBot.prototype.checkBoard=function(){var a=new createjs.Shape;a.graphics.beginFill("rgba(0,0,0,0.01)").drawRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT);a.on("click",s_oGame.returnToEndPanel,s_oGame,!0,a);s_oStage.addChild(a);s_oGame._oEndPanel.hide()};CGameSingleWithBot.prototype.returnToEndPanel=function(a,d){s_oStage.removeChild(d);this._oEndPanel.reShow()};
CGameSingleWithBot.prototype._onConfirmRematch=function(){this._oEndPanel.unload();this._oEndPanel=new CMsgBox(TEXT_WAIT_OPPONENT);this._oEndPanel.centerMessage();var a=randomFloatBetween(200,2E3);if(.33<Math.random()).4<Math.random()?setTimeout(function(){s_oGame._rematch()},a):s_oGame._rematch();else if(.4<Math.random())setTimeout(function(){s_oGame.onBotRefuseRematch()},a);else s_oGame.onBotRefuseRematch()};
CGameSingleWithBot.prototype.onBotRefuseRematch=function(){this._oEndPanel.unload();this._oEndPanel=new CMsgBox(TEXT_OPPONENT_LEFT);this._oEndPanel.addButton(s_oSpriteLibrary.getSprite("but_yes"),ON_MOUSE_UP,this.onExit,this)};CGameSingleWithBot.prototype._rematch=function(){s_oGame.restartGame();this._iCurPlayer===WHITE&&this._oMoveTimeController.startTimer();this._bDrawAsked=!1;this._oInterface.disableDrawState(WHITE);this._oInterface.disableDrawState(BLACK);this.initTime()};
CGameSingleWithBot.prototype.onDrawToggle=function(){this._bDrawAsked=!this._bDrawAsked;var a=WHITE;this._bDrawAsked?this._oInterface.setDrawState(a):this._oInterface.disableDrawState(a)};CGameSingleWithBot.prototype.onSurrender=function(){var a=new CMsgBox(TEXT_SURRENDER);a.addButton(s_oSpriteLibrary.getSprite("but_yes"),ON_MOUSE_UP,function(){a.unload();s_oGame.setEndPanel(BLACK,SURRENDER)},this);a.addButton(s_oSpriteLibrary.getSprite("but_no"),ON_MOUSE_UP,function(){a.unload()},this)};
CGameSingleWithBot.prototype._onTimerEnd=function(){this._bStartGame=!1;this._oEndPanel=new CMsgBox(TEXT_PLAYER_KICKED);this._oEndPanel.addButton(s_oSpriteLibrary.getSprite("but_yes"),ON_MOUSE_UP,this.onExit,this)};
function CInfoTurn(a,d,c,f){var g,b,e,h,k,l,m,n,p,q,r,u,x;this._init=function(w,v,F,y){b=F;h=new createjs.Container;h.x=w;h.y=v;y.addChild(h);g=TOP;0<h.y&&(g=BOTTOM);e=!1;var t=s_oSpriteLibrary.getSprite("player_panel");y=t.width;var B=t.height/2;w=new createjs.SpriteSheet({images:[t],framerate:58,frames:{width:y,height:B,regX:y/2,regY:B/2},animations:{off:[0,0,"on"],on:[1,1,"off"],check:[2,2,"off"],correct:[3,3,"off"]}});k=createSprite(w,0,t.width/2/2,t.height/2,t.width/2,t.height);k.stop();h.addChild(k);
l=createSprite(w,"on",t.width/2/2,t.height/2,t.width/2,t.height);l.stop();l.alpha=0;h.addChild(l);w=124;w=g===BOTTOM?-w:w;t=s_oSpriteLibrary.getSprite(F+"_marker");n=createBitmap(t);n.x=w;n.y=50;n.regX=t.width/2;n.regY=t.height;n.scale=.55;h.addChild(n);w=85;w=g===BOTTOM?-w:w;t=g===BOTTOM?"left":"right";m=new createjs.Text("00:00"," 36px "+PRIMARY_FONT,"#ffffff");m.x=w;m.y=42;m.textAlign=t;m.textBaseline="alphabetic";m.lineWidth=200;h.addChild(m);y=220;var L=k.getBounds().width/2+140;v=0;w=40;g===
BOTTOM&&(L=-k.getBounds().width/2-140,v=-v,w=-40);B=30;p=new CTLText(h,w-y/2,-35-B/2,y,B,30,t,"#fff",PRIMARY_FONT,1,2,2,TEXT_PLAYER,!0,!0,!1,!1);w=L;y=240;B=100;q=new CTLText(h,w-y/2,v-B/2,y,B,30,"center","#fff",PRIMARY_FONT,1.1,2,2," ",!0,!0,!0,!1);q.setVisible(!1);v=F===WHITE?BLACK:WHITE;y=[KING,PAWN];F=g===BOTTOM?-1:1;w=-130*F;x=[];for(B=0;B<y.length;B++)t=y[B],L=new CCapturedCounter(w,10,t,v,h),L.setNum(0),w+=50*F,x[t]=L;t=g===BOTTOM?"right":"left";y=90;B=30;v=32;F=g===BOTTOM?1:-1;w=110*F;r=new CTLText(h,
w-y/2,v-B/2,y,B,30,t,"#fff",PRIMARY_FONT,1,2,2,"50.0%",!0,!0,!0,!1);t=s_oSpriteLibrary.getSprite("arrow_equal");u=createBitmap(t);u.x=w-55*F;u.y=v;u.regX=t.width/2;u.regY=t.height/2;u.scale=.6;h.addChild(u);this.refreshNotifyPos()};this.setTimeVisible=function(w){m.visible=w};this.refreshTime=function(w){m.text=w};this.refreshScore=function(w){};this.setEndMode=function(){m.textAlign="left";m.color=FONT_COLOR;m.x=0;m.y=20;m.font="50px "+PRIMARY_FONT;n.scale=.8;n.x=-80;this.setName(" ");this.setBgVisible(!1);
for(var w in x)x[w].unload();u.visible=!1;r.setVisible(!1)};this.active=function(w){w?(e?l.gotoAndStop("check"):l.gotoAndStop("on"),k.alpha=0,l.alpha=1):(k.alpha=1,l.alpha=0)};this.unload=function(){f.removeChild(h)};this.getSide=function(){return g};this.setPosition=function(w,v){h.x=w;h.y=v};this.setBgVisible=function(w){k.visible=w};this.setPanelVisible=function(w){h.visible=w};this.setName=function(w){p.refreshText(w);p.setVisible(!0)};this.setPawn=function(w){b=w;w=s_oSpriteLibrary.getSprite(w+
"_king_marker");n.image=w;w=b===WHITE?BLACK:WHITE;for(var v in x)x[v].setColor(w)};this.getType=function(){return b};this.refreshNotifyPos=function(){var w=q.getWidth();if(s_bLandscape){var v=50;if(1.6>=s_iAspectRatio){var F="left",y=-v,t=130;g===BOTTOM&&(t=-t)}else F="right",y=v,t=130,g===BOTTOM&&(F="left",y=-v,t=-t)}else F="left",v=130,y=k.getBounds().width/2+v,t=0,g===BOTTOM&&(F="right",y=-k.getBounds().width/2-v);q.setPosition(y-w/2,t-50);q.setHorizontalAlign(F)};this.setNotify=function(w){q.refreshText(w);
q.setVisible(!0)};this.disableNotify=function(){q.setVisible(!1)};this.setCapturedList=function(w){for(var v in x)x[v].reset();for(v=0;v<w.length;v++)x[w[v].type].increase()};this.setPercent=function(w){r.refreshText(w+"%");var v=s_oSpriteLibrary.getSprite("arrow_equal");50<w?v=s_oSpriteLibrary.getSprite("arrow_up"):50>w&&(v=s_oSpriteLibrary.getSprite("arrow_down"));u.image=v};this._init(a,d,c,f)}
function CThinking(){var a,d,c;this._init=function(){a=new createjs.Container;var f=(new createjs.Graphics).beginFill("rgba(0,0,0,0.3)").drawRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT);d=new createjs.Shape(f);c=d.on("click",function(){});a.addChild(d);s_oStage.addChild(a)};this.show=function(){a.visible=!0};this.hide=function(){a.visible=!1};this.isVisible=function(){return a.visible};this.unload=function(){d.off("click",c);s_oStage.removeChild(a)};this._init()}
function CEndPanel(a){var d,c,f,g,b,e,h,k,l,m,n,p,q;this._init=function(r){s_oGame.pauseGame(!0);f=new createjs.Container;f.alpha=0;f.visible=!1;s_oStage.addChild(f);l=new createjs.Shape;l.graphics.beginFill("black").drawRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT);l.alpha=.7;f.addChild(l);c=createBitmap(r);c.regX=r.width/2;c.regY=r.height/2;c.x=CANVAS_WIDTH/2;c.y=CANVAS_HEIGHT/2;f.addChild(c);var u=r.width-120,x=100,w=CANVAS_WIDTH/2,v=CANVAS_HEIGHT/2-300;e=new CTLText(f,w-u/2,v-x/2,u,x,90,"center",FONT_COLOR,
PRIMARY_FONT,1,2,2,"",!0,!0,!1,!1);u=r.width-150;x=50;w=CANVAS_WIDTH/2;v=CANVAS_HEIGHT/2-230;h=new CTLText(f,w-u/2,v-x/2,u,x,40,"center",FONT_COLOR,PRIMARY_FONT,1,2,2,"",!0,!0,!1,!1);g=new CInfoTurn(CANVAS_WIDTH/2,950,BLACK,f);g.setEndMode();b=new CInfoTurn(CANVAS_WIDTH/2,850,WHITE,f);b.setEndMode();d=CANVAS_HEIGHT/2+200;u=r.width-150;x=50;w=CANVAS_WIDTH/2;v=d+130;k=new CTLText(f,w-u/2,v-x/2,u,x,40,"center",FONT_COLOR,PRIMARY_FONT,1,2,2," ",!0,!0,!1,!1);this._initListener()};this.unload=function(){s_oStage.removeChild(f);
f.off("mousedown",q);p.unload();m.unload();n.unload();g.unload();b.unload();document.dispatchEvent(new CustomEvent("end_session"));document.dispatchEvent(new CustomEvent("show_interlevel_ad"))};this._initListener=function(){q=f.on("mousedown",function(){})};this.setRestartBut=function(r,u){var x=s_oSpriteLibrary.getSprite("but_restart");p=new CGfxButton(CANVAS_WIDTH/2-180,d,x,f);p.addEventListener(ON_MOUSE_UP,r,u)};this.setHomeBut=function(r,u){var x=s_oSpriteLibrary.getSprite("but_home");m=new CGfxButton(CANVAS_WIDTH/
2,d,x,f);m.addEventListener(ON_MOUSE_UP,r,u)};this.setCheckBut=function(r,u){var x=s_oSpriteLibrary.getSprite("but_show");n=new CGfxButton(CANVAS_WIDTH/2+180,d,x,f);n.addEventListener(ON_MOUSE_UP,r,u)};this.setMsgFooter=function(r){k.refreshText(r)};this.notifyRestart=function(){p.trembleAnimation()};this.show=function(r,u,x,w,v,F){768<=getSize("Width")&&(document.querySelector("#div_display_id").style.display="block");g.refreshTime(formatTime(u));b.refreshTime(formatTime(x));switch(r){case WHITE:playSound("win",
1,!1);e.refreshText(sprintf(TEXT_WINS,TEXT_WHITE));break;case BLACK:s_iGameType===MODE_HUMAN?playSound("win",1,!1):playSound("game_over",1,!1);e.refreshText(sprintf(TEXT_WINS,TEXT_BLACK));break;case WIN_WHITE_BLACK_NOMOVES:playSound("win",1,!1);e.refreshText(TEXT_MOVES_AVAIL);h.refreshText(insertInRoundBracket(sprintf(TEXT_WINS,TEXT_WHITE)));break;case WIN_BLACK_WHITE_NOMOVES:s_iGameType===MODE_HUMAN?playSound("win",1,!1):playSound("game_over",1,!1);e.refreshText(TEXT_MOVES_AVAIL);h.refreshText(insertInRoundBracket(sprintf(TEXT_WINS,
TEXT_BLACK)));break;case DRAW:playSound("game_over",1,!1);e.refreshText(TEXT_DRAW);break;case DRAW_AGREED:playSound("game_over",1,!1);e.refreshText(TEXT_DRAW);h.refreshText(TEXT_PLAYER_AGREED_TO_DRAW);break;case TIME_OVER:e.refreshText(TEXT_TIME_OVER),u<x?h.refreshText(insertInRoundBracket(sprintf(TEXT_WINS,TEXT_WHITE))):h.refreshText(insertInRoundBracket(sprintf(TEXT_WINS,TEXT_BLACK)))}f.visible=!0;createjs.Tween.get(f).to({alpha:1},500);document.dispatchEvent(new CustomEvent("save_score",{detail:{winner:r,
black_time:u,white_time:x,type:s_iGameType,white_score:v,black_score:w,time_index:F}}));document.dispatchEvent(new CustomEvent("share_event",{detail:{type:s_iGameType,white_score:v,winner:r}}))};this.hide=function(){document.querySelector("#div_display_id").style.display="none";f.visible=!1;document.dispatchEvent(new CustomEvent("end_session"))};this.reShow=function(){f.visible=!0};this.setMsgText=function(r){e.refreshText(r)};this.setExpText=function(r){h.refreshText(r)};this._init(a);return this}
function CCell(a,d,c,f,g){var b,e,h,k,l,m,n,p,q,r,u,x,w,v,F;this._init=function(y,t,B,L){b=B.row;e=B.col;h=0;k=[];l=[];m=new createjs.Container;m.x=y;m.y=t;L.addChild(m);y=s_oSpriteLibrary.getSprite("highlight_last_move");p=createBitmap(y);p.regX=y.width/2;p.regY=y.height/2;p.alpha=1;p.visible=!1;m.addChild(p);y=s_oSpriteLibrary.getSprite("highlight_capture");q=createBitmap(y);q.regX=y.width/2;q.regY=y.height/2;q.alpha=1;q.visible=!1;m.addChild(q);y=s_oSpriteLibrary.getSprite("highlight_landing");
r=createBitmap(y);r.regX=y.width/2;r.regY=y.height/2;r.alpha=1;r.visible=!1;m.addChild(r);u=new createjs.Shape;u.graphics.beginFill("rgba(158,0,0,0.01)").drawRect(-g/2,-g/2,g,g);x=u.on("mousedown",this._onCellDown,this);w=u.on("pressup",this._onCellUp,this);m.addChild(u);n=null};this.unload=function(){f.removeChild(m);u.off("mousedown",x);u.off("pressup",w)};this.addEventListener=function(y,t,B){k[y]=t;l[y]=B};this.addOverListeners=function(){v=u.on("mouseout",this._onCellOut,this,!0);F=u.on("mouseover",
this._onCellOver,this,!0)};this.removeOverListeners=function(){u.off("mouseout",v);u.off("mouseover",F)};this.setClickableArea=function(y){u.visible=y};this.createPiece=function(y,t){n=new CPiece(a,d,y,t,f);this.rotatePiece(h);return n};this.rotatePiece=function(y){h=y;n&&n.rotate(y)};this.captureHighlight=function(y){q.visible=y};this.setLastMove=function(y){p.visible=y};this.setLanding=function(y){r.visible=y};this.isLanding=function(){return r.visible};this.setActive=function(y){null!==n&&n.setActive(y)};
this._onCellDown=function(){k[ON_MOUSE_DOWN]&&k[ON_MOUSE_DOWN].call(l[ON_MOUSE_DOWN],b,e);v=u.on("mouseout",this._onCellOut,this,!0)};this._onCellUp=function(){k[ON_MOUSE_UP]&&k[ON_MOUSE_UP].call(l[ON_MOUSE_UP],b,e)};this._onCellOver=function(){k[ON_MOUSE_OVER]&&k[ON_MOUSE_OVER].call(l[ON_MOUSE_OVER],b,e);v=u.on("mouseout",this._onCellOut,this,!0)};this._onCellOut=function(){k[ON_MOUSE_OUT]&&k[ON_MOUSE_OUT].call(l[ON_MOUSE_OUT],b,e);F=u.on("mouseover",this._onCellOver,this,!0)};this.getType=function(){return null!==
n?n.getType():null};this.getColor=function(){return null!==n?n.getColor():null};this.setVisible=function(y){m.visible=y};this.setPiece=function(y){n=y};this.getX=function(){return a};this.getY=function(){return d};this.getGlobalX=function(){return m.localToGlobal(0,0).x};this.getGlobalY=function(){return m.localToGlobal(0,0).y};this.getPos=function(){return{x:a,y:d}};this.getLogicPos=function(){return{row:b,col:e}};this.remove=function(){n&&(n.unload(),n=null)};this.move=function(y,t){n&&(n.move(y,
t,this),n=null)};this.setCaptured=function(){n&&(n.disappear(),n=null)};this.unlitAll=function(y,t){var B={value:1},L=createjs.Tween.get(B,{});L.wait(t).to({value:0},y);L.on("change",function(){q.alpha=B.value;r.alpha=B.value;0===B.value&&(q.alpha=1,r.alpha=1,q.visible=!1,r.visible=!1)},this)};this.getPiece=function(){return n};this.getPieceInfo=function(){var y=this.getLogicPos(),t=null,B=null;n&&(t=n.getType(),B=n.getColor());return{type:t,color:B,logic_pos:y}};this._init(a,d,c,f)}
function CAreYouSurePanel(a){var d,c,f,g,b,e,h;this._init=function(l){b=new createjs.Shape;b.graphics.beginFill("black").drawRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT);b.alpha=0;h=b.on("mousedown",function(){});s_oStage.addChild(b);(new createjs.Tween.get(b)).to({alpha:.7},500);e=new createjs.Container;s_oStage.addChild(e);l=s_oSpriteLibrary.getSprite("msg_box");var m=createBitmap(l);m.regX=l.width/2;m.regY=l.height/2;e.addChild(m);e.x=CANVAS_WIDTH/2;e.y=CANVAS_HEIGHT+l.height/2;d=e.y;(new createjs.Tween.get(e)).to({y:CANVAS_HEIGHT/
2},500,createjs.Ease.cubicOut);m=l.width-100;c=new CTLText(e,-(m/2),-l.height/2+200-125,m,250,100,"center",FONT_COLOR,PRIMARY_FONT,1,2,2,TEXT_ARE_SURE,!0,!0,!0,!1);f=new CGfxButton(170,80,s_oSpriteLibrary.getSprite("but_yes"),e);f.addEventListener(ON_MOUSE_UP,this._onButYes,this);g=new CGfxButton(-170,80,s_oSpriteLibrary.getSprite("but_no"),e);g.addEventListener(ON_MOUSE_UP,this._onButNo,this);g.pulseAnimation()};this._onButYes=function(){g.setClickable(!1);f.setClickable(!1);(new createjs.Tween.get(b)).to({alpha:0},
500);(new createjs.Tween.get(e)).to({y:d},400,createjs.Ease.backIn).call(function(){k.unload();a()})};this._onButNo=function(){g.setClickable(!1);f.setClickable(!1);(new createjs.Tween.get(b)).to({alpha:0},500);(new createjs.Tween.get(e)).to({y:d},400,createjs.Ease.backIn).call(function(){k.unload()})};this.changeMessage=function(l){c.refreshText(l)};this.unload=function(){g.unload();f.unload();s_oStage.removeChild(b);s_oStage.removeChild(e);b.off("mousedown",h)};var k=this;this._init(a)}
function CMsgBox(a){var d,c,f,g,b,e,h,k;this._init=function(l){g=new createjs.Shape;g.graphics.beginFill("black").drawRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT);g.alpha=0;g.on("mousedown",function(){});s_oStage.addChild(g);createjs.Tween.get(g).to({alpha:.7},500);b=new createjs.Container;s_oStage.addChild(b);var m=s_oSpriteLibrary.getSprite("msg_box"),n=createBitmap(m);n.regX=m.width/2;n.regY=m.height/2;b.addChild(n);b.x=CANVAS_WIDTH/2;b.y=CANVAS_HEIGHT/2;f=l;m=m.width-120;e=new CTLText(b,-(m/2),-290,m,
180,80,"center",FONT_COLOR,PRIMARY_FONT,1,2,2,l,!0,!0,!0,!1);m=s_oSpriteLibrary.getSprite("but_exit");h=new CGfxButton(1310-CANVAS_WIDTH/2,610-CANVAS_HEIGHT/2,m,b);h.addEventListener(ON_MOUSE_UP,this.hide,this);h.setVisible(!1);k=new createjs.Container;k.y=180;b.addChild(k);d=[];c=[]};this.unload=function(){s_oStage.removeChild(g);s_oStage.removeChild(b);g.off("mousedown",function(){});for(var l=0;l<d.length;l++)d[l].unload();h.unload()};this.setMessage=function(l){f=l;e.refreshText(l)};this.setExplMsg=
function(l){var m=b.getBounds().width-120;new CTLText(b,-(m/2),-105,m,50,50,"center",FONT_COLOR,PRIMARY_FONT,1,2,2,l,!0,!0,!1,!1)};this.setMsgColor=function(l){e.setColor(l)};this.addButton=function(l,m,n,p,q){var r=new CGfxButton(d.length*(l.width+150),0,l,k);r.addEventListener(m,n,p);k.regX=k.getBounds().width/2-l.width/2;q&&(m=l.width-20,l=new CTLText(k,d.length*(l.width+150)-m/2,-250,m,100,50,"center","#2e1905",PRIMARY_FONT,1,2,2,q,!0,!0,!0,!1),c.push(l));d.push(r)};this.centerMessage=function(){e.setY(-100)};
this.show=function(){g.visible=!0;b.visible=!0};this.reShow=function(){g.visible=!0;b.visible=!0};this.hide=function(){g.visible=!1;b.visible=!1};this.showExitBut=function(){h.setVisible(!0)};this.setButtonContainerY=function(l){k.y=l};this.refreshLang=function(l){e.refreshText(f);for(var m=0;m<c.length;m++)c[m].refreshText(l[m])};this._init(a)}var NUM_ITEMS_PER_COLS=4;
function CLangPanel(a){var d,c,f,g,b,e,h,k,l,m,n,p,q=this;this._init=function(){h=!1;d=[];c=[];p=new createjs.Container;p.visible=!1;a.addChild(p);l=new createjs.Shape;l.graphics.beginFill("black").drawRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT);b=l.on("click",function(){});p.addChild(l);m=new createjs.Container;m.x=CANVAS_WIDTH/2;m.y=CANVAS_HEIGHT/2;p.addChild(m);e=s_oSpriteLibrary.getSprite("msg_box_small");var r=createBitmap(e);m.addChild(r);this._placeLanguages();k=new CGfxButton(e.width,0,s_oSpriteLibrary.getSprite("but_exit"),
m);k.addEventListener(ON_MOUSE_UP,this.hide,this);m.regX=e.width/2;m.regY=e.height/2};this.unload=function(){k.unload();l.off("click",b);for(var r=0;r<f.length;r++)f[r].off("pressup",g[r])};this.addEventListener=function(r,u,x){d[r]=u;c[r]=x};this.show=function(){k.setClickable(!0);h=!1;p.visible=!0;l.alpha=0;createjs.Tween.get(l).to({alpha:.7},400,createjs.Ease.cubicOut);m.scaleX=m.scaleY=.01;m.alpha=0;createjs.Tween.get(m).wait(400).to({scale:1,alpha:1},1E3,createjs.Ease.elasticOut).call(function(){})};
this.hide=function(){k.setClickable(!1);h=!0;createjs.Tween.get(l).to({alpha:0},400,createjs.Ease.cubicOut);createjs.Tween.get(m).to({scaleX:.1,scaleY:.1,alpha:.5},400,createjs.Ease.backIn).call(function(){p.visible=!1})};this._placeLanguages=function(){n=new createjs.Container;n.x=e.width/2;n.y=e.height/2;m.addChild(n);for(var r=s_oSpriteLibrary.getSprite("but_lang"),u={},x=0;x<NUM_LANGUAGES;x++)u["lang_"+x]=x;r=new createjs.SpriteSheet({images:[r],frames:{width:LANG_WIDTH,height:LANG_HEIGHT,regX:LANG_WIDTH/
2,regY:LANG_HEIGHT/2},animations:u});x=u=0;f=[];g=[];for(var w=0,v=0;v<NUM_LANGUAGES;v++){var F=createSprite(r,"lang_"+v,LANG_WIDTH/2,LANG_HEIGHT/2,LANG_WIDTH,LANG_HEIGHT);F.x=u;F.y=x;F.on("mousedown",this._onPressLang,this,!1,v);g[v]=F.on("pressup",this._onSelectLang,this,!1,v);n.addChild(F);f.push(F);w++;0<v&&0===w%NUM_ITEMS_PER_COLS?(u=0,x+=LANG_HEIGHT+10):u+=LANG_WIDTH+10}n.regX=LANG_WIDTH*NUM_ITEMS_PER_COLS/2-40;n.regY=x/2};this._onPressLang=function(r,u){h||(f[u].scale=.9)};this._onSelectLang=
function(r,u){h||(f[u].scale=1,console.log("iIndex "+u),d[ON_SELECT_LANG]&&d[ON_SELECT_LANG].call(c[ON_SELECT_LANG],u),q.hide())};this._init()}
function CButMenu(a,d,c,f,g,b,e,h){var k,l,m,n,p,q=null,r,u;this._init=function(x,w,v,F,y,t,B,L){k=1;l=[];m=[];n=new createjs.Container;n.x=x;n.y=w;n.regX=v.width/2;n.regY=v.height/2;L.addChild(n);n.cursor="pointer";x=createBitmap(v);n.addChild(x);p=new CTLText(n,180,20,v.width-220,v.height-52,B,"center",t,y,1,0,0,F.toUpperCase(),!0,!0,!0,!1);this._initListener()};this.unload=function(){n.off("mousedown",r);n.off("pressup",u);h.removeChild(n)};this.setVisible=function(x){n.visible=x};this._initListener=
function(){oParent=this;r=n.on("mousedown",this.buttonDown);u=n.on("pressup",this.buttonRelease)};this.addEventListener=function(x,w,v){l[x]=w;m[x]=v};this.buttonRelease=function(){n.scaleX=k;n.scaleY=k;l[ON_MOUSE_UP]&&l[ON_MOUSE_UP].call(m[ON_MOUSE_UP])};this.buttonDown=function(){n.scaleX=.9*k;n.scaleY=.9*k;playSound("click",1,!1);l[ON_MOUSE_DOWN]&&l[ON_MOUSE_DOWN].call(m[ON_MOUSE_DOWN])};this.changeText=function(x){p.refreshText(x)};this.setPosition=function(x,w){n.x=x;n.y=w};this.setX=function(x){n.x=
x};this.setY=function(x){n.y=x};this.setScale=function(x){k=x;n.scale=x};this.addAlert=function(){q=new CAlertIcon(c.width-10,10,"1",n);q.pulseAnimation()};this.removeAlert=function(){null!==q&&n.removeChild(q)};this.getButtonImage=function(){return n};this.getX=function(){return n.x};this.getY=function(){return n.y};this._init(a,d,c,f,g,b,e,h);return this}
var LOCALSTORAGE_TIMEMODE="pref_time_mode",LOCALSTORAGE_RULE_INDEX="pref_rule_index",LOCALSTORAGE_RULE_PRESET="pref_rule_preset",LOCALSTORAGE_ALERT_ACTIVE="alert_active_iter_0",s_iPrefTimeMode=0,s_szCurRule=RULE_ITALIAN,s_oRules=RULE_PRESET[s_szCurRule],s_bAlertActive=!0;
function CLocalStorage(a){var d=!0;this._init=function(c){try{var f=window.localStorage.getItem(c);this.resetData();null!==f&&void 0!==f&&this.loadData()}catch(g){this.resetData()}};this.isDirty=function(){return!1};this.isUsed=function(){try{window.localStorage.setItem("ls_available","ok")}catch(c){d=!1}return d};this.resetData=function(){s_iPrefTimeMode=0;s_szCurRule=RULE_ITALIAN;s_oRules=RULE_PRESET[s_szCurRule];s_bAlertActive=!0};this.deleteData=function(){window.localStorage.removeItem(a)};this.saveData=
function(){var c={};c[LOCALSTORAGE_TIMEMODE]=s_iPrefTimeMode;c[LOCALSTORAGE_RULE_INDEX]=s_szCurRule;c[LOCALSTORAGE_RULE_PRESET]=s_oRules;c[LOCALSTORAGE_ALERT_ACTIVE]=s_bAlertActive;window.localStorage.setItem(a,JSON.stringify(c))};this.loadData=function(){var c=JSON.parse(window.localStorage.getItem(a));s_iPrefTimeMode=parseInt(c[LOCALSTORAGE_TIMEMODE]);s_szCurRule=c[LOCALSTORAGE_RULE_INDEX];s_oRules=copyObjectByValue(c[LOCALSTORAGE_RULE_PRESET]);s_bAlertActive=c[LOCALSTORAGE_ALERT_ACTIVE];c=0;for(var f in RULE_PRESET)RULE_PRESET[f].id===
s_oRules.id&&(c=RULES_ORDER.indexOf(f));s_iCurRuleFlag=c};this._init(a)}
function CGUIExpandible(a,d,c,f){var g,b,e,h,k,l,m,n,p;this._init=function(r,u,x,w){h=[];k=[];m=new createjs.Container;m.x=r;m.y=u;w.addChild(m);n=new createjs.Container;m.addChild(n);p=new createjs.Container;m.addChild(p);e=!1;l=new CGfxButton(0,0,x,p);l.addEventListener(ON_MOUSE_UP,this._onMenu,this);b=g=120};this.unload=function(){l.unload();f.removeChild(m)};this.refreshPos=function(){m.x=a-s_iOffsetX;m.y=d+s_iOffsetY};this.setPosition=function(r,u){m.x=r;m.y=u};this.addButton=function(r){var u=
r.getButtonImage();u.x=0;u.y=0;u.visible=0;n.addChildAt(u,0);h.push(u);k.push(r)};this._onMenu=function(){q.stopTrembleAnimation();(e=!e)?q._expand():q._collapse()};this._expand=function(){for(var r=0;r<h.length;r++)h[r].visible=!0,createjs.Tween.get(h[r],{override:!0}).wait(300*r/2).to({y:g+r*b},300,createjs.Ease.cubicOut)};this._collapse=function(){for(var r=0;r<h.length;r++){var u=h[h.length-1-r];createjs.Tween.get(u,{override:!0}).wait(300*r/2).to({y:0},300,createjs.Ease.cubicOut).call(function(x){x.visible=
!1},[u])}};this.trembleAnimation=function(){e?k[k.length-1].trembleAnimation():l.trembleAnimation()};this.stopTrembleAnimation=function(){e?k[k.length-1].stopAnimation():l.stopAnimation()};var q=this;this._init(a,d,c,f)}
var CCTLMultiplayerGui=function(){this._cssClassDomain="ctl-multiplayer-";this._idCurDialog;this._idLoadingDialog;this._aMinutesType=MATCH_MINUTES_TYPE;this._iStartMinutesIndex=MATCH_MINUTES_DEFAULT_INDEX;this._aRoomList=[];var a=localStorage.getItem("nickname");this._szNickName=null===a||void 0===a?"":a;this._iIDTimeout=null};CCTLMultiplayerGui.prototype.unload=function(){};
CCTLMultiplayerGui.prototype._onRoomClick=function(a){var d=""+this._aRoomList[a].name,c=""+this._aRoomList[a]["private"];"false"!==""+this._aRoomList[a].accessible&&(g_oCTLMultiplayer.closeCurrentDialog(),"true"===c?g_oCTLMultiplayer.showTypeRoomPassword(d):(g_oCTLMultiplayer.showLoading(TEXT_NETWORK_CONNECTING),on_ctl_multiplayer_join_room(d)))};CCTLMultiplayerGui.prototype._onChangeMinutes=function(a){a=parseInt(a);s_iPrefTimeMode=MATCH_MINUTES_TYPE.indexOf(a);s_oLocalStorage.saveData()};
CCTLMultiplayerGui.prototype.refreshRoomList=function(a){this._aRoomList=a;for(var d="",c=0;c<a.length;c++){d+='<li onclick="g_oCTLMultiplayer._onRoomClick('+c+')" data-private="'+a[c]["private"]+'" data-accessible="'+a[c].accessible+'">';var f=this.getRuleIndexFromTag(a[c].rules);d+='<img class="'+this._cssClassDomain+'rule_flag_small"  src="./sprites/rule_flag_"+f+'.png">';d+='<span class="'+this._cssClassDomain+'room-name">';d+=a[c].name;d+="</span>";f=sprintf(TEXT_SYS_MINUTES,a[c].minutes);"0"===
a[c].minutes&&(f=TEXT_NO_TIME);d+='<span class="'+this._cssClassDomain+'minute-match">';d+=f;d+="</span>";d=!0===a[c]["private"]?d+('<i class="'+this._cssClassDomain+'icons-lock"></i>'):!1===a[c].accessible?d+('<i class="'+this._cssClassDomain+'icons-block"></i>'):d+('<i class="'+this._cssClassDomain+'icons-login"></i>');d+="</li>"}document.querySelector("."+this._cssClassDomain+"room-list").innerHTML="";document.querySelector("."+this._cssClassDomain+"room-list").appendChild(htmlMarkupToNode(d))};
function htmlMarkupToNode(a){var d=document.createElement("template");d.innerHTML=a;return d.content.cloneNode(!0)}
CCTLMultiplayerGui.prototype._onChangeRule=function(a){switch(a){case 0:s_iCurRuleFlag--;0>s_iCurRuleFlag&&(s_iCurRuleFlag=RULES_ORDER.length-1);break;case 1:s_iCurRuleFlag++,s_iCurRuleFlag>=RULES_ORDER.length&&(s_iCurRuleFlag=0)}s_oLocalStorage.saveData();document.getElementById("rule_flag").src="./sprites/rule_flag_"+s_iCurRuleFlag+".png";a=this.getPreset();document.getElementsByClassName("ctl-multiplayer-rules-info-label")[0].textContent=a.meta.denom;this._changeRuleDesc(a);on_ctl_multiplayer_refresh_room_list()};
CCTLMultiplayerGui.prototype._changeRuleDesc=function(a){var d=a.starting_board.length;d=a.meta.denom+", "+(d+"x"+d)+", "+(a.movement===MOVEMENT_DIAGONAL?TEXT_RULE_MOVEMENT_DIAGONAL:TEXT_RULE_MOVEMENT_STRAIGHT);document.getElementById("rule_title").innerHTML=d;document.getElementById("rule_section_0").innerHTML=TEXT_RULE_CAPTURE;document.getElementById("rule_desc_0").innerHTML=TEXT_RULE_MANDATORY_CAPTURE;document.getElementById("rule_desc_1").innerHTML=TEXT_RULE_MANDATORY_MAX_CAPTURE;document.getElementById("rule_desc_2").innerHTML=
TEXT_RULE_KING_CAPTURE_FIRST;document.getElementById("rule_section_1").innerHTML=TEXT_PAWN;document.getElementById("rule_desc_3").innerHTML=TEXT_PAWN_RULE_BACK;document.getElementById("rule_section_2").innerHTML=TEXT_KING;switch(KING_MOVE_ORDER.indexOf(a.king_movement)){case 0:var c=TEXT_RULE_MOVEMENT_KING_SHORT;break;case 1:c=TEXT_RULE_MOVEMENT_KING_LONG;break;case 2:c=TEXT_RULE_MOVEMENT_KING_LONG_BLOCK}document.getElementById("rule_desc_4").innerHTML=TEXT_RULE_MOVEMENT+"  "+c;document.getElementById("rule_desc_5").innerHTML=
TEXT_RULE_PROTECTED_KING;document.getElementById("rule_note").innerHTML="<strong>"+TEXT_RULE_NOTE+"</strong> : "+a.meta.notes;this._showRule("rule_section_0",a.capture_rule.mandatory);this._showRule("rule_desc_0",a.capture_rule.mandatory);this._showRule("rule_desc_1",a.capture_rule.maximize);this._showRule("rule_desc_2",a.capture_rule.king_first);this._showRule("rule_section_1",a.capture_rule.back);this._showRule("rule_desc_5",a.capture_rule.king_protected);this._showRule("rule_note",""!==a.meta.notes);
document.getElementsByClassName("quick_match")[0].textContent=sprintf(TEXT_SYS_QUICKMATCH_MINUTE,a.meta.suggested_quickmatch_time)};CCTLMultiplayerGui.prototype._showRule=function(a,d){var c=document.getElementById(a);d?c.classList.remove("ctl-multiplayer-display-none"):c.classList.add("ctl-multiplayer-display-none")};
CCTLMultiplayerGui.prototype.showRoomList=function(a){var d='<div onclick="g_oCTLMultiplayer._onToggleRules()" class="'+this._cssClassDomain+'rules-desc">';d=d+'<h2 id="rule_title"></h2><ul><li id="rule_section_0"></li><ul class="'+(this._cssClassDomain+'rules-desc-sub">');d=d+'<li id="rule_desc_0"></li><li id="rule_desc_1"></li><li id="rule_desc_2"></li></ul><li id="rule_section_1"></li><ul class="'+(this._cssClassDomain+'rules-desc-sub">');d=d+'<li id="rule_desc_3"></li></ul><li id="rule_section_2"></li><ul class="'+
(this._cssClassDomain+'rules-desc-sub">');d=d+'<li id="rule_desc_4"></li><li id="rule_desc_5"></li></ul><li id="rule_note"></li></ul></div><input type="text" placeholder="'+(TEXT_SYS_FINDROOM+'" maxlength="60" value="" oninput="on_room_search(this.value)">');d+='<ul class="'+this._cssClassDomain+"list "+this._cssClassDomain+'room-list">';d=d+'</ul><button onclick="on_ctl_multiplayer_refresh_room_list()" type="button" class="'+(this._cssClassDomain+"update "+this._cssClassDomain+'btn-gray">');d+='<i class="'+
this._cssClassDomain+'icons-arrows-cw"></i>';d+="<span>"+TEXT_SYS_UPDATE+"</span>";d+="</button>";var c='<div class="'+this._cssClassDomain+'rule_option">';c+='<div class="'+this._cssClassDomain+'rules-controls">';c+='<button onclick="g_oCTLMultiplayer._onChangeRule(0)" type="button" class="'+this._cssClassDomain+'change_rule" >';c+='<i class="'+this._cssClassDomain+'rule_arrows"></i>';c=c+'<span><</span></button><img onclick="g_oCTLMultiplayer._onToggleRules()" id="rule_flag" class="'+(this._cssClassDomain+
'rule_flag"  src="./sprites/rule_flag_"+s_iCurRuleFlag+'.png">');c+='<button onclick="g_oCTLMultiplayer._onChangeRule(1)" type="button" class="'+this._cssClassDomain+'change_rule" >';c+='<i class="'+this._cssClassDomain+'rule_arrows"></i>';c=c+'<span>></span></button></div><div onclick="g_oCTLMultiplayer._onToggleRules()" class="'+(this._cssClassDomain+'rules-type"><span class="'+this._cssClassDomain+'rules-info-icon">?</span><span class="'+this._cssClassDomain+'rules-info-label">'+this.getPreset().meta.denom+
"</span></div>");c+="</div>";var f=this.getPreset();this._idCurDialog=this.showDialog(TEXT_SYS_MATCH_LIST+c,d,[{txt:TEXT_SYS_QUICKMATCH_NOTIME,cb:"on_ctl_multiplayer_join_quick_match",classes:""},{txt:sprintf(TEXT_SYS_QUICKMATCH_MINUTE,f.meta.suggested_quickmatch_time),cb:"on_ctl_multiplayer_join_quick_match_time",classes:"quick_match"},{txt:TEXT_SYS_CREATEMATCH,cb:"on_ctl_multiplayer_show_create_match",classes:""},{txt:TEXT_SYS_BACK,cb:"g_oCTLMultiplayer.closeMatchDialog",classes:""}],"match-list");
f=this.getPreset();this._changeRuleDesc(f);console.log(f);this.refreshRoomList(a);document.onkeydown=function(g){13===g.keyCode&&(on_ctl_multiplayer_send_password(),document.onkeydown=null)}};CCTLMultiplayerGui.prototype._onToggleRules=function(){document.getElementsByClassName("ctl-multiplayer-rules-desc")[0].classList.toggle("ctl-multiplayer-rules-desc-visible")};
CCTLMultiplayerGui.prototype.showTypeRoomPassword=function(a){var d='<div class="'+this._cssClassDomain+'form-group">';d+="<label>"+TEXT_SYS_TYPEROOMPASS+"</label>";this._idCurDialog=this.showDialog(TEXT_SYS_TYPEROOMPASS,d+('<input type="password" name="password" data-room-name="'+a+'"></div>'),[{txt:TEXT_SYS_OK,cb:"on_ctl_multiplayer_send_password",classes:""},{txt:TEXT_SYS_BACK,cb:"on_ctl_multiplayer_close_type_room_password",classes:""}]);document.onkeydown=function(c){13===c.keyCode&&(on_ctl_multiplayer_create_room(),
document.onkeydown=null)}};
CCTLMultiplayerGui.prototype.showCreateRoom=function(){var a='<div class="'+this._cssClassDomain+'form-group">';a+="<label>"+TEXT_SYS_NAMEROOM+"</label>";a+='<input type="text" name="roomname" value="'+sprintf(TEXT_SYS_DEFAULTROOMNAME,this._szNickName)+'">';a=a+'</div><div class="'+(this._cssClassDomain+'form-group">');a+="<label>"+TEXT_SYS_PASSWORD+"</label>";a=a+'<input type="password" name="password" oninput="g_oCTLMultiplayer.onPasswordInput()"><p>'+(TEXT_SYS_INFOPASS+"</p>");a=a+'</div><div class="'+
(this._cssClassDomain+'form-group">');a+="<label>"+TEXT_SYS_GAME_TIME+"</label>";a+='<ul class="'+this._cssClassDomain+'inline-list">';this._iStartMinutesIndex=s_iPrefTimeMode;for(var d=0;d<this._aMinutesType.length;d++){var c=this._aMinutesType[d],f=sprintf(TEXT_SYS_MINUTES,c);0===c&&(f=TEXT_NO_TIME);a=this._iStartMinutesIndex===d?a+('<li><input onchange="g_oCTLMultiplayer._onChangeMinutes('+c+')" type="radio" name="minutes" value="'+c+'" checked="checked"><span>'+f+"</span></li>"):a+('<li><input  onchange="g_oCTLMultiplayer._onChangeMinutes('+
c+')" type="radio" name="minutes" value="'+c+'"><span>'+f+"</span></li>")}a+="<p>"+TEXT_SYS_CHOOSEGAMETIME+"</p>";this._idCurDialog=this.showDialog(TEXT_SYS_CREATEROOM+'<i id="visibility-icon" class="'+this._cssClassDomain+"icon-create-match "+this._cssClassDomain+'icons-login"></i>',a+"</div>",[{txt:TEXT_SYS_CREATE,cb:"on_ctl_multiplayer_create_room",classes:""},{txt:TEXT_SYS_BACK,cb:"on_ctl_multiplayer_close_create_room",classes:""}]);document.onkeydown=function(g){13===g.keyCode&&(on_ctl_multiplayer_create_room(),
document.onkeydown=null)}};CCTLMultiplayerGui.prototype.onPasswordInput=function(){var a=document.querySelector("[id='"+g_oCTLMultiplayer._idCurDialog+"']").querySelector("input[name='password']").value.length,d=document.querySelector("#visibility-icon");0<a?(d.classList.remove(this._cssClassDomain+"icons-login"),d.classList.add(this._cssClassDomain+"icons-lock")):(d.classList.remove(this._cssClassDomain+"icons-lock"),d.classList.add(this._cssClassDomain+"icons-login"))};
CCTLMultiplayerGui.prototype.showChooseNickName=function(){this._idCurDialog=this.showDialog(TEXT_SYS_CHOOSENICK,'<input type="text" name="nickname" maxlength="20" value="'+this._szNickName+'">',[{txt:TEXT_SYS_OK,cb:"on_ctl_multiplayer_send_nickname",classes:""},{txt:TEXT_SYS_CLOSE,cb:"g_oCTLMultiplayer.closeCurrentDialog",classes:""}]);document.onkeydown=function(a){13===a.keyCode&&(on_ctl_multiplayer_create_room(),document.onkeydown=null)}};
CCTLMultiplayerGui.prototype.showGeneralDialog=function(a,d){this._idCurDialog=this.showDialog(a,"",[{txt:TEXT_SYS_BACK,cb:d,classes:""}]);document.onkeydown=function(c){13===c.keyCode&&(on_ctl_multiplayer_create_room(),document.onkeydown=null)}};CCTLMultiplayerGui.prototype.closeLoadingDialog=function(){this.closeDlg(this._idLoadingDialog)};CCTLMultiplayerGui.prototype.closeMatchDialog=function(){s_oMenu&&s_oMenu.changeFlagRule();g_oCTLMultiplayer.closeCurrentDialog()};
CCTLMultiplayerGui.prototype.closeCurrentDialog=function(){this.closeDlg(this._idCurDialog);document.onkeydown=null};CCTLMultiplayerGui.prototype.makeCode=function(){for(var a="",d=0;32>d;d++)a+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(Math.floor(62*Math.random()));return a};
CCTLMultiplayerGui.prototype.showDialog=function(a,d,c,f){var g="";f||(f=this.makeCode());g+="<div id='"+f+"' class='"+this._cssClassDomain+"dlg-wrapper'>";g+="<div class='"+this._cssClassDomain+"dlg-block'></div>";g+="<div class='"+this._cssClassDomain+"dlg-content'>";g+="<div class='"+this._cssClassDomain+"dlg-header'>";g=g+("<h1>"+a+"</h1></div><div class='")+(this._cssClassDomain+"dlg-content-body'>");g+=d;g+="</div>";if(c&&0<c.length){g+="<div class='"+this._cssClassDomain+"dlg-footer'>";for(a=
0;a<c.length;a++)g+="<button type='button' onclick='"+c[a].cb+'("'+f+"\");' class='"+this._cssClassDomain+"mini "+c[a].classes+"'>"+c[a].txt+"</button>";g+=this.buildExtraFooter();g+="</div>"}g+="</div>";g+="</div>";document.querySelector("body").appendChild(htmlMarkupToNode(g));document.onkeydown=function(b){13===b.keyCode&&(on_ctl_multiplayer_create_room(),document.onkeydown=null)};return f};
CCTLMultiplayerGui.prototype.buildExtraFooter=function(){var a='<div class="'+this._cssClassDomain+'copyright">';a+='<a href="'+sprintf(HTTPS_FORMAT,CODETHISLAB_LINK)+'" target="_blank">'+CODETHISLAB_LINK+"</a>";return a+"</div>"};
CCTLMultiplayerGui.prototype.setCountdown=function(a){document.querySelector("#countdown-vs-panel-text").textContent=a;this._iIDTimeout=setInterval(function(){--a;document.querySelector("#countdown-vs-panel-text")&&(document.querySelector("#countdown-vs-panel-text").textContent=a);0>=a&&g_oCTLMultiplayer.removeCountdown()},1E3)};
CCTLMultiplayerGui.prototype.removeCountdown=function(){null!==this._iIDTimeout&&(document.querySelector("#countdown-vs-panel-text")&&(document.querySelector("#countdown-vs-panel-text").textContent=""),clearInterval(this._iIDTimeout),this._iIDTimeout=null)};
CCTLMultiplayerGui.prototype.onPlayerFound=function(a){document.querySelector("#opponent-nickname")&&(document.querySelector("#opponent-nickname").textContent=a);document.querySelector("#countdown-vs-panel-text")&&(document.querySelector("#countdown-vs-panel-text").textContent="");document.querySelector("button.ctl-multiplayer-mini")&&(document.querySelector("button.ctl-multiplayer-mini").style.display="none");g_oCTLMultiplayer.removeCountdown()};
CCTLMultiplayerGui.prototype.showVsPanel=function(a,d){var c="";this._idLoadingDialog=this.makeCode();a||(a=TEXT_SYS_LOADING);c+="<div id='"+this._idLoadingDialog+"' class='"+this._cssClassDomain+"dlg-wrapper "+this._cssClassDomain+"fixed'>";c+="<div class='"+this._cssClassDomain+"dlg-block'></div>";c+="<div class='"+this._cssClassDomain+"dlg-scroll'>";c+="<div class='"+this._cssClassDomain+"dlg-content'>";c+="<div class='"+this._cssClassDomain+"dlg-header'>";c+="<h1 style='text-align:center'>"+s_oNetworkManager.getPlayerNickname()+
"</h1>";c=c+("<h1 style='font-size:22px;text-align:center;color:#31a8fd'>"+a+"</h1><h1 id='opponent-nickname' style='text-align:center'>")+(TEXT_WAIT_OPPONENT.toLowerCase()+"</h1>");c+="<h1 id='countdown-vs-panel-text' style='text-align:center'></h1></div>";d&&(c+="<div class='"+this._cssClassDomain+"dlg-footer "+this._cssClassDomain+"center'>",c+="<button type='button' onclick='"+d+'("'+this._idLoadingDialog+"\");' class='"+this._cssClassDomain+"mini '>"+TEXT_SYS_BACK+"</button>",c+=this.buildExtraFooter(),
c+="</div>");c+="</div></div></div>";document.querySelector("body").appendChild(htmlMarkupToNode(c));this.setCountdown(60)};
CCTLMultiplayerGui.prototype.showLoading=function(a,d){var c="";this._idLoadingDialog=this.makeCode();a||(a=TEXT_SYS_LOADING);c+="<div id='"+this._idLoadingDialog+"' class='"+this._cssClassDomain+"dlg-wrapper "+this._cssClassDomain+"fixed'>";c+="<div class='"+this._cssClassDomain+"dlg-block'></div>";c+="<div class='"+this._cssClassDomain+"dlg-content'>";c+="<div class='"+this._cssClassDomain+"dlg-header'>";c=c+("<h1>"+a+"</h1></div><div class='")+(this._cssClassDomain+"dlg-content-body "+this._cssClassDomain+
"align-center'>");c+='<i class="'+this._cssClassDomain+'icons-spin5 animate-spin"></i>';c+="</div>";d&&(c+="<div class='"+this._cssClassDomain+"dlg-footer "+this._cssClassDomain+"center'>",c+="<button type='button' onclick='"+d+'("'+this._idLoadingDialog+"\");' class='"+this._cssClassDomain+"mini '>"+TEXT_SYS_BACK+"</button>",c+=this.buildExtraFooter(),c+="</div>");c+="</div>";c+="</div>";document.querySelector("body").appendChild(htmlMarkupToNode(c))};
CCTLMultiplayerGui.prototype.showWaitingPlayersInRoom=function(a,d,c,f){d="";this._idLoadingDialog=this.makeCode();a||(a=TEXT_SYS_LOADING);d+="<div id='"+this._idLoadingDialog+"' class='"+this._cssClassDomain+"dlg-wrapper "+this._cssClassDomain+"fixed'>";d+="<div class='"+this._cssClassDomain+"dlg-block'></div>";d+="<div class='"+this._cssClassDomain+"dlg-content'>";d+="<div class='"+this._cssClassDomain+"dlg-header'>";d=d+("<h1>"+a+"</h1></div><div class='")+(this._cssClassDomain+"dlg-content-body "+
this._cssClassDomain+"align-center'>");d+="<p class='"+this._cssClassDomain+"room-info'></p>";d+='<div class="ctl-multiplayer-spinner-container">';d+='<i class="'+this._cssClassDomain+'icons-spin5 animate-spin"></i>';d+="</div>";f&&(d+='<input class="'+this._cssClassDomain+'room-link" type="text" placeholder="'+f+'" id="link" name="link"',d+='maxlength="60" value="'+f+'" size="4" data-clipboard-target="#link" readonly>');d+="</div>";if(c){d+="<div class='"+this._cssClassDomain+"dlg-footer "+this._cssClassDomain+
"center'>";for(a=0;a<c.length;a++)f=c[a],d+="<button id='"+f.id+"' type='button' "+("invite"===f.id?"data-clipboard-target='#link'":"")+" onclick='"+f.func+'("'+this._idLoadingDialog+"\");' class='"+this._cssClassDomain+"mini"+(f.classes?" "+f.classes:"")+" '>"+f.label+"</button>";d+=this.buildExtraFooter();d+="</div>"}d+="</div>";d+="</div>";document.querySelector("body").appendChild(htmlMarkupToNode(d))};
CCTLMultiplayerGui.prototype.closeDlg=function(a){document.querySelector("[id='"+a+"']")&&document.querySelector("[id='"+a+"']").remove()};CCTLMultiplayerGui.prototype.closeAllDialog=function(){[].concat($jscomp.arrayFromIterable(document.querySelectorAll("*"))).forEach(function(a){a._tippy&&a._tippy.destroy()});g_oCTLMultiplayer.closeLoadingDialog();g_oCTLMultiplayer.closeCurrentDialog();g_oCTLMultiplayer.removeCountdown()};
CCTLMultiplayerGui.prototype.setNickName=function(a){this._szNickName=null===a||void 0===a?"":a;localStorage.setItem("nickname",this._szNickName)};CCTLMultiplayerGui.prototype.getNickname=function(){return this._szNickName};CCTLMultiplayerGui.prototype.getRuleIndexFromTag=function(a){return RULES_ORDER.indexOf(a)};CCTLMultiplayerGui.prototype.getRuleTag=function(){return RULES_ORDER[s_iCurRuleFlag]};CCTLMultiplayerGui.prototype.getPreset=function(){var a=this.getRuleTag();return RULE_PRESET[a]};
CCTLMultiplayerGui.prototype.setMaxPlayersInRoom=function(a){2>a||4<a||(this._iMaxPlayersInRoom=a)};g_oCTLMultiplayer=new CCTLMultiplayerGui;g_oCTLMultiplayer.setMaxPlayersInRoom(2);
function CMoveTimeController(a,d,c,f){var g,b,e,h,k,l,m,n,p,q;this._init=function(){g=[];b=[];h=f;e=null;m=0;n=new createjs.Container;n.x=a;n.y=d;c.addChild(n);q=new CTLText(n,-50,-50,300,100,30,"center","#fff",PRIMARY_FONT,1,2,2," ",!0,!0,!1,!1);p=new CRadialWipeWidget(0,0,n)};this.unload=function(){c.removeChild(n);this.stopTimer()};this.setPos=function(u,x){n.x=u;n.y=x};this.setScale=function(u){p.setScale(u)};this.setSpectatorMode=function(){p.removeHurryUpMode()};this.setAlwaysShown=function(){p.alwaysShown()};
this.showAttempt=function(u){q.setVisible(u)};this.addEventListener=function(u,x,w){g[u]=x;b[u]=w};this.restartEndGameCounter=function(){m=0;h=f};this.setTime=function(u){h=u};this.setHurryUpMode=function(u){p.setHurryUpMode(u)};this.startTimer=function(){0!==h&&(l=k=h,q.refreshText(m+1+"/"+NUM_ATTEMPT),null===e&&(e=setInterval(function(){r.update();n.visible=!0},FPS_TIME)))};this.stopTimer=function(){n.visible=!1;q.refreshText("");p.reset();clearInterval(e);e=null};this._onTimerEnd=function(){console.log("callback");
var u=ON_TIMER_END;g[u]&&g[u].call(b[u])};this.update=function(){l-=s_iTimeElaps;0>l&&(this.stopTimer(),this._onTimerEnd(),l=0,clearInterval(e));p.update(l,k)};this._init();var r=this}
function CAIController(a){var d,c,f,g,b,e,h;this._init=function(k){d=[];c=[];f=k[PAWN];g=k[KING]};this.addEventListener=function(k,l,m){d[k]=l;c[k]=m};this.getMove=function(k,l){h=new CTreeDecision({rating:0,moves:[],depth:0});b=l;e=k;this._startComputing(k)};this._getBestNode=function(k){if(0<k.length){for(var l=k[0].model.rating,m=1;m<k.length;m++)k[m].model.rating>l&&(l=k[m].model.rating);var n=[];for(m=0;m<k.length;m++)k[m].model.rating===l&&n.push(k[m]);k=n[Math.floor(Math.random()*n.length)].model.moves}else k=
null;return k};this._startComputing=function(k){var l=this,m;setTimeout(function(){m=l._maxi(0,k);l._onEndComputing(m)},50)};this._onEndComputing=function(k){k=h.getNode(k,1);this._addDistanceValue(k);k=this._getBestNode(k);d[ON_END_AI_COMPUTATION]&&d[ON_END_AI_COMPUTATION].call(c[ON_END_AI_COMPUTATION],k)};this._addDistanceValue=function(k){var l=this._isOnlyKing(b);if(l){var m=s_oBoardStateController.getOtherOpponent(e);m=this._getKingAttractionValue(b,m)}else m=this._getPromoDistanceValue(b,e);
for(var n=0;n<k.length;n++){var p=k[n],q=p.model.moves.path.terminal;q=m[q.row][q.col];l?p.model.rating+=q:p.model.moves.cell.type===PAWN&&(p.model.rating+=q)}};this._calculateMin=function(k,l){return k<l?k:l};this._calculateMax=function(k,l){return k>l?k:l};this._isOnlyKing=function(k){for(var l=0;l<k.length;l++)for(var m=0;m<k[l].length;m++)if(k[l][m].type===PAWN)return!1;return!0};this._getPromoDistanceValue=function(k,l){for(var m=[],n=0;n<k.length;n++){m[n]=[];for(var p=0;p<k[n].length;p++)m[n][p]=
n/(k.length-1),l===WHITE&&(m[n][p]=1-n/(k.length-1))}return m};this._getKingAttractionValue=function(k,l){for(var m,n,p=[],q=s_oMovesController.getAllPiecePos(k,l),r=0;r<q.length;r++){m=q[r].row;n=q[r].col;p[r]=[];for(var u,x,w=0;w<k.length;w++){p[r][w]=[];for(var v=0;v<k[w].length;v++)u=k.length-Math.abs(m-w),x=k[w].length-Math.abs(n-v),p[r][w][v]=this._calculateMin(u,x)}}m=p[0];for(r=0;r<q.length;r++)for(w=0;w<k.length;w++)for(v=0;v<k[w].length;v++)m[w][v]<p[r][w][v]&&(m[w][v]=p[r][w][v]);return m};
this._findAllMoves=function(k){return s_oMovesController.getAllMovesInfoInBoard(k,b)};this._makeMove=function(k){var l=k.cell,m=k.path.terminal,n=l.logic_pos;k=k.path.jump_list;b[n.row][n.col].color=null;b[n.row][n.col].type=null;b[m.row][m.col].color=l.color;b[m.row][m.col].type=l.type;for(n=0;n<k.length;n++){var p=k[n].capture;null!==p&&(b[p.logic_pos.row][p.logic_pos.col].color=null,b[p.logic_pos.row][p.logic_pos.col].type=null)}switch(m.row){case 0:l.color===WHITE&&(b[m.row][m.col].type=KING);
break;case b.length-1:l.color===BLACK&&(b[m.row][m.col].type=KING)}};this._unmakeMove=function(k){var l=k.cell,m=k.cell.logic_pos,n=k.path.terminal;k=k.path.jump_list;b[n.row][n.col].color=null;b[n.row][n.col].type=null;b[m.row][m.col].color=l.color;b[m.row][m.col].type=l.type;for(l=0;l<k.length;l++)m=k[l].capture,null!==m&&(b[m.logic_pos.row][m.logic_pos.col].color=m.color,b[m.logic_pos.row][m.logic_pos.col].type=m.type)};this._evaluateBoard=function(k,l){for(var m=0,n=0,p=0;p<k.length;p++)for(var q=
0;q<k[p].length;q++){var r=k[p][q];r.color===WHITE?m=r.type===PAWN?m+f:m+g:r.color===BLACK&&(n=r.type===PAWN?n+f:n+g)}p=n-m;e===WHITE&&(p=m-n);return p};this._maxi=function(k,l){if(k===SEARCH_DEPTH)return this._evaluateBoard(b,l);for(var m=-INFINITE,n=this._findAllMoves(l),p=s_oBoardStateController.getOtherOpponent(l),q=k+1,r=0;r<n.length;r++){var u=n[r];this._makeMove(u);h.initNewNode(q);var x=this._mini(q,p);h.addNode(k,x,u);this._unmakeMove(u);x>m&&(m=x)}return m};this._mini=function(k,l){if(k===
SEARCH_DEPTH)return this._evaluateBoard(b,l);for(var m=INFINITE,n=this._findAllMoves(l),p=s_oBoardStateController.getOtherOpponent(l),q=k+1,r=0;r<n.length;r++){var u=n[r];this._makeMove(u);h.initNewNode(q);var x=this._maxi(q,p);h.addNode(k,x,u);this._unmakeMove(u);x<m&&(m=x)}return m};this._init(a)}
function CBoardStateController(){this._init=function(){};this.getOtherOpponent=function(a){return a===WHITE?BLACK:WHITE};this.copyBoard=function(a){for(var d=[],c=0;c<a.length;c++){d[c]=[];for(var f=0;f<a[c].length;f++)d[c][f]=a[c][f].getPieceInfo()}return d};this.getListPiece=function(a,d){for(var c=[],f=0;f<a.length;f++)for(var g=0;g<a[f].length;g++){var b=a[f][g];b.color===d&&c.push(b)}return c};this._init();s_oBoardStateController=this}
var s_oBoardStateController,DIR_TOPRIGHT="DIR_TOPRIGHT",DIR_RIGHT="DIR_RIGHT",DIR_BOTRIGHT="DIR_BOTRIGHT",DIR_TOPLEFT="DIR_TOPLEFT",DIR_LEFT="DIR_LEFT",DIR_BOTLEFT="DIR_BOTLEFT",DIR_TOP="DIR_TOP",DIR_BOT="DIR_BOT";
function CMovesController(a,d){var c,f,g;this._init=function(b){c=b.length;f=b[0].length;g=[];for(b=0;b<c;b++){g[b]=[];for(var e=0;e<f;e++)g[b][e]=[]}this._buildMap()};this._buildMap=function(){for(var b=0;b<c;b++)for(var e=0;e<f;e++)g[b][e][DIR_TOPRIGHT]=this._setNeighbor(b,e,DIR_TOPRIGHT),g[b][e][DIR_RIGHT]=this._setNeighbor(b,e,DIR_RIGHT),g[b][e][DIR_BOTRIGHT]=this._setNeighbor(b,e,DIR_BOTRIGHT),g[b][e][DIR_TOPLEFT]=this._setNeighbor(b,e,DIR_TOPLEFT),g[b][e][DIR_LEFT]=this._setNeighbor(b,e,DIR_LEFT),
g[b][e][DIR_BOTLEFT]=this._setNeighbor(b,e,DIR_BOTLEFT),g[b][e][DIR_TOP]=this._setNeighbor(b,e,DIR_TOP),g[b][e][DIR_BOT]=this._setNeighbor(b,e,DIR_BOT)};this._setNeighbor=function(b,e,h){var k=null;switch(h){case DIR_TOPRIGHT:0<b&&e<f-1&&(k={row:b-1,col:e+1});break;case DIR_RIGHT:e<f-1&&(k={row:b,col:e+1});break;case DIR_BOTRIGHT:b<c-1&&e<f-1&&(k={row:b+1,col:e+1});break;case DIR_TOPLEFT:0<b&&0<e&&(k={row:b-1,col:e-1});break;case DIR_LEFT:0<e&&(k={row:b,col:e-1});break;case DIR_BOTLEFT:b<c-1&&0<e&&
(k={row:b+1,col:e-1});break;case DIR_TOP:0<b&&(k={row:b-1,col:e});break;case DIR_BOT:b<c-1&&(k={row:b+1,col:e})}return k};this._getNeighborByDir=function(b,e,h){return g[b][e][h]};this._getAllNeighbor=function(b,e){var h=[],k;for(k in g[b][e])null!==g[b][e][k]&&h.push(g[b][e][k]);return h};this._getMainDiagonal=function(b,e,h){var k=[],l=h[b][e].color;this._findInDirection(b,e,DIR_BOTRIGHT,k,99,l,h);this._findInDirection(b,e,DIR_TOPLEFT,k,99,l,h);return k};this._getSecondDiagonal=function(b,e,h){var k=
[],l=h[b][e].color;this._findInDirection(b,e,DIR_BOTLEFT,k,99,l,h);this._findInDirection(b,e,DIR_TOPRIGHT,k,99,l,h);return k};this._getRow=function(b,e,h){var k=[],l=h[b][e].color;this._findInDirection(b,e,DIR_LEFT,k,99,l,h);this._findInDirection(b,e,DIR_RIGHT,k,99,l,h);return k};this._getCol=function(b,e,h){var k=[],l=h[b][e].color;this._findInDirection(b,e,DIR_TOP,k,99,l,h);this._findInDirection(b,e,DIR_BOT,k,99,l,h);return k};this._getStraightByDirAndRadius=function(b,e,h,k,l){var m=[];this._findInDirection(b,
e,h,m,k,l[b][e].color,l);return m};this._getStraightRowByRadius=function(b,e,h){var k=[];this._findInDirection(b,e,DIR_LEFT,k,h);this._findInDirection(b,e,DIR_RIGHT,k,h);return k};this._getStraightColByRadius=function(b,e,h){var k=[];this._findInDirection(b,e,DIR_TOP,k,h);this._findInDirection(b,e,DIR_BOT,k,h);return k};this._getStraightLine=function(b,e,h,k){b=g[b.row][b.col][h];null!==b&&(k.push(b),b.row===e.row&&b.col===e.col||this._getStraightLine(b,e,h,k));return k};this._findInDirection=function(b,
e,h,k,l,m,n,p){p=void 0===p?null:p;--l;var q=g[b][e][h];if(null!==q&&0<=l){var r=q.row,u=q.col;if(m){var x=n[r][u].color;x!==m&&(null===x?(k.push({dest:q,capture:p,dir:h}),this._findInDirection(r,u,h,k,l,m,n,p)):null===p&&(b=this._checkValidJump(r,u,h,k,n,n[b][e].type),null!==b&&(e=copyObjectByValue(n[r][u]),k.push({dest:b,capture:e,dir:h}),d.king_movement===KING_MOVEMENT_FLY&&this._findInDirection(b.row,b.col,h,k,l,m,n,e))))}else k.push({dest:q,capture:p,dir:h}),this._findInDirection(r,u,h,k,l,m,
n,p)}};this._checkValidJump=function(b,e,h,k,l,m){k=null;h=g[b][e][h];if(null!==h){b=l[b][e].type;if(!0===d.capture_rule.king_protected&&b===KING&&m===PAWN)return k;null===l[h.row][h.col].color&&(k=h)}return k};this.getAllPiecePos=function(b,e){for(var h=[],k=0;k<b.length;k++)for(var l=0;l<b[k].length;l++)b[k][l].color===e&&h.push({row:k,col:l});return h};this.getMovesList=function(b,e,h){var k=[];switch(h[b][e].type){case PAWN:b=this.getPawnMove(b,e,h);break;case KING:b=this.getKingMove(b,e,h);break;
default:return k}s_oMovesController.getAllPathFromTree(b,k,[],b.src);return k=this._filterBestPaths(k)};this._buildMoveTree=function(b,e,h,k){var l=k.dest.row,m=k.dest.col,n=[],p=1,q=b.type,r=b.color;switch(q){case PAWN:n=this.getForwardDirections(r);d.capture_rule.back&&(n=this.getAllDirections());break;case KING:if(n=this.getAllDirections(),d.king_movement===KING_MOVEMENT_FLY||d.king_movement===KING_MOVEMENT_FLY_BLOCK)p=99}b=[];for(var u=0;u<n.length;u++){var x=n[u],w=this.getOppositeDirection(k.dir);
x!==w&&(b[x]=[],this._findInDirection(l,m,x,b[x],p,r,e,null),d.capture_rule.back&&q===PAWN&&-1!==this.getBackwardDirections(r).indexOf(x)&&this._filterCaptureList(b[x]));x===k.dir&&d.king_movement===KING_MOVEMENT_FLY_BLOCK&&null!==k.capture&&(b[x]=[],this._findInDirection(l,m,x,b[x],1,r,e,null))}k=[];u=$jscomp.makeIterator(Object.entries(b));for(b=u.next();!b.done;b=u.next())b=$jscomp.makeIterator(b.value),b.next(),b=b.next().value,k=k.concat(b);h.move_list=k;for(u=0;u<k.length;u++)h=k[u],null!==
h.capture&&(n=this.getMoveInfo({row:l,col:m},h,e),this.makeMove(n,e),p=h.dest,b=e[h.dest.row][h.dest.col],p={src:p,move_list:[]},b=this._buildMoveTree(b,e,p,h),this._filterCaptureList(b),0<b.length&&(h.node=p),this.unmakeMove(n,e));return k};this.getMoveTree=function(b,e,h,k){h={row:e,col:h};e={src:h,move_list:[]};this._buildMoveTree(b,k,e,{dest:h,capture:null,dir:null});this._setWeight(e);if(d.capture_rule.mandatory){d.capture_rule.maximize&&this._maximizeWeight(e);b=e.move_list;k=!1;for(h=0;h<b.length;h++)if(null!==
b[h].capture){k=!0;break}k&&this._filterCaptureList(e.move_list)}return e};this.getPawnMove=function(b,e,h){return this.getMoveTree(h[b][e],b,e,h)};this.getKingMove=function(b,e,h){return this.getMoveTree(h[b][e],b,e,h)};this._filterCaptureList=function(b){for(var e=0;e<b.length;e++)null===b[e].capture&&(b.splice(e,1),e--)};this._setWeight=function(b){b=b.move_list;for(var e=0;e<b.length;e++){var h=b[e];h.weight=h.node?1+this._setWeight(h.node):h.capture?1:0}return this._getMaxWeight(b)};this._getMaxWeight=
function(b){for(var e=0,h=0;h<b.length;h++){var k=b[h];e<k.weight&&(e=k.weight)}return e};this._maximizeWeight=function(b){b=b.move_list;for(var e=this._getMaxWeight(b),h=0;h<b.length;h++){var k=b[h];k.weight<e&&(b.splice(h,1),h--)}for(h=0;h<b.length;h++)k=b[h],k.node&&this._maximizeWeight(k.node)};this.getAllMovesInfoInBoard=function(b,e){var h=this._getAllCellMovingInfo(b,e);return this._getListOfSinglePath(h)};this.getMandatoryCells=function(b,e){var h=this._getAllCellMovingInfo(b,e),k=[];if(d.capture_rule.mandatory)for(var l=
0;l<h.length;l++){var m=h[l];0<m.max_num_capture&&k.push(m.cell)}return k};this._getAllCellMovingInfo=function(b,e){for(var h=[],k=!1,l=this._getAllBoardMoves(b,e),m=0;m<l.length;m++){var n=l[m];if(0<n.length){var p=n[0];p=copyObjectByValue(e[p.src.row][p.src.col]);var q=this._getMaxNumCaptureInPathList(n);0<q&&(k=!0);h.push({cell:p,max_num_capture:q,all_path:n})}}if(d.capture_rule.mandatory&&k){for(m=0;m<h.length;m++)0===h[m].max_num_capture&&(h.splice(m,1),m--);d.capture_rule.king_first&&(k=this._getCellsByType(KING,
h),0<k.length&&(h=k));d.capture_rule.maximize&&this._filterCapturingCellsByMax(h)}return h};this._getAllBoardMoves=function(b,e){for(var h=[],k=0;k<e.length;k++)for(var l=0;l<e[k].length;l++)e[k][l].color===b&&h.push(this.getMovesList(k,l,e));return h};this._filterCapturingCellsByMax=function(b){for(var e=0,h=0;h<b.length;h++){var k=b[h].max_num_capture;b[h].max_num_capture>e&&(e=k)}for(h=0;h<b.length;h++)b[h].max_num_capture<e&&(b.splice(h,1),h--)};this._getCellsByType=function(b,e){for(var h=[],
k=0;k<e.length;k++)e[k].cell.type===b&&h.push(e[k]);return h};this._getListOfSinglePath=function(b){for(var e=[],h=0;h<b.length;h++)for(var k=b[h].all_path,l=0;l<k.length;l++){var m=k[l],n=this.getNumCaptureInPath(m);e.push({cell:b[h].cell,num_capture:n,path:m})}return e};this._checkCaptureInPathList=function(b){for(var e=0;e<b.length;e++)if(0<this.getNumCaptureInPath(b[e]))return!0;return!1};this.getNumCaptureInPath=function(b){b=b.jump_list;for(var e=0,h=0;h<b.length;h++)null!==b[h].capture&&e++;
return e};this._getMaxNumCaptureInPathList=function(b){for(var e=0,h=0;h<b.length;h++){var k=this.getNumCaptureInPath(b[h]);e<k&&(e=k)}return e};this.getAllPathFromTree=function(b,e,h,k){b=b.move_list;for(var l=0;l<b.length;l++){var m=b[l],n=m.dest;h.push({dest:n,capture:m.capture});m.node?this.getAllPathFromTree(m.node,e,h,k):(m=copyObjectByValue(h),e.push({jump_list:m,terminal:n,src:k}),h.splice(h.length-1,1))}h.splice(h.length-1,1)};this.getAllCellsFromAPath=function(b){var e=[],h=b.jump_list,
k=b.src;for(b=0;b<h.length;b++){var l=h[b].dest;k=s_oMovesController.getLine(k,l);for(var m=0;m<k.length;m++)e.push(k[m]);k=l}return e};this._groupPathsByTerminal=function(b){for(var e={},h=0;h<b.length;h++){var k=b[h],l=k.terminal.row+"_"+k.terminal.col;e.hasOwnProperty(l)||(e[l]=[]);e[l].push(k)}return e};this._filterBestPaths=function(b){b=this._groupPathsByTerminal(b);var e=[],h;for(h in b){for(var k=b[h],l=k[0],m=1;m<k.length;m++){var n=k[m];l.jump_list.length<n.jump_list.length&&(l=n)}e.push(l)}return e};
this.getLine=function(b,e){var h=[];if(b.row===e.row){var k=e.col-b.col;h=0<k?this._getStraightLine(b,e,DIR_RIGHT,h):this._getStraightLine(b,e,DIR_LEFT,h)}else if(b.col===e.col)k=e.row-b.row,h=0<k?this._getStraightLine(b,e,DIR_BOT,h):this._getStraightLine(b,e,DIR_TOP,h);else{k=0<e.col-b.col?DIR_RIGHT:DIR_LEFT;var l=0<e.row-b.row?DIR_BOT:DIR_TOP;h=this._getStraightLine(b,e,l===DIR_BOT&&k===DIR_RIGHT?DIR_BOTRIGHT:l===DIR_BOT&&k===DIR_LEFT?DIR_BOTLEFT:l===DIR_TOP&&k===DIR_RIGHT?DIR_TOPRIGHT:DIR_TOPLEFT,
h)}return h};this.getOppositeDirection=function(b){switch(b){case DIR_TOPRIGHT:b=DIR_BOTLEFT;break;case DIR_RIGHT:b=DIR_LEFT;break;case DIR_BOTRIGHT:b=DIR_TOPLEFT;break;case DIR_TOPLEFT:b=DIR_BOTRIGHT;break;case DIR_LEFT:b=DIR_RIGHT;break;case DIR_BOTLEFT:b=DIR_TOPRIGHT;break;case DIR_TOP:b=DIR_BOT;break;case DIR_BOT:b=DIR_TOP;break;default:b=null}return b};this.getAllDirections=function(){var b=[DIR_TOPRIGHT,DIR_TOPLEFT,DIR_BOTRIGHT,DIR_BOTLEFT];d.movement===MOVEMENT_HORIZONTAL&&(b=[DIR_LEFT,DIR_TOP,
DIR_RIGHT,DIR_BOT]);return b};this.getForwardDirections=function(b){b===WHITE?(b=[DIR_TOPRIGHT,DIR_TOPLEFT],d.movement===MOVEMENT_HORIZONTAL&&(b=[DIR_LEFT,DIR_TOP,DIR_RIGHT])):(b=[DIR_BOTRIGHT,DIR_BOTLEFT],d.movement===MOVEMENT_HORIZONTAL&&(b=[DIR_LEFT,DIR_BOT,DIR_RIGHT]));return b};this.getBackwardDirections=function(b){b=this.getForwardDirections(b);for(var e=0;e<b.length;e++)b[e]=this.getOppositeDirection(b[e]);d.movement===MOVEMENT_HORIZONTAL&&(removeElementByValue(b,DIR_LEFT),removeElementByValue(b,
DIR_RIGHT));return b};this.getDistance=function(b,e){var h=new CVector2(b.col,b.row),k=new CVector2(e.col,e.row);h.subV(k);return h.length()};this.getMoveInfo=function(b,e,h){var k=e.dest;h=h[b.row][b.col];e=e.capture;return{sourcerow:b.row,sourcecol:b.col,destrow:k.row,destcol:k.col,sourcetype:h.type,sourcecolor:h.color,capturerow:e.logic_pos.row,capturecol:e.logic_pos.col,capturetype:e.type,capturecolor:e.color}};this.makeMove=function(b,e){e[b.sourcerow][b.sourcecol].color=null;e[b.sourcerow][b.sourcecol].type=
null;e[b.destrow][b.destcol].color=b.sourcecolor;e[b.destrow][b.destcol].type=b.sourcetype;e[b.capturerow][b.capturecol].color=null;e[b.capturerow][b.capturecol].type=null;if(d.pawn_can_continue_as_king)switch(b.destrow){case 0:b.sourcecolor===WHITE&&(e[b.destrow][b.destcol].type=KING);break;case e.length-1:b.sourcecolor===BLACK&&(e[b.destrow][b.destcol].type=KING)}};this.unmakeMove=function(b,e){e[b.destrow][b.destcol].color=null;e[b.destrow][b.destcol].type=null;e[b.sourcerow][b.sourcecol].color=
b.sourcecolor;e[b.sourcerow][b.sourcecol].type=b.sourcetype;e[b.capturerow][b.capturecol].color=b.capturecolor;e[b.capturerow][b.capturecol].type=b.capturetype};this._init(a);s_oMovesController=this}var s_oMovesController,ON_PIECE_START_MOVE="on_piece_start_move",ON_PIECE_MOVE="on_piece_move",ON_PIECE_MOVED="on_piece_moved",ON_PIECE_COMPLETED_ALL_MOVES="on_piece_completed_all_moves";
function CPiece(a,d,c,f,g){var b,e,h,k,l,m,n;this._init=function(q,r,u,x,w){b=u;e=x;h=[];k=[];m=new createjs.Container;m.x=q;m.y=r;w.addChild(m);q=u===WHITE?BOARD_PRESET[0].white_pawn:BOARD_PRESET[0].black_pawn;r=new createjs.Shape;r.graphics.beginFill(q).drawCircle(0,0,45);m.addChild(r);q="shader_pawn";u===BLACK&&(q="shader_pawn_positive");x===KING&&(q="shader_king");u=s_oSpriteLibrary.getSprite(q);l=createBitmap(u);l.regX=u.width/2-3;l.regY=u.height/2-3;m.addChild(l);u=s_oSpriteLibrary.getSprite("piece_lit");
n=createBitmap(u);n.regX=u.width/2;n.regY=u.height/2;n.alpha=.8;n.visible=!1;m.addChild(n)};this.unload=function(){g.removeChild(m)};this.addEventListener=function(q,r,u){h[q]=r;k[q]=u};this.getContainer=function(){return l};this.getType=function(){return e};this.getColor=function(){return b};this.rotate=function(q){l.rotation=q};this.setActive=function(q){n.visible=q};this.promote=function(){if(e===PAWN){e=KING;var q=s_oSpriteLibrary.getSprite("shader_king");l.image=q;new CParticle(0,0,m)}};this.move=
function(q,r,u){g.setChildIndex(m,g.numChildren-1);var x=createjs.Tween.get(m,{}),w=createjs.Tween.get(m,{}),v=r,F=u.getLogicPos();h[ON_PIECE_START_MOVE]&&h[ON_PIECE_START_MOVE].call(k[ON_PIECE_START_MOVE],F);for(u=0;u<q.length;u++){var y=q[u],t=y.pos;3<s_oMovesController.getDistance(F,y.dest)&&(v=1.5*r);var B=createjs.Ease.cubicOut;y.capture?(B=createjs.Ease.quadIn,w.to({scale:1.15},v/2,B).to({scale:1},v/2,createjs.Ease.sineIn).call(function(){playSound("jump",1,!1)})):playSound("pawn_move",1,!1);
x.call(function(L,C,V){h[ON_PIECE_MOVE]&&h[ON_PIECE_MOVE].call(k[ON_PIECE_MOVE],L,C,V)},[y,F,u],this);x.to(t,v,B);x.call(function(L){h[ON_PIECE_MOVED]&&h[ON_PIECE_MOVED].call(k[ON_PIECE_MOVED],L,this)},[y,this],this);F=y.dest}x.call(function(){this.setActive(!1);h[ON_PIECE_COMPLETED_ALL_MOVES]&&h[ON_PIECE_COMPLETED_ALL_MOVES].call(k[ON_PIECE_COMPLETED_ALL_MOVES],F,this)},[F,this],this)};this.disappear=function(){p.unload()};var p=this;this._init(a,d,c,f,g)}
function CTimePanel(a,d,c){var f,g,b,e,h,k;this._init=function(l,m,n){var p=s_oSpriteLibrary.getSprite("time_panel");b=new createjs.Container;f=l;g=m;b.x=f;b.y=g;n.addChild(b);l=p.width-30;n=40;h=new CTLText(b,-4-l/2,-330-n/2,l,n,36,"center","#ffffff",PRIMARY_FONT,1,2,2,TEXT_MINUTES,!0,!0,!1,!1);k=createBitmap(p);k.regX=p.width/2;k.regY=p.height/2;b.addChild(k);var q=["but_time_nomin","but_time_3min","but_time_5min","but_time_10min"];n=440;e=[];for(var r=0;r<q.length;r++)p=s_oSpriteLibrary.getSprite(q[r]),
m=-n/2+n/(q.length-1)*r,l=0,e[r]=new CToggle(l,m,p,!0,b),e[r].addEventListenerWithParams(ON_MOUSE_UP,this._onTimeToggle,this,MATCH_MINUTES_TYPE[r]);this._onTimeToggle(MATCH_MINUTES_TYPE[s_iPrefTimeMode])};this.unload=function(){for(var l=0;l<e.length;l++)e[l].unload();c.removeChild(b)};this.refreshPos=function(){s_bLandscape?(b.x=CANVAS_WIDTH-100-s_iOffsetX,b.y=CANVAS_HEIGHT-312-s_iOffsetY,this.setVertical()):(b.x=CANVAS_WIDTH/2,b.y=CANVAS_HEIGHT-520-s_iOffsetY,this.setHorizontal())};this._onTimeToggle=
function(l){for(var m=0;m<e.length;m++)e[m].setActive(!1);s_iPrefTimeMode=l=MATCH_MINUTES_TYPE.indexOf(l);s_oLocalStorage.saveData();e[l].setActive(!0)};this.setVertical=function(){k.rotation=0;k.scaleY=1;h.setY(-346);for(var l=0;l<e.length;l++)e[l].setPosition(0,-200+400/(e.length-1)*l)};this.setHorizontal=function(){k.rotation=90;k.scaleY=-1;h.setY(-130);for(var l=0;l<e.length;l++)e[l].setPosition(-200+400/(e.length-1)*l-2,-2)};this._init(a,d,c)}
function CRuleButton(a,d,c){var f,g,b,e,h,k,l,m,n,p=null,q,r,u,x,w,v,F;this._init=function(y,t,B){v=!1;F=1;h=[];k=[];var L=s_oSpriteLibrary.getSprite("time_panel");b=new createjs.Container;f=y;g=t;b.x=f;b.y=g;B.addChild(b);t=350;B=40;l=new CTLText(b,-4-t/2,-110-B/2,t,B,36,"center","#ffffff",PRIMARY_FONT,1,2,2,TEXT_RULE_CHANGE,!0,!0,!1,!1);m=createBitmap(L);m.regX=L.width/2;m.regY=L.height/2;m.rotation=90;m.scaleY=-1;b.addChild(m);y=-86;var C=s_oSpriteLibrary.getSprite("rule_desc_label");t=new createBitmap(C);
t.x=y;t.regX=C.width/2;t.regY=C.height/2;b.addChild(t);t=C.width-30;B=80;q=new CTLText(b,y-t/2,-6-B/2,t,B,50,"center",FONT_COLOR,PRIMARY_FONT,1,2,2,TEXT_RULE_INTERNATIONAL,!0,!0,!0,!1);L=s_oSpriteLibrary.getSprite("flag_desc_label");t=new createBitmap(L);t.x=y+C.width/2+L.width/2-4;t.regX=L.width/2;t.regY=L.height/2;b.addChild(t);L=s_oSpriteLibrary.getSprite("rule_flag_"+DEFAULT_RULE_FLAG);n=new createBitmap(L);n.x=t.x-2;n.y=-4;n.regX=L.width/2;n.regY=L.height/2;b.addChild(n);t=L.width;B=L.height;
y=new createjs.Shape;y.graphics.beginFill("#000").drawRoundRect(-t/2,-B/2,t,B,10);y.x=n.x;y.y=n.y;n.mask=y;y=s_oSpriteLibrary.getSprite("custom_icon");r=new createBitmap(y);r.x=n.x+L.width/2+2;r.y=n.y+L.height/2+1;r.regX=y.width;r.regY=y.height;r.visible=!1;b.addChild(r);this._initListener()};this.unload=function(){s_bMobile?b.off("mousedown",u):(b.off("mousedown",u),b.off("mouseover",x));b.off("pressup",w);c.removeChild(b)};this._initListener=function(){s_bMobile?u=b.on("mousedown",this.buttonDown):
(u=b.on("mousedown",this.buttonDown),x=b.on("mouseover",this.buttonOver));w=b.on("pressup",this.buttonRelease)};this.addEventListener=function(y,t,B){h[y]=t;k[y]=B};this.refreshPos=function(){s_bLandscape?(b.x=CANVAS_WIDTH/2,b.y=CANVAS_HEIGHT-100-s_iOffsetY):(b.x=CANVAS_WIDTH/2,b.y=CANVAS_HEIGHT-250-s_iOffsetY)};this.setScale=function(y){F=y;b.scale=F};this.buttonRelease=function(){v||(b.scale=F,h[ON_MOUSE_UP]&&h[ON_MOUSE_UP].call(k[ON_MOUSE_UP]))};this.buttonDown=function(){v||(b.scale=.9*F,playSound("click",
1,!1),h[ON_MOUSE_DOWN]&&h[ON_MOUSE_DOWN].call(k[ON_MOUSE_DOWN]))};this.buttonOver=function(y){s_bMobile||v||(y.target.cursor="pointer")};this.setPreset=function(y){var t=y.text;e=y.flag_id;y=y.custom;var B=s_oSpriteLibrary.getSprite("rule_flag_"+e);n.image=B;q.refreshText(t);r.visible=!1;y&&(r.visible=!0,t=RULE_PRESET[s_szCurRule].meta.denom+" "+TEXT_RULE_CUSTOM,q.refreshText(t))};this.addAlert=function(){var y=s_oSpriteLibrary.getSprite("time_panel");p=new CAlertIcon(y.height/2-20,-y.width/2+10,
"1",b);p.pulseAnimation()};this.refreshTextByLang=function(y){console.log("szText "+y);l.refreshText(TEXT_RULE_CHANGE);q.refreshText(y)};this.removeAlert=function(){null!==p&&p.unload()};this.setY=function(y){b.y=y};this.getFlag=function(){return e};this._init(a,d,c)}
function CRulePanel(a,d,c){var f,g,b,e,h,k,l,m,n,p,q,r,u,x,w,v,F,y,t,B,L,C,V,ba,ia,qa,wa,Ca,Da,Aa,ka,J,A,Z,ta,ra,W;this._init=function(D,M,Q){k=[];l=[];var K=s_oSpriteLibrary.getSprite("bg_menu");e=createBitmap(K);e.on("click",function(){},this);Q.addChild(e);K=s_oSpriteLibrary.getSprite("but_exit");f=CANVAS_WIDTH-K.height/2-10;g=K.height/2+25;Z=new CGfxButton(f,g,K,Q);Z.addEventListener(ON_MOUSE_UP,this._onExit,this);b=new createjs.Container;b.x=D;b.y=M;Q.addChild(b);m=new createjs.Container;m.y=
-600;b.addChild(m);M=6;K=s_oSpriteLibrary.getSprite("but_bwd");u=new CGfxButton(-350,M,K,m);u.addEventListener(ON_MOUSE_UP,this._onButBack,this);K=s_oSpriteLibrary.getSprite("but_fwd");x=new CGfxButton(350,M,K,m);x.addEventListener(ON_MOUSE_UP,this._onButFwd,this);D=-96;M=s_oSpriteLibrary.getSprite("rule_desc_label");Q=new createBitmap(M);Q.x=D;Q.regX=M.width/2;Q.regY=M.height/2;m.addChild(Q);Q=M.width-30;var pa=80;w=new CTLText(m,D-Q/2,-6-pa/2,Q,pa,50,"center",FONT_COLOR,PRIMARY_FONT,1,2,2,TEXT_RULE_INTERNATIONAL,
!0,!0,!0,!1);K=s_oSpriteLibrary.getSprite("flag_desc_label");Q=new createBitmap(K);Q.x=D+M.width/2+K.width/2+14;Q.regX=K.width/2;Q.regY=K.height/2;m.addChild(Q);K=s_oSpriteLibrary.getSprite("rule_flag_0");v=new createBitmap(K);v.x=Q.x-2;v.y=-4;v.regX=K.width/2;v.regY=K.height/2;m.addChild(v);Q=K.width;pa=K.height;D=new createjs.Shape;D.graphics.beginFill("#000").drawRoundRect(-Q/2,-pa/2,Q,pa,10);D.x=v.x;D.y=v.y;v.mask=D;D=s_oSpriteLibrary.getSprite("custom_icon");F=new createBitmap(D);F.x=v.x+K.width/
2+2;F.y=v.y+K.height/2+1;F.regX=D.width;F.regY=D.height;F.visible=!1;m.addChild(F);Q=500;pa=80;y=new CTLText(m,-(Q/2),-100-pa/2,Q,pa,50,"center","#fff",PRIMARY_FONT,1,2,2," ",!0,!0,!1,!1);K=s_oSpriteLibrary.getSprite("rule_toggle");D=250+K.width/4-30;n=new createjs.Container;n.y=-400;b.addChild(n);t=new CRuleSectionPanel(0,0,800,400,n,TEXT_RULE_CAPTURE);M=130;ta=new CTLText(n,-310,M-40,500,80,50,"left",FONT_COLOR,PRIMARY_FONT,1,2,2,TEXT_RULE_MANDATORY_CAPTURE,!0,!0,!1,!1);K=s_oSpriteLibrary.getSprite("rule_toggle");
V=new CToggle(D,M,K,!0,n);V.addEventListener(ON_MOUSE_UP,this._onMandatoryCapture,this);M+=100;qa=new CTLText(n,-310,M-40,500,80,50,"left",FONT_COLOR,PRIMARY_FONT,1.2,2,2,TEXT_RULE_MANDATORY_MAX_CAPTURE,!0,!0,!0,!1);K=s_oSpriteLibrary.getSprite("rule_toggle");ba=new CToggle(D,M+10,K,!0,n);ba.addEventListener(ON_MOUSE_UP,this._onMaxCapture,this);M+=100;wa=new CTLText(n,-310,M-40,500,80,50,"left",FONT_COLOR,PRIMARY_FONT,1.2,2,2,TEXT_RULE_KING_CAPTURE_FIRST,!0,!0,!0,!1);K=s_oSpriteLibrary.getSprite("rule_toggle");
ia=new CToggle(D,M+10,K,!0,n);ia.addEventListener(ON_MOUSE_UP,this._onKingFirst,this);p=new createjs.Container;p.y=0;b.addChild(p);L=new CRuleSectionPanel(0,0,800,210,p,TEXT_PAWN);M=130;ra=new CTLText(p,-310,M-40,500,80,50,"left",FONT_COLOR,PRIMARY_FONT,1.2,2,2,TEXT_PAWN_RULE_BACK,!0,!0,!0,!1);K=s_oSpriteLibrary.getSprite("rule_toggle");Ca=new CToggle(D,M+10,K,!0,p);Ca.addEventListener(ON_MOUSE_UP,this._onBackCapture,this);q=new createjs.Container;q.y=300;b.addChild(q);C=new CRuleSectionPanel(0,0,
800,310,q,TEXT_KING);M=130;W=new CTLText(q,-310,M-40,500,80,50,"left",FONT_COLOR,PRIMARY_FONT,1.2,2,2,TEXT_RULE_PROTECTED_KING,!0,!0,!0,!1);K=s_oSpriteLibrary.getSprite("rule_toggle");Da=new CToggle(D,M+10,K,!0,q);Da.addEventListener(ON_MOUSE_UP,this._onProtectCapture,this);M+=115;pa=100;K=s_oSpriteLibrary.getSprite("but_bwd");Aa=new CGfxButton(-270,M,K,q);Aa.addEventListener(ON_MOUSE_UP,this._onButKingMoveBack,this);Aa.setScale(.75);K=s_oSpriteLibrary.getSprite("but_fwd");ka=new CGfxButton(270,M,
K,q);ka.addEventListener(ON_MOUSE_UP,this._onButKingMoveFWD,this);ka.setScale(.75);Q=450;J=new CTLText(q,-(Q/2),M-10-40,Q,80,60,"center",FONT_COLOR,PRIMARY_FONT,1.2,2,2,TEXT_RULE_MOVEMENT_KING_LONG,!0,!0,!0,!1);r=new createjs.Container;b.addChild(r);B=new CRuleSectionPanel(0,0,800,230,r,TEXT_RULE_NOTE);Q=620;pa=120;A=new CTLText(r,-(Q/2),140-pa/2,Q,pa,60,"center",FONT_COLOR,PRIMARY_FONT,1.2,2,2,TEXT_RULE_NOTE_RUSSIAN,!0,!0,!0,!1);this._uniformFontSize();s_iCurRuleFlag=this._getRuleID(s_oRules);this.setPreset(s_oRules);
this._isCustomPreset(s_oRules)&&this._setCustom()};this.unload=function(){e.removeAllEventListeners();Z.unload();u.unload();x.unload();V.unload();ba.unload();ia.unload();Ca.unload();Da.unload();Aa.unload();ka.unload()};this.refreshPos=function(){Z.setPosition(f-s_iOffsetX,s_iOffsetY+g);if(s_bLandscape){var D=.7;m.x=0;m.y=-250;t.setPosition(0,-50);t.redraw(800,580);n.x=-300;n.y=-124;n.scale=D;p.x=-n.x;p.y=-160;p.scale=D;q.x=p.x;q.y=30;q.scale=D;B.redraw(1650,150);r.y=290;r.scale=D;D=800;A.setHorizontalSize(D,
2);A.setX(-D/2);A.setY(10)}else D=1,m.x=0,m.y=-600,t.setPosition(0,0),t.redraw(800,400),n.x=0,n.y=-500,n.scale=D,p.x=0,p.y=-50,p.scale=D,q.x=0,q.y=210,q.scale=D,B.redraw(800,230),r.y=570,r.scale=D,D=620,A.setHorizontalSize(D,2),A.setX(-D/2),A.setY(70)};this.addEventListener=function(D,M,Q){k[D]=M;l[D]=Q};this.show=function(){e.visible=!0;b.visible=!0;Z.setVisible(!0)};this.hide=function(){e.visible=!1;b.visible=!1;Z.setVisible(!1)};this.setReadOnly=function(){u.setVisible(!1);x.setVisible(!1);V.setClickable(!1);
ba.setClickable(!1);ia.setClickable(!1);Ca.setClickable(!1);Da.setClickable(!1);Aa.setVisible(!1);ka.setVisible(!1)};this._uniformFontSize=function(){var D=[];D.push(ta);D.push(qa);D.push(wa);D.push(ra);D.push(W);D.push(J);for(var M=100,Q=0;Q<D.length;Q++){var K=D[Q];K=K.getFontSize();K<M&&(M=K)}for(Q=0;Q<D.length;Q++)K=D[Q],K.setFontSize(M)};this._onExit=function(){k[ON_EXIT_RULE_PANEL]&&k[ON_EXIT_RULE_PANEL].call(l[ON_EXIT_RULE_PANEL])};this._onButBack=function(){s_iCurRuleFlag--;0>s_iCurRuleFlag&&
(s_iCurRuleFlag=RULES_ORDER.length-1);this._changeRulePreset()};this._onButFwd=function(){s_iCurRuleFlag++;s_iCurRuleFlag>=RULES_ORDER.length&&(s_iCurRuleFlag=0);this._changeRulePreset()};this._changeRulePreset=function(){s_szCurRule=RULES_ORDER[s_iCurRuleFlag];F.visible=!1;s_oRules=copyObjectByValue(RULE_PRESET[s_szCurRule]);this.setPreset(s_oRules);s_oLocalStorage.saveData()};this.setPreset=function(D){var M=this._getRuleID(D),Q=RULES_ORDER[M];M=s_oSpriteLibrary.getSprite("rule_flag_"+M);v.image=
M;w.refreshText(RULE_PRESET[Q].meta.denom);M=D.starting_board.length;y.refreshText(M+"x"+M+", "+(D.movement===MOVEMENT_DIAGONAL?TEXT_RULE_MOVEMENT_DIAGONAL:TEXT_RULE_MOVEMENT_STRAIGHT).toUpperCase());V.setActive(D.capture_rule.mandatory);ba.setActive(D.capture_rule.maximize);ia.setActive(D.capture_rule.king_first);Ca.setActive(D.capture_rule.back);h=this._getMoveID(D);this._changeKingMovement();Da.setActive(D.capture_rule.king_protected);this._enableMandatorySubsection(D.capture_rule.mandatory);D=
RULE_PRESET[Q].meta.notes;""!==D?(r.visible=!0,A.refreshText(D)):r.visible=!1;ta.refreshText(TEXT_RULE_MANDATORY_CAPTURE);qa.refreshText(TEXT_RULE_MANDATORY_MAX_CAPTURE);wa.refreshText(TEXT_RULE_KING_CAPTURE_FIRST);ra.refreshText(TEXT_PAWN_RULE_BACK);t.changeTextTitle(TEXT_RULE_CAPTURE.toUpperCase());L.changeTextTitle(TEXT_PAWN.toUpperCase());C.changeTextTitle(TEXT_KING.toUpperCase());W.refreshText(TEXT_RULE_PROTECTED_KING);B.changeTextTitle(TEXT_RULE_NOTE.toUpperCase())};this._enableMandatorySubsection=
function(D){D?(qa.setAlpha(1),wa.setAlpha(1),ba.enable(),ia.enable()):(qa.setAlpha(.5),wa.setAlpha(.5),ba.disable(),ia.disable())};this._onButKingMoveBack=function(){h--;0>h&&(h=KING_MOVE_ORDER.length-1);this._setCustom();this._changeKingMovement();s_oLocalStorage.saveData()};this._onButKingMoveFWD=function(){h++;h>=KING_MOVE_ORDER.length&&(h=0);this._setCustom();this._changeKingMovement();s_oLocalStorage.saveData()};this._changeKingMovement=function(){var D="";switch(h){case 0:D=TEXT_RULE_MOVEMENT_KING_SHORT;
break;case 1:D=TEXT_RULE_MOVEMENT_KING_LONG;break;case 2:D=TEXT_RULE_MOVEMENT_KING_LONG_BLOCK}J.refreshText(D);s_oRules.king_movement=KING_MOVE_ORDER[h]};this._onMandatoryCapture=function(){this._setCustom();var D=V.getState();s_oRules.capture_rule.mandatory=D;this._enableMandatorySubsection(D);s_oLocalStorage.saveData()};this._onMaxCapture=function(){this._setCustom();var D=ba.getState();s_oRules.capture_rule.maximize=D;s_oLocalStorage.saveData()};this._onKingFirst=function(){this._setCustom();var D=
ia.getState();s_oRules.capture_rule.king_first=D;s_oLocalStorage.saveData()};this._onBackCapture=function(){this._setCustom();var D=Ca.getState();s_oRules.capture_rule.back=D;console.log(s_oRules);s_oLocalStorage.saveData()};this._onProtectCapture=function(){this._setCustom();var D=Da.getState();s_oRules.capture_rule.king_protected=D;s_oLocalStorage.saveData()};this.removeCustom=function(){F.visible=!1};this._setCustom=function(){F.visible=!0;w.refreshText(RULE_PRESET[s_szCurRule].meta.denom+" "+
TEXT_RULE_CUSTOM)};this._isCustomPreset=function(){var D=copyObjectByValue(RULE_PRESET[s_szCurRule]),M=copyObjectByValue(s_oRules);D.meta={};M.meta={};return!deepEqual(D,M)};this._getRuleID=function(D){var M=0,Q;for(Q in RULE_PRESET)RULE_PRESET[Q].id===D.id&&(M=RULES_ORDER.indexOf(Q));return M};this._getMoveID=function(D){return KING_MOVE_ORDER.indexOf(D.king_movement)};this.getInfo=function(){return{text:w.getText().text,flag_id:s_iCurRuleFlag,custom:this._isCustomPreset()}};this._init(a,d,c)}
function CRuleSectionPanel(a,d,c,f,g,b){var e,h,k,l;this._init=function(m,n,p,q,r,u){e=new createjs.Container;e.x=m;e.y=n;r.addChild(e);k=new createjs.Shape;e.addChild(k);h=new createjs.Shape;e.addChild(h);m=p-120;l=new CTLText(e,-m/2-30,10,m,80,50,"left","#fff",PRIMARY_FONT,1,2,2,u.toUpperCase(),!0,!0,!1,!1);this.redraw(p,q)};this.unload=function(){g.removeChild(e)};this.redraw=function(m,n){k.graphics.clear();k.graphics.beginFill("#c69944").drawRoundRect(-m/2,0,m,n,20);h.graphics.clear();h.graphics.setStrokeStyle(10);
h.graphics.beginStroke(FONT_COLOR).drawRoundRect(-m/2,0,m,n,20);l.setX(-(m-120)/2-30)};this.changeTextTitle=function(m){l.refreshText(m)};this.setPosition=function(m,n){e.x=m;e.y=n};this._init(a,d,c,f,g,b)}
function CCapturedCounter(a,d,c,f,g){var b,e,h,k;this._init=function(){b=new createjs.Container;b.x=a;b.y=d;g.addChild(b);k=0;var l=s_oSpriteLibrary.getSprite(f+"_"+c+"_marker");h=createBitmap(l);h.regX=l.width/2;h.regY=l.height;h.scale=.4;b.addChild(h);l=new createjs.Shape;l.graphics.beginFill("black").drawCircle(15,-8,12);b.addChild(l);e=new CTLText(b,3,-20,24,24,18,"center","white",PRIMARY_FONT,1,2,2,k+"",!0,!0,!1,!1,11,!1)};this.unload=function(){g.removeChild(b)};this.reset=function(){k=0;this.setNum(k+
"")};this.setNum=function(l){e.refreshText(l)};this.increase=function(){k++;this.setNum(k+"")};this.setColor=function(l){l=s_oSpriteLibrary.getSprite(l+"_"+c+"_marker");h.image=l};this._init()}
function CInterfaceBase(a){this._oForegroundContainer;this._oButExit;this._oAudioToggle;this._oWhitePanel;this._oBlackPanel;this._oButFullscreen;this._oAreYouSurePanel;this._oGUIExpandible;this._oButDraw;this._oButSurrender;this._oButUndo;this._oButStats;this._fCancelFullScreen=this._fRequestFullScreen=null;this._pStartPosFullscreen;this._pStartPossetDrawStateExit;this._pStartPosAudio;this._pStartPosDraw;this._pStartPosUndo;this._pStartPosSurrender;this._pStartPosUndo;this._iXOffset;s_oInterface=
this}
CInterfaceBase.prototype._init=function(a){this._oForegroundContainer=a;this._oButContainer=new createjs.Container;s_oStage.addChild(this._oButContainer);var d=s_oSpriteLibrary.getSprite("but_exit");this._pStartPosExit={x:CANVAS_WIDTH-d.height/2-10,y:d.height/2+25};this._oButExit=new CGfxButton(this._pStartPosExit.x,this._pStartPosExit.y,d,s_oStage);this._oButExit.addEventListener(ON_MOUSE_UP,this._onExit,this);a=CANVAS_WIDTH-d.width/2-125;if(!1===DISABLE_SOUND_MOBILE||!1===s_bMobile)d=s_oSpriteLibrary.getSprite("audio_icon"),this._pStartPosAudio=
{x:a,y:25+d.height/2},this._oAudioToggle=new CToggle(this._pStartPosAudio.x,this._pStartPosAudio.y,d,s_bAudioActive,s_oStage),this._oAudioToggle.addEventListener(ON_MOUSE_UP,this._onAudioToggle,this);a=window.document;d=a.documentElement;this._fRequestFullScreen=d.requestFullscreen||d.mozRequestFullScreen||d.webkitRequestFullScreen||d.msRequestFullscreen;this._fCancelFullScreen=a.exitFullscreen||a.mozCancelFullScreen||a.webkitExitFullscreen||a.msExitFullscreen;!1===ENABLE_FULLSCREEN&&(this._fRequestFullScreen=
!1);this._fRequestFullScreen&&screenfull.isEnabled&&(d=s_oSpriteLibrary.getSprite("but_fullscreen"),this._pStartPosFullscreen={x:d.width/4+16,y:d.height/2+25},this._oButFullscreen=new CToggle(this._pStartPosFullscreen.x,this._pStartPosFullscreen.y,d,s_bFullscreen,s_oStage),this._oButFullscreen.addEventListener(ON_MOUSE_UP,this._onFullscreenRelease,this));d=s_oSpriteLibrary.getSprite("but_info_rules");this._oInfoRules=new CGfxButton(0,0,d,s_oStage);this._oInfoRules.addEventListener(ON_MOUSE_UP,this._onInfoRules,
this);d=s_oSpriteLibrary.getSprite("but_settings");this._oGUIExpandible=new CGUIExpandible(this._pStartPosExit.x,this._pStartPosExit.y,d,this._oButContainer);this._oGUIExpandible.addButton(this._oButExit);!1!==DISABLE_SOUND_MOBILE&&!1!==s_bMobile||this._oGUIExpandible.addButton(this._oAudioToggle);this._fRequestFullScreen&&screenfull.isEnabled&&this._oGUIExpandible.addButton(this._oButFullscreen);this._oGUIExpandible.addButton(this._oInfoRules);this._oRulePanel=new CRulePanel(CANVAS_WIDTH/2,CANVAS_HEIGHT/
2,s_oStage);this._oRulePanel.addEventListener(ON_EXIT_RULE_PANEL,this._onExitRules,this);this._oRulePanel.hide();this._oRulePanel.setReadOnly();this._iXOffset=110};CInterfaceBase.prototype.unload=function(){this._oButExit.unload();!1!==DISABLE_SOUND_MOBILE&&!1!==s_bMobile||this._oAudioToggle.unload();this._fRequestFullScreen&&screenfull.isEnabled&&this._oButFullscreen.unload();this._oGUIExpandible.unload();this._oRulePanel.unload();s_oInterface=this._oAreYouSurePanel=null};
CInterfaceBase.prototype.refreshButtonPos=function(){this._oGUIExpandible.setPosition(this._pStartPosExit.x-s_iOffsetX,this._pStartPosExit.y+s_iOffsetY);this._oRulePanel.refreshPos();s_oGame&&s_oGame.refreshGUI();this.refreshInfoPanelPos()};
CInterfaceBase.prototype.refreshInfoPanelPos=function(){if(this._oWhitePanel){var a=this._oBlackPanel.getSide()===TOP,d=this._getInfoPanelPos(a);a=d.white_pos;d=d.black_pos;this._oWhitePanel.setPosition(a.x,a.y);this._oWhitePanel.refreshNotifyPos();this._oBlackPanel.setPosition(d.x,d.y);this._oBlackPanel.refreshNotifyPos()}};CInterfaceBase.prototype.showTime=function(a){this._oWhitePanel.setTimeVisible(a);this._oBlackPanel.setTimeVisible(a)};CInterfaceBase.prototype.refreshWhiteTime=function(a){this._oWhitePanel.refreshTime(formatTime(a))};
CInterfaceBase.prototype.refreshBlackTime=function(a){this._oBlackPanel.refreshTime(formatTime(a))};CInterfaceBase.prototype.refreshWhiteScore=function(a){this._oWhitePanel.refreshScore(a)};CInterfaceBase.prototype.refreshBlackScore=function(a){this._oBlackPanel.refreshScore(a)};CInterfaceBase.prototype.activePlayer=function(a){a===WHITE?(this._oBlackPanel.active(!1),this._oWhitePanel.active(!0)):(this._oWhitePanel.active(!1),this._oBlackPanel.active(!0))};
CInterfaceBase.prototype.setPlayerInfoCheck=function(a,d){a===WHITE?this._oWhitePanel.setCheckState(d):this._oBlackPanel.setCheckState(d)};CInterfaceBase.prototype.setPlayerInfoNormal=function(){this._oWhitePanel.setNormalState();this._oBlackPanel.setNormalState()};CInterfaceBase.prototype.resetInfo=function(){this._oWhitePanel.refreshTime(formatTime(0));this._oBlackPanel.refreshTime(formatTime(0));this._oWhitePanel.refreshScore(START_SCORE);this._oBlackPanel.refreshScore(START_SCORE)};
CInterfaceBase.prototype.setInfoVisible=function(a){this._oWhitePanel.setPanelVisible(a);this._oBlackPanel.setPanelVisible(a)};CInterfaceBase.prototype.setPlayersInfo=function(a,d){this._oWhitePanel.setName(a);this._oBlackPanel.setName(d)};CInterfaceBase.prototype._onButConfigRelease=function(){new CConfigPanel};CInterfaceBase.prototype._onButRestartRelease=function(){s_oGame.restartGame()};CInterfaceBase.prototype._onExit=function(){this._oAreYouSurePanel=new CAreYouSurePanel(s_oGame.onExit)};
CInterfaceBase.prototype._onAudioToggle=function(){Howler.mute(s_bAudioActive);s_bAudioActive=!s_bAudioActive};CInterfaceBase.prototype.resetFullscreenBut=function(){this._fRequestFullScreen&&screenfull.isEnabled&&this._oButFullscreen.setActive(s_bFullscreen)};CInterfaceBase.prototype._onFullscreenRelease=function(){s_bFullscreen?this._fCancelFullScreen.call(window.document):this._fRequestFullScreen.call(window.document.documentElement);sizeHandler()};CInterfaceBase.prototype.addDrawOption=function(){this._oButDraw.setVisible(!0)};
CInterfaceBase.prototype.addUndoOption=function(){this._oButUndo.setVisible(!0)};CInterfaceBase.prototype.addStatsOption=function(){};CInterfaceBase.prototype.addSurrenderOption=function(){this._oButSurrender.setVisible(!0)};CInterfaceBase.prototype.enableUndo=function(){this._oButUndo.enable()};CInterfaceBase.prototype.disableUndo=function(){this._oButUndo.disable()};CInterfaceBase.prototype.setDrawState=function(a){a===WHITE?this._oWhitePanel.setNotify(TEXT_WAIT_FOR_A_DRAW):this._oBlackPanel.setNotify(TEXT_WAIT_FOR_A_DRAW)};
CInterfaceBase.prototype.disableDrawState=function(a){a===WHITE?this._oWhitePanel.disableNotify():this._oBlackPanel.disableNotify()};CInterfaceBase.prototype.notifyOpponentDraw=function(a){a===WHITE?this._oWhitePanel.setNotify(TEXT_OFFERED_DRAW):this._oBlackPanel.setNotify(TEXT_OFFERED_DRAW)};CInterfaceBase.prototype.disableNotifyDraw=function(a){this.stopNotifyAnimation();a===WHITE?this._oWhitePanel.disableNotify():this._oBlackPanel.disableNotify()};CInterfaceBase.prototype.notifyAnimation=function(){this._oButDraw.trembleAnimation()};
CInterfaceBase.prototype.stopNotifyAnimation=function(){this._oButDraw.stopTrembleAnimation()};CInterfaceBase.prototype.setCheckState=function(a,d){};CInterfaceBase.prototype._onUndo=function(){s_oGame.onUndo()};CInterfaceBase.prototype._onRedo=function(){s_oGame.onRedo()};CInterfaceBase.prototype.setInfoPanelVisible=function(a,d){this._oWhitePanel.getSide()===a&&this._oWhitePanel.setPanelVisible(d);this._oBlackPanel.getSide()===a&&this._oBlackPanel.setPanelVisible(d)};
CInterfaceBase.prototype._getInfoPanelPos=function(a){if(s_bLandscape){var d=386,c={x:640,y:d},f={x:c.x,y:-d};1.6<s_iAspectRatio&&(f={x:-c.x,y:-d})}else d=536,c={x:280,y:d},f={x:-280,y:-d};a?(a=c,c=f):a=f;return{white_pos:a,black_pos:c}};CInterfaceBase.prototype.configureInfoPanel=function(a){var d=this._getInfoPanelPos(a);a=d.white_pos;d=d.black_pos;this._oWhitePanel=new CInfoTurn(a.x,a.y,WHITE,this._oForegroundContainer);this._oBlackPanel=new CInfoTurn(d.x,d.y,BLACK,this._oForegroundContainer)};
CInterfaceBase.prototype.updateStats=function(a,d,c,f){this._oWhitePanel.setCapturedList(d);this._oBlackPanel.setCapturedList(a);this._oWhitePanel.setPercent(c);this._oBlackPanel.setPercent(f)};CInterfaceBase.prototype._onInfoRules=function(){this._oRulePanel.show()};CInterfaceBase.prototype._onExitRules=function(){this._oRulePanel.hide()};var s_oInterface=null;function CInterfaceSingle(a){CInterfaceBase.call(this,a);this._oSuper=CInterfaceBase.prototype;this._init(a)}CInterfaceSingle.prototype=Object.create(CInterfaceBase.prototype);
CInterfaceSingle.prototype._init=function(a){this._oSuper._init.call(this,a);this.refreshButtonPos()};CInterfaceSingle.prototype.unload=function(){this._oSuper.unload.call(this);this._oBlackPanel.unload();this._oWhitePanel.unload()};CInterfaceSingle.prototype.refreshButtonPos=function(){this._oSuper.refreshButtonPos.call(this)};function CInterfaceMulti(a){CInterfaceBase.call(this,a);this._oSuper=CInterfaceBase.prototype;this._init(a)}CInterfaceMulti.prototype=Object.create(CInterfaceBase.prototype);
CInterfaceMulti.prototype._init=function(a){this._oSuper._init.call(this,a);a=s_oSpriteLibrary.getSprite("but_draw");this._pStartPosDraw={x:this._pStartPosExit.x-a.width-10,y:a.height/2+25};this._oButDraw=new CSecurityButton(this._pStartPosDraw.x,this._pStartPosDraw.y,a,this._oButContainer);this._oButDraw.addEventListener(ON_MOUSE_UP,this._onDraw,this);this._oButDraw.setVisible(!1);a=s_oSpriteLibrary.getSprite("but_surrender");this._pStartPosSurrender={x:this._pStartPosDraw.x-a.width-10,y:a.height/
2+25};this._oButSurrender=new CSecurityButton(this._pStartPosSurrender.x,this._pStartPosSurrender.y,a,this._oButContainer);this._oButSurrender.addEventListener(ON_MOUSE_UP,this._onSurrender,this);this._oButSurrender.setVisible(!1);this._oRulePanel.setPreset(s_oGame.getRules());this._oRulePanel.removeCustom();this._oRulePanel.setReadOnly();this.refreshButtonPos()};CInterfaceMulti.prototype.unload=function(){this._oSuper.unload.call(this);this._oButDraw.unload();this._oBlackPanel.unload();this._oWhitePanel.unload()};
CInterfaceMulti.prototype.refreshButtonPos=function(){this._oSuper.refreshButtonPos.call(this);var a=s_oSpriteLibrary.getSprite("but_draw");if(s_bLandscape&&1.6>=s_iAspectRatio){var d=this._pStartPosExit.x-s_iOffsetX;var c=CANVAS_HEIGHT-s_iOffsetY-a.height/2;this._oButDraw.setPosition(d,c);this._oButSurrender.setPosition(d,c-a.height-10)}else d=this._pStartPosDraw.x-s_iOffsetX,c=this._pStartPosDraw.y+s_iOffsetY,this._oButDraw.setPosition(d,c),this._oButSurrender.setPosition(d-a.width-10,c)};
CInterfaceMulti.prototype.disableUndo=function(){};CInterfaceMulti.prototype._onDraw=function(){s_oGame.onDrawToggle()};CInterfaceMulti.prototype._onSurrender=function(){s_oGame.onSurrender()};
function CBoard(a,d,c,f,g){var b,e,h,k,l,m;this._init=function(n,p,q){b=new createjs.Container;b.x=n;b.y=p;q.addChild(b);n=s_oSpriteLibrary.getSprite("board_occlusion");p=createBitmap(n);p.regX=n.width/2;p.regY=n.height/2;b.addChild(p);e=new createjs.Container;b.addChild(e);h=new createjs.Container;b.addChild(h);this.drawFrame(0,-402,BOARD_PRESET[0].frame,0);this.drawFrame(0,402,BOARD_PRESET[0].frame,180);this.drawFrame(-402,0,BOARD_PRESET[0].frame,-90);this.drawFrame(402,0,BOARD_PRESET[0].frame,
90);k=CELL_SIZE_REFERENCE;p=CELL_SIZE_REFERENCE*(f-1);m=[];q=g;var r=0;for(n=0;n<f;n++){m[n]=[];for(var u=0;u<f;u++){var x=-p/2+p/(f-1)*u,w=-p/2+p/(f-1)*n;n!==r&&(r=n,q=q===WHITE?BLACK:WHITE);x=this.drawCell(x,w,q);m[n][u]=x;q=q===WHITE?BLACK:WHITE}}l=NUM_CELL_REFERENCE/f;for(n=0;n<f;n++)p=m[0][n].x*l,this.drawCoordinate(p,428,0,this.getLettersFromIndex(n)),this.drawCoordinate(p,-428,180,this.getLettersFromIndex(n));for(n=0;n<f;n++)q=f-n,p=m[n][0].y*l,this.drawCoordinate(-428,p,0,q),this.drawCoordinate(428,
p,180,q);n=s_oSpriteLibrary.getSprite("board_pattern");p=createBitmap(n);p.regX=n.width/2;p.regY=n.height/2;p.alpha=.8;h.addChild(p);n=s_oSpriteLibrary.getSprite("board_focus_shape");p=createBitmap(n);p.regX=n.width/2;p.regY=n.height/2;h.addChild(p);e.scale=l;n=b.getBounds();b.cache(-n.width/2,-n.height/2,n.width,n.height)};this.drawFrame=function(n,p,q,r){var u=s_oSpriteLibrary.getSprite("board_frame"),x=new createjs.Container;x.x=n;x.y=p;x.rotation=r;h.addChild(x);n=new createjs.Shape;n.graphics.beginFill(q);
n.graphics.moveTo(0,-7);n.graphics.lineTo(-410,-7);n.graphics.lineTo(-447,-45);n.graphics.lineTo(447,-45);n.graphics.lineTo(410,-7);x.addChild(n);q=createBitmap(u);q.regX=u.width/2;q.regY=u.height;x.addChild(q)};this.drawCell=function(n,p,q){q=q===WHITE?BOARD_PRESET[0].white_tile:BOARD_PRESET[0].black_tile;var r=new createjs.Shape;r.graphics.beginFill(q).drawRect(-k/2,-k/2,k,k);r.x=n;r.y=p;e.addChild(r);return r};this.drawCoordinate=function(n,p,q,r){var u=new createjs.Container;u.x=n;u.y=p;u.rotation=
q;h.addChild(u);new CTLText(u,-20,-20,40,40,30,"center",BOARD_PRESET[0].letters_color,SECONDARY_FONT,1,4,4,r,!0,!0,!1,!1)};this.getLettersFromIndex=function(n){return BOARD_PRESET[0].coords[n]};this.getCellSize=function(){return k};this.getCells=function(){return m};this.getCellsPos=function(){for(var n=[],p=0;p<m.length;p++){n[p]=[];for(var q=0;q<m[p].length;q++)n[p][q]={x:m[p][q].x,y:m[p][q].y}}return n};this.getScale=function(){return l};this.getBounds=function(){return b.getBounds()};this._init(a,
d,c)}
function CPathDrawer(a,d,c){var f,g,b;this._init=function(e,h,k){f=new createjs.Container;k.addChild(f);g=e;b=[]};this.drawAllTrack=function(e){var h=this._getPathWithCapture(e);e=[];1<=h.length&&(e=this._joinPath(h));h=.5*d;b=[];for(var k=0;k<e.length;k++){var l=e[k],m=0,n=0;1!==e.length&&(m=-h/2+h/(e.length-1)*k,n=-h/2+h/(e.length-1)*k);var p=BOARD_PRESET[0].path_colors;p=p[k%p.length];for(var q=0;q<l.terminal_list.length;q++){var r=s_oMovesController.getAllCellsFromAPath(l);r.unshift(l.src);r.splice(r.length-
1,1);var u=l.terminal_list[q];r.push(l.terminal_list[q]);r=this._drawTrack(r,m,n,p);b.push({draw:r,dest:u})}}};this.clear=function(){for(var e=0;e<b.length;e++)f.removeChild(b[e].draw);b=[]};this.showSinglePath=function(e){for(var h=0;h<b.length;h++){var k=b[h],l=k.draw;l.visible=!1;k.dest.row===e.row&&k.dest.col===e.col&&(l.visible=!0)}};this.hideAll=function(){for(var e=0;e<b.length;e++)b[e].draw.visible=!1};this._drawTrack=function(e,h,k,l){var m=new createjs.Container;f.addChild(m);var n=e[0];
n=g[n.row][n.col];var p=new createjs.Shape;p.graphics.beginFill(l).drawRect(-8,-8,16,16);p.x=n.x;p.y=n.y;m.addChild(p);p=new createjs.Shape;p.graphics.setStrokeStyle(4);p.graphics.beginStroke(l);p.graphics.moveTo(n.x,n.y);for(var q=1;q<e.length;q++){n=e[q];n=g[n.row][n.col];var r=n.x+h;var u=n.y+k;p.graphics.lineTo(r,u)}p.graphics.lineTo(n.x,n.y);e=new createjs.Shape;e.graphics.beginFill(l).drawCircle(n.x,n.y,8);m.addChild(e);m.addChild(p);return m};this._getPathWithCapture=function(e){for(var h=
[],k=0;k<e.length;k++){var l=e[k];0<s_oMovesController.getNumCaptureInPath(l)&&h.push(l)}return h};this._joinPath=function(e){for(var h=[],k=0;k<e.length;k++){var l=e[k],m=[];m.push(l.terminal);for(var n=1;n<e.length;n++){var p=e[n];this._matchCaptureList(l.jump_list,p.jump_list)&&(m.push(p.terminal),e.splice(n,1),n--)}l.terminal_list=m;h.push(l);e.splice(0,1);k--}return h};this._matchCaptureList=function(e,h){var k=!0;if(e.length===h.length)for(var l=0;l<e.length;l++){if(!deepEqual(e[l].capture,
h[l].capture)){k=!1;break}}else k=!1;return k};this.unload=function(){c.removeChild(f)};this._init(a,d,c)}
function CNewsPanel(a){var d,c,f,g;this._init=function(b){c=new createjs.Shape;c.graphics.beginFill("black").drawRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT);c.alpha=0;c.on("mousedown",function(){});s_oStage.addChild(c);var e=this;createjs.Tween.get(c).to({alpha:.7},500).call(function(){e._onEndFade()});f=new createjs.Container;s_oStage.addChild(f);var h=s_oSpriteLibrary.getSprite("msg_box"),k=createBitmap(h);k.regX=h.width/2;k.regY=h.height/2;f.addChild(k);f.x=CANVAS_WIDTH/2;f.y=CANVAS_HEIGHT/2;d=b;h=h.width-
120;g=new CTLText(f,-(h/2),-340,h,280,80,"center",FONT_COLOR,PRIMARY_FONT,1.2,2,2,b,!0,!0,!0,!1);h=s_oSpriteLibrary.getSprite("checkers");b=createBitmap(h);b.regX=h.width/2;b.regY=h.height/2;b.y=180;f.addChild(b)};this.unload=function(){s_oStage.removeChild(c);s_oStage.removeChild(f);c.off("mousedown",function(){});f.removeAllEventListeners()};this._onEndFade=function(){f.on("mousedown",this.unload,this)};this.setMessage=function(b){d=b;g.refreshText(b)};this.setMsgColor=function(b){g.setColor(b)};
this.centerMessage=function(){g.setY(-50)};this.show=function(){c.visible=!0;f.visible=!0};this.showExitBut=function(){(void 0).setVisible(!0)};this.setButtonContainerY=function(b){};this.refreshLang=function(b){g.refreshText(d);for(var e=0;e<(void 0).length;e++)(void 0)[e].refreshText(b[e])};this._init(a)}
function CParticle(a,d,c){var f,g;this._init=function(b,e,h){f=new createjs.Container;f.x=b;f.y=e;h.addChild(f);b=[];for(e=0;22>e;e++)b[e]=s_oSpriteLibrary.getSprite("particle_stars_"+e);e=new createjs.SpriteSheet({images:b,framerate:30,frames:{width:b[0].width,height:b[0].height,regX:b[0].width/2,regY:b[0].height/2},animations:{start:0,anim:[0,21,"stop_anim"],stop_anim:21}});g=createSprite(e,"start",b[0].width/2,b[0].height/2,b[0].width,b[0].height);g.scale=.5;f.addChild(g);g.gotoAndPlay("anim");
g.on("animationend",this.unload,this);playSound("king",1,!1)};this.unload=function(b){"stop_anim"===b.name&&c.removeChild(f)};this._init(a,d,c)};
